;-------------------------------------------------------------------------;
.include "fade.inc"
.include "options.inc"
.include "shadow_ram.inc"
.include "snes.inc"
;-------------------------------------------------------------------------;


;/////////////////////////////////////////////////////////////////////////;
.code
;/////////////////////////////////////////////////////////////////////////;


;-------------------------------------------------------------------------;
	.a8
	.i16
;-------------------------------------------------------------------------;


;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::;
FadeMosaic:
;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::;
	lda	options
	bit	#OPTION_FADE_OUT
	bne	FadeOutMosaic
;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::;
FadeInMosaic:
;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::;
	lda	reg_inidisp
	lsr
	cmp	#16
	beq	endm
;-------------------------------------------------------------------------;
	sta	REG_INIDISP
	inc	reg_inidisp
	xba
	lda	options
	bit	#OPTION_MOSAIC
	beq	endm
;-------------------------------------------------------------------------;
	xba
	asl
	asl
	asl
	asl
	eor	#0f0h
	ora	#%1111
	sta	REG_MOSAIC
	sta	reg_mosaic
;-------------------------------------------------------------------------;
endm:	rts
;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::;
FadeOutMosaic:
;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::;
	lda	reg_inidisp
	beq	endm
;-------------------------------------------------------------------------;
	dea
	sta	reg_inidisp
	lsr
	sta	REG_INIDISP

	lda	options
	bit	#OPTION_MOSAIC
	beq	endm
;-------------------------------------------------------------------------;
	cld
	clc
	lda	reg_mosaic
	adc	#10h
	sta	REG_MOSAIC
	sta	reg_mosaic
	rts

