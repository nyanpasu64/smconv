;==========================================================================
;                            1994 Christmas Leftovers
;            A collection of hardly used intros and pieces of code
;            slapped together and wrapped with .LHA wrapping paper.
;==========================================================================

;==========================================================================
;
;                        Greetings (Why do I bother?)
;
;      Since ALKAID/TRY asked me to mention his handle ALKAID/TRY
;      in my next trainer, I had to tell ALKAID/TRY that I quit making
;      trainers. But I told ALKAID/TRY that I would release some stuff
;      for Christmas and that I would put ALKAID/TRY in my greet list.
;
;                       David Letterman's Top Ten List:
;
;                Top Ten Reasons Why -Pan- Should Greet People
;
;     10. Sigma Seven would go berzerk and convince himself that he is
;         Der Fuhrer
;
;      9. Wild Fire would stop making trainers, get a job, then move to the
;         U.S. and become a Senator for the newly established State of France.
;
;      8. Pothead would get off the named substance and get hooked on
;         another narcotic meaning he'd be called Crackhead.
;
;      7. Ayatollah's handle would become the butt of bad jokes.
;         (Ayatoldya so!)
;
;      6. Picard would get confused whether he is Kirk, Picard, or Ped.
;         Eventually leading to divorce, bankruptcy, homelessness,
;         and scandal
;
;      5. Alfatech would lose his job, go on welfare and discover that
;         people can actually make a million bucks by mooching off the system
;
;      4. The White Knight would get rich by finding another bug in Intel's
;         Pentium processor. He then exploits the bug after Intel claims that
;         "After we've fixed all the bugs in the Pentium processor we
;          guarantee there are none left and if there are we'll give all
;          our money to the first person who finds it. HA HA HA."
;
;      3. The guys in Nightfall would create a police force so powerful
;         that the Mafia runs screaming for their lives. The Mafiosa
;         move from Sicily to Brooklyn, New York and take over the
;         city allowing the Nightfall crew to dominate southern Europe.
;
;      2. No one would greet -Pan- anymore causing him not to release
;         source codes leading to a more boring scene which gets the
;         new owners of the Amiga thinking that there should be more to
;         a computer than great multi-tasking since 1985. They in turn
;         hire Microsoft to develop "Windows '95 Amiga Edition"
;         which slows down the Amiga to a crawl. All Amiga owners
;         start rioting in the streets and demand that Microsoft be
;         disbanded into small companies which cannot control a large
;         portion of the computer using community. People are finally happy.
;
;             And The Number One Reason Why -Pan- Should Greet People:
;
;      1. ALKAID/TRY asked me to greet him!


;=========================================================================
;                   !!!!!!!!!!!!!COPYRIGHT NOTICE!!!!!!!!!!!!!!
;
;                            Music from UniRacers (Nintendo)
;                    Turtle and Shell from Super Mario World (Nintendo)
;                   Pointer, Unicycle, Numbers from UniRacers (Nintendo)
;                    Chun Li and Ken from Street Fighter (Capcom)
;                Mickey Mouse Font from The Great Circus Mystery (Capcom)
;                              Code by -Pan-/Anthrox
;       Copyrights for various data are held by their respective owners.
;            No part of this demo shall be used for monetary gains!
;         This demo is for information and educational purposes ONLY!
;=========================================================================

;=========================================================================
;                           A Message from -Pan-/ATX
;
;     Yup, another boring year... projects started, then stopped, then
;     new projects started and stalled. Anything new?
;
;     I'm quite tired of this crap already, the scene has gotten so boring
;     lately that I've quit training games for the sake of my own sanity..
;
;     Trying to put a game together is not as easy as it sounds.
;     Making a game is easy.. have the ability, will code..
;     Unfortunately I can't even draw a straight line using DPaint,
;     which means no graphics and no inspiration.
;
;     So what do I do? I pack the garbage that's been on my HD and try to
;     put it out for people to use. And I know people use my code since
;     I see it A LOT! (Nice Numbers demo, which is just a rip of my
;                      Happy Near Demo.. which is ok, that's why I threw
;                      it out..)
;
;     Super Wild Card DX is finally released, with my 2 year old game
;     stuffed inside. Originally done for a demo which was (you guessed it)
;     stopped unabruptly..notice the Quit button?
;
;     Stupid people call me up and act (?) like homos, which is nothing new.
;     Funny how people must hide behind telephones instead to come face to
;     face. If anyone was at the last World of Amiga in NY, you knew what
;     happened to people with big mouths, large attitudes, and no muscles.
;
;     I've started on a new game after quiting that cruddy side-scroller in
;     here.. the gfx are from Marvin's Marvelous Adventure on Amiga, but
;     since the coder didn't want the gfx spread I had to deform the hell
;     out of them. The game in here is a bit buggy (the collision detection
;     and jumping above the screen.. I hadn't bothered fixing them since I
;     knew this game would never be completed)
;     All the basic movement functions are intact but not implemented..
;     You can exit the game by pressing X or waiting until health is 0... 
;     Too bad.. I had nice ideas for this game...
;
;     Fashion Light and The White Knight stopped by to watch the World Cup
;     Championship match. Too bad Fashion Light had to go home a loser...
;     I guess my mode 7 TV with picture-in-picture porno helped ease the
;     pain..
;
;     It happened again, no Denmark trip for me this year.. another plan gone
;     to waste. Is it just me, or did 1994 suck for everyone?
;
;     Pesky little aliens are still abducting me while I sleep.
;     Little grey snots! Just you wait! ;)
;
;     Anyone wanna hire a 22 year old self taught programmer? Will
;     move anywhere in the USA except Alaska or other extremely cold
;     areas (like Minnesota during winter!)
;     Am a quick learner, eager, reliable when my memory doesn't
;     fail (damn EMFs!), great thinker, great sense of sarcastic humor,
;     7 years of programming/game reprogramming experience on 8 bit - 32 bit
;     systems, and have a million and one ideas never (to be?) used.
;     
;     Call Marc at 718-381-7504, no homo acts please! :)
;



;==========================================================================
;                         About the demo parts
;
;          Do not take the descriptions literally, most are false
;          since they have been clipped from other routines and then
;          modified. I don't want to be bothered fixing it up line by line
;          just so no one will create something on SNES.
;
;
;       You can skip the ESI part by pressing A,B,X,or Y
;       Or by letting the scroll reach it's end.
;
;       You can skip the DYXBP scroll by pressing A,B,X, or Y
;       Or by letting the scroll reach it's end.
;
;	You can skip the game by pressing X or letting the counter
;       reach 0
;
;       You can skip the last part by pressing C,D,W, or V on joypad 8
;       or by letting the scroll reach it's end. :)
;
;
;       The eagle pic was ripped right off the C64 and converted on the
;       Amiga to an IFF file, which was then stretched to fit the screen.
;       Making the image smaller to create a border failed miserably.
;       The eagle looked like it wouldn't survive its possible extinction...
;
;       The ESI scroll moves at a 1.5 rate, which means it scrolls twice.
;       The second time it scrolls it only goes every other frame
;       This is to match the C64's scroll speed. The C64 has 320 pixels
;       per line and a border so the scroll (which is actually bigger
;       in pixel amounts) moves at a different pace when shifted
;       To try to even out the timing I made it goes at that strange
;       rate, so it would be possible to read the text at nearly the
;       same pace as you would on the C64. The problem: a bit cloudy
;       looking... oh well, better that than nothing at all..
;
;       DYXBP is a variant of DYXCP, which is a variant of DYCP.
;       
;       DYXBP: Different Y & X Bit Position
;       DYXCP: Different Y & X Character Position
;       DYCP:  Different Y Character Position
;
;       what's the difference? DYCP moves a letter up and down.
;       the letter next to it is at another Y position, and so is the next
;       one, and the one after that, etc etc.. (see sine scroll)
;       DYXCP moves a letter up and down, left and right. The letter
;       next to it is at another X & Y position, etc etc..
;       DYXBP is the same as DYXCP except that it is at 1 pixel resolution
;       meaning that it does not move the whole letter, but each pixel
;       of the letter is at a different X & Y position.
;
;       The game's map was created with an out-dated map editor called
;       Freditor. It allows 256 16*16 pixel tiles. which means 1024 separate 
;       8*8 pixel tiles. So I used it. A BIG mistake. The maps can only be
;       a max of 256*256 16*16 tiles. That's too small, and another reason
;       to scrap the game. I have a better editor, and hopefully will get
;       an even better one soon..
;	The flickering you see during the game is the amount of screen
;       time all the routines have taken up. A little game thing like this
;       uses less time than an intro!
;
;       The last part has some nice graphics ripped with a util I made for
;       extracting images from SWC DX Real-Time Save files.
;       As you can see, the util does work. The music was ripped from
;       UniRacers (Why the hell are there curses inside the game? Are we
;       the only ones to see it?)
;       The music has NOT been relocated, and the size of the file is
;       due in part to the fact that the music data lies at bank $10+
;       the Street Fighter animations are not sprites, but tiles that are
;       GDMAd to VRAM when the time is right. The gfx are already in VRAM.
;       Unlike in Street Fighter, the animations were sprites and gfx.
;       The gfx are re-drawn and sprites pieced together as a whole image
;       when told.
;       The pointer and uni-cycle are sprites, with the sprite name (number)
;       being change every other vertical blank..
;       The Turtle and Shell are animated as close as possible to look
;       like the animation in Super Mario World.
;       There are 2 cells for the Turtle, 3 cells for the Shell
;       a bunch of cells for the pointer and uni-cycle, and 3 cells for the
;       Street Fighter animations
;
;       The snow falling is just mode 2 (offset change mode)
;       It seems to flicker cawz I change offset pointer every other
;       vertical blank to a different set of offset data. This way I can
;       make it appear that there are twice as many flakes, and each
;       falling at a different rate...
;
;       The Merry X-Mas logo was drawn using a Silly-Con Graphics Workstation
;       Rendering time was approx. 5 hours and 15 minutes.
;       Originally it was a 3-D image of a pile of dog crap.
;       Amazing what these computers can do! 
;
;
;       The swinging motion is real time calculated (wow..) based on
;       a precalculated sine table (huh?)
;
;       This is the only part of this demo that is not a Leftover.
;       It was created to practice animations before getting any gfx
;       for my next game... besides.. don't you just like cute turtles and
;       Chun Li's figure?
;
;       Find the hidden part!
;
;

 




	heap	O=1024k			;max 1024k object buffer                
                                                                                  
	SMC+				;yes, we want a smc header            
	lrom				;yes, please split in 32k hunks 
      








; last part

plan2offset	equ	$7e1e00
plan2offset2	equ	$7e1e40

oam		equ	$1b00

xstorage1	equ	$1100
xstorage2	equ	xstorage1+2
pointeroffset	equ	xstorage2+2
pointertimer	equ	pointeroffset+2
joydata		equ	pointertimer+2
pointHV		equ	joydata+2
babyunioffset	equ	pointHV+2
xstorage3	equ	babyunioffset+2
xstorage4	equ	xstorage3+2
sineoffset	equ	xstorage4+2
turtanim	equ	sineoffset+2
turttimer	equ	turtanim+2
turthpos	equ	turttimer+2
Turtshellanim	equ	turthpos+2
Turtshelltimer	equ	Turtshellanim+2
Turtshellhpos	equ	Turtshelltimer+2
chunkenanim	equ	Turtshellhpos+2
chunkentimer	equ	chunkenanim+2

; esi part

hdmaplaneon	equ	$04
currentline	equ	hdmaplaneon+2
drawonoff	equ	currentline+2
scrollxoffset	equ	drawonoff+2
scrolltextoffset	equ	scrollxoffset+2
cycleoffset	equ	scrolltextoffset+2
doublechar	equ	cycleoffset+2
scrollonoff	equ	doublechar+2
speedtoggle	equ	scrollonoff+2

; dyxbp part

dsinepos	equ	$04
scrollend	equ	dsinepos+2
column		equ	scrollend+2
ysine		equ	column+2
xsine		equ	ysine+2
dsinexpos	equ	xsine+2
scrollgfxoffset	equ	dsinexpos+2
bitcounter	equ	scrollgfxoffset+2
ysinestore	equ	bitcounter+2
xsinestore	equ	ysinestore+2
bitoffset	equ	xsinestore+2
scrollcharoffset	equ	bitoffset+2
scrollbitoffset	equ	scrollcharoffset+2


; game part

			;  $1e00 = column data for plane 0
			; $1e40 = column data for plane 1
			; $1b00-$1d1f = sprite data
			; $1d20-$1d4f = weapon info
			; $1d50-$1d8f = weapon hit screen, address/byte to replace
			; with
			; Map plane 0 = $7fe000
			; Map plane 1 = $7fc000
			; HDMA list = $7f8000



Map		equ	$7fe000
Map2		equ	$7fc000
Plane0X		equ	$1000
Plane0Y		equ	Plane0X+2
column_map_offset	equ	Plane0Y+2
joypaddata	equ	column_map_offset+2
MapX		equ	joypaddata+2
MapY		equ	MapX+2
Plane0TileAddress		equ	MapY+2
MainH		equ	Plane0TileAddress+2
Vramtransfer	equ	MainH+2
Screen0Column	equ	Vramtransfer+2
MainAnim	equ	Screen0Column+2
MainV		equ	MainAnim+2
MainFlip	equ	MainV+2
Storage		equ	MainFlip+2
Storage2	equ	Storage+2
Storage3	equ	Storage2+2
Storage4	equ	Storage3+2
Jumpflag	equ	Storage4+2
MainJump	equ	Jumpflag+2
Jumpoffset	equ	MainJump+2
Fallflag	equ	Jumpoffset+2
JumpFallflag	equ	Fallflag+2
PickObjTest	equ	JumpFallflag+2
PickObjChar1	equ	PickObjTest+2
PickObjChar2	equ	PickObjChar1+2
PickObjAdd	equ	PickObjChar2+2
Storage5	equ	PickObjAdd+2
Storage6	equ	Storage5+2
PickObjHelp	equ	Storage6+2
PickObjTest2	equ	PickObjHelp+2
PickObjAdd2	equ	PickObjTest2+2
Fireonflag	equ	PickObjAdd2+2
Firedistance 	equ	Fireonflag+2
Firestore	equ	Firedistance+2
Firestore2	equ	Firestore+2
Firechaindistance equ	Firestore2+2
Firechaindisplacement equ	Firechaindistance+2
Firechainsprite	equ	Firechaindisplacement+2
FirechaindistanceV equ	Firechainsprite+2
FirechaindisplacementV	equ	FirechaindistanceV+2
Firestore3	equ	FirechaindisplacementV+2
Fallfixer	equ	Firestore3+2
FireHoriz	equ	Fallfixer+2
FireVert	equ	FireHoriz+2
Scorelo		equ	FireVert+2
Scorehi		equ	Scorelo+2
Scoredigit1	equ	Scorehi+2
Scoredigit3	equ	Scoredigit1+2
Scoredigit5	equ	Scoredigit3+2
Scoredigit7	equ	Scoredigit5+2
Scoreoffset	equ	Scoredigit7+2
Objectchangetest	equ	Scoreoffset+2
ObjectchangeAdd		equ	Objectchangetest+2
Objectchangechar	equ	ObjectchangeAdd+2
BallH			equ	Objectchangechar+2
BallV			equ	BallH+2
SCROLLEOR		equ	BallV+2
Scrollspeed	equ	SCROLLEOR+2
Bombon		equ	Scrollspeed+2
Bombleft	equ	Bombon+2
Bombright	equ	Bombleft+2
Bombaddsub	equ	Bombright+2
Bombcolor	equ	Bombaddsub+2
Bombeffecton	equ	Bombcolor+2
Plane1X         equ 	Bombeffecton+2
Plane1Y         equ 	Plane1X+2
column_map_offset2 equ	Plane1Y+2
Screen1Column	equ	column_map_offset2+2
MapX2		equ	Screen1Column+2
MapY2		equ	MapX2+2
Vramtransfer2	equ	MapY2+2
Plane1TileAddress equ	Vramtransfer2+2
backmapeor	equ	Plane1TileAddress+2
Starannimcount	equ	backmapeor+2
Starframecount	equ	Starannimcount+2
Programeor	equ	Starframecount+2
Weapontestoffset	equ	Programeor+2
Weapontestcount	equ	Weapontestoffset+2
Weapontestchange equ	Weapontestcount+2
Storage7	equ	Weapontestchange+2
Storage8	equ	Storage7+2
healthlo    	equ	Storage8+2
healthhi    	equ	healthlo+2
healthdigit1	equ	healthhi+2
healthdigit3	equ	healthdigit1+2
healthdigit5	equ	healthdigit3+2
healthdigit7	equ	healthdigit5+2
healthoffset	equ	healthdigit7+2
Movescreentest	equ	healthoffset+2
Movescreentest2 equ	Movescreentest+2
Movescreentest3	equ	Movescreentest2+2
Jumphalftest	equ	 Movescreentest3+2
Joybounceone	equ	Jumphalftest+2
HeadFallflag	equ	Joybounceone+2
endgame		equ	HeadFallflag+2


;==========================================================================
;        Code (c) 1994 -Pan-/ANTHROX   All code can be used at will!
;==========================================================================                     


Start:  

	clc			; Clear Carry flag
	xce			; Native 16 bit mode  (no 6502 Emulation!) 
	
	rep	#$30
	
 
	LDA #$01FF 
	TCS        
	LDA #$0000 
	TCD


	jsl	>ESIStart	; go to ESI intro
	jsl	>dscroll	; go to DYXBP scroll
	jml	>gStart		; go to game

continue:

	rep	#$30
	ldx	#$0000
cleanupram:
	stz	$0000,x
	inx			; clean up ram after game
	inx
	cpx	#$2000
	bne	cleanupram



;=========================================================================
;                              Start of X-Mas Code
;=========================================================================

	sep	#$20

	phk			; Put current bank on stack
	plb			; make it current programming bank
				; if this program were used as an intro
				; and it was located at bank $20 then an
				; LDA $8000 would actually read from
				; $008000 if it were not changed!
				; JSRs and JMPs work fine, but LDAs do not! 

	


	

	jsl	>Snes_Init	; Cool Init routine! use it in your own code!!

	rep	#$30


	lda	#$0000		;song #0-8
	asl a
	tax
	jsr	(musicrouts,x)






	rep     #$10		; X,Y fixed -> 16 bit mode
	sep     #$20		; Accumulator ->  8 bit mode

	lda	#$01		; mode 1, 8/8 dot
	sta	$2105	
	lda	#$13		; Plane 1 Enabled
	sta	$212c
	lda	#$40
	sta	$2107
	lda	#$44
	sta	$2108
	lda	#$4c
	sta	$2109		; sine wave storage

	lda	#$30
	sta	$210b



	jsr	Copy_Gfx	; Put graf-x in vram
	jsr	Copy_colors	; put colors into color ram
	jsr	Make_tiles	; set up the screen
	jsr	HDMA		; set up HDMA
	jsr	Sprite_setup	; set up sprites

	rep	#$30
	sep	#$20

	lda	#$01
	sta	$4200

	ldx	#$0000
	stx	pointeroffset
	stx	pointertimer
	stx	babyunioffset
	stx	sineoffset
	stx	turtanim
	stx	turttimer
	stx	Turtshellanim 
	stx	Turtshelltimer
	stx	chunkenanim 
	stx	chunkentimer



	ldx	#$0080
	stx	turthpos

	ldx	#$00a0
	stx	Turtshellhpos

	ldx	#$b020
	stx	pointHV

	lda	#$0f
	sta	$2100		; turn the screen on

Waitloop:
	jsr	WaitVb		; wait for vertical blank
	jsr	copyoam
	jsr	snowfall
	jsr	chunkenanimation
	jsr	pointer
	jsr	babyuni
	jsr	Turtle
	jsr	Turtleshell

	jsr	joybutton
	jsr	Joypad
	jsr	Plane1hHDMA
	bra	Waitloop	; constant loop

;==========================================================================
;                       Cheezy Snow Fall Routine :)
;==========================================================================

snowfall:

	rep	#$30
	sep	#$20
	
				; start of General DMA graphics copy routine!
	lda	#$01
	sta	$4370		; 1= 1 word per register
	lda	#$18
	sta	$4371		; 2118   this is 2118 (VRAM)

	rep	#$30
	lda	pointertimer
	asl a
	tay

	ldx	plane2offsetaddress,y
	stx	$4372		; get address and bank of offsets

	ldx	pointertimer
	sep	#$20

	lda	plane2offsetbank,x
	sta	$4374		; bank address of data in ram
	ldx	#$040
	stx	$4375		; # of bytes to be transferred

	rep	#$30
	lda	pointertimer
	asl a
	tay
	sep	#$20


	ldx	plane3vramaddress,y
	stx	$2116

	lda	#$80		; turn on bit 7 (%10000000=$80) of G-DMA channel
	sta	$420b

	ldx	pointertimer
	lda	plane3address,x
	sta	$2109



	rep	#$30
	ldx	#$0000
	txy
makesnowfall1:
	lda	plan2offset,x
	dec a
	and	#$00ff
	ora	#$c000
	sta	plan2offset,x

	lda	plan2offset2,x
	dec a
	sec
	sbc	pointertimer
	and	#$00ff
	ora	#$c000
	sta	plan2offset2,x


	lda	plan2offset+2,x
	dec a
	dec a
	and	#$00ff
	ora	#$c000
	sta	plan2offset+2,x

	lda	plan2offset2+2,x
	sec
	sbc	pointertimer		; move every other frame!
	and	#$00ff
	ora	#$c000
	sta	plan2offset2+2,x



	inx
	inx
	inx
	inx
	iny
	cpy	#$0010
	bne	makesnowfall1



	sep	#$20

	rts

	
plane3address:
	dc.b	$4c,$44
plane3vramaddress:
	dcr.w	$4c20,$4420
plane2offsetaddress:
	dcr.w	plan2offset,plan2offset2
plane2offsetbank:
	dc.b	^plan2offset,^plan2offset2
;==========================================================================
;                     Street Fighter Animation Routine
;==========================================================================
chunkenanimation:
	rep	#$30
	sep	#$20
	
				; start of General DMA graphics copy routine!
	lda	#$01
	sta	$4370		; 1= 1 word per register
	lda	#$18
	sta	$4371		; 2118   this is 2118 (VRAM)

	rep	#$30
	lda	chunkenanim	
	asl a
	tax


	lda	chunkenaddress,x
	sta	$4372		; get address and bank of tiles

	lda	chunkenanim
	tax
	sep	#$20

	lda	chunkenbank,x
	sta	$4374		; bank address of data in ram
	ldx	#$0300
	stx	$4375		; # of bytes to be transferred

	ldx	#$4640
	stx	$2116

	lda	#$80		; turn on bit 7 (%10000000=$80) of G-DMA channel
	sta	$420b


	inc	chunkentimer
	lda	chunkentimer
	cmp	#$07
	beq	incchunkenanim
	
	rts

incchunkenanim:

	stz	chunkentimer

	lda	chunkenanim
	inc a
	and	#$03
	sta	chunkenanim

	rts

chunkenaddress:
	dcr.w	streetanim1,streetanim2,streetanim3,streetanim2

chunkenbank:
	dc.b	^streetanim1,^streetanim2,^streetanim3,^streetanim2


;=========================================================================
;                         Turtle Animation Routine
;=========================================================================

Turtle:
	rep	#$30



	lda	turthpos
	dec a				; move turtle left
	dec a
	sta	turthpos
	cmp	#$ffee			; allow to go all the way left
	bne	noturtposreset
	lda	#$00fe			; in case it goes too far left
	sta	turthpos		; set it back to the right
	
noturtposreset:

	sep	#$20

	lda	turthpos+1		; let's fix the Most Significant Bit
	and	#$80			; so he won't pop off the screen
	asl a				; when he goes past H pos $0000
	rol a
					; get Most Significant Bit ($80) and
					; shift left to get the Carry bit
					; then rotate left to put the carry
					; bit to the Least Significant Bit ($1)
	
	sta	xstorage1		; store it

	ldx	#$0203			; get offset for OAM size and MSB bit
	lda	oam,x			; data
	and	#%11111110		; mask out the other sprite's info
	ora	xstorage1		; put in our LSB instead
	sta	oam,x			; save it!

	asl 	xstorage1		; shift it left twice so we can write
	asl 	xstorage1		; the LSB to the net sprite

	lda	oam,x
	and	#%11111011		; mask out the other sprite's info
	ora	xstorage1		; put in our LSB and save it
	sta	oam,x

	



	ldx	#$0030			; get sprite # offset
	lda	turthpos		; sprites need 4 bytes of data
	sta	oam,x			; so to figure out this sprite's #
					; you just divide by 4 ($30/4=$c)
	ldx	#$0034	
	sta	oam,x			; let's save the Turtle's H pos
					; for both sprites

turtnomove:

	lda	turttimer
	inc a
	and	#$07			; this is the animation frame timer
	sta	turttimer		; the Turtle will only animate
	bne	Turtleend		; every 8th vertical blank



	lda	turtanim
	eor	#$01			; the Turtle only has 2 frames of
	sta	turtanim		; animation.. we only need one bit
					; for the offset (1 bit=2 numbers!)




	ldy	#$0030			; sprite # offset ($30/4=$c)
					; $c*4=$30!
	ldx	turtanim		; get frame offset
	lda	turtframe1,x		; read frame #
	sta	oam+2,y			; store the info in OAM

	ldy	#$0034			; get the next sprite (bottom of Turtle)

	lda	turtframe2,x		; get the frame #
	sta	oam+2,y			; store it in OAM
Turtleend:
	rts				; the end of Turtle Routine

turtframe1:
	dc.b	2,4

turtframe2:
	dc.b	$22,$24
	
		




;=========================================================================
;                         Turtleshell Animation Routine
;=========================================================================

Turtleshell:
	rep	#$30



	lda	Turtshellhpos
	dec a				; move Turtleshell left
	dec a
	sta	Turtshellhpos
	cmp	#$ffee			; allow to go all the way left
	bne	noTurtshellposreset
	lda	#$00fe			; in case it goes too far left
	sta	Turtshellhpos		; set it back to the right
	
noTurtshellposreset:

	sep	#$20

	lda	Turtshellhpos+1		; let's fix the Most Significant Bit
	and	#$80			; so he won't pop off the screen
	asl a				; when he goes past H pos $0000
	rol a
					; get Most Significant Bit ($80) and
					; shift left to get the Carry bit
					; then rotate left to put the carry
					; bit to the Least Significant Bit ($1)
	
	sta	xstorage1		; store it

	asl	xstorage1
	asl	xstorage1		; move it to get to the correct
	asl	xstorage1		; MSB pos
	asl	xstorage1



	ldx	#$0203			; get offset for OAM size and MSB bit
	lda	oam,x			; data
	and	#%11101111		; mask out the other sprite's info
	ora	xstorage1		; put in our LSB instead
	sta	oam,x			; save it!


	



	ldx	#$0038			; get sprite # offset
	lda	Turtshellhpos		; sprites need 4 bytes of data
	sta	oam,x			; so to figure out this sprite's #
					; you just divide by 4 ($38/4=$e)


Turtshellnomove:

	lda	Turtshelltimer
	inc a
	and	#$03			; this is the animation frame timer
	sta	Turtshelltimer		; the Turtleshell will only animate
	bne	Turtleshellend		; every 4th vertical blank



	lda	Turtshellanim
	inc a
	cmp	#$04
	bne	Turtshellanimnoreset
	lda	#$00			; reset if past three frames
Turtshellanimnoreset:
					; the Turtleshell has 4 frames of
	sta	Turtshellanim		; animation..but only 3 images




	ldy	#$0038			; sprite # offset ($38/4=$e)
					; $e*4=$38!
	ldx	Turtshellanim		; get frame offset
	lda	Turtshellframe1,x	; read frame #
	sta	oam+2,y			; store the info in OAM
	lda	Turtshellframe2,x
	sta	oam+3,y

Turtleshellend:
	rts				; the end of Turtleshell Routine

Turtshellframe1:
	dc.b	$a,$6,$8,$6
Turtshellframe2:
	dc.b	$34,$34,$34,$74
		





;=========================================================================
;                      Plane 1 HDMA swing left/right
;=========================================================================
Plane1hHDMA:

	sep	#$20
	inc	sineoffset		; increase sine offset ($00 - $ff)

	rep	#$30
	lda	sineoffset		; get sine offset
	asl a				; multiply by 2 to read sine data
					; stored as words
	tax
	lda	>sine,x			; read sine data in another bank
	sta	xstorage1		; bottom h pos offset
	stz	xstorage2		; clear xstorage2 (becomes remainder)

					; top line's position is always $0	
					; bottom line's position goes
					; in accordance with sine data


					; to calculate the slope for the
					; other lines we divide the
					; bottom's h position by
					; the bottom line v position
					; (which line it's located)
					; the bottom line v pos is 128
					; so this is the calculaton we need:
					; bottomHpos/bottomVpos = slope value

					; what's important to know is that
					; we need the remainder to create
					; a smooth slope


	lda	xstorage1		; get the bottom line's H pos



	lsr a				; divide by 128 and get remainder
	ror	xstorage2		; 
	lsr a				; quotient
	ror	xstorage2		; remainder
	lsr a				; 
	ror	xstorage2		;
	lsr a				; we shift the accumulator right
	ror	xstorage2		; and send the carried bit to the
	lsr a				; remainder through ROR
	ror	xstorage2		; quotient remainder
	lsr a				; 01010101 01000000
	ror	xstorage2		;  after division by 2 (shift to right)
	lsr a				; 00101010 10100000
	ror	xstorage2		;


					; after getting to many strange
					; effects while using the SNES'
					; built in division I resorted to
					; using a fool proof method:
					; my own code!


	sta	xstorage1		; store the quotient

	stz	xstorage3		; counter
	
	stz	xstorage4		; decimal counter


	ldx	#$0000
	ldy	#$0080			; # of lines = 128
hposdrawloop2:

	inx			; skip first byte of HDMA list

	lda	xstorage3	; store counter (H pos offset) in HDMA list
	sta	>$7e9803,x
	
	inx			; jump over the 2 bytes of HDMA list to get
	inx			; to the next line of the list

	lda	xstorage4	; get decimal counter
	clc
	adc	xstorage2	; add the remainder of the division
	sta	xstorage4	; store it back into the decimal counter
	bcc	nohposadd2	; if the carry bit is set (the addition value
	inc	xstorage3	; becomes more than $ffff) then increase
				; Whole number counter by one

nohposadd2:

	lda	xstorage3	; get whole number counter 
	clc
	adc	xstorage1	; add qoutient
	sta	xstorage3	; store it into the whole number counter again

	dey			; decrease # of lines left to draw
	bne	hposdrawloop2	; if it's not 0, then do the whole thing again!
	sep	#$20
	rts



;=========================================================================
;                     Baby Uni-Cycle Animation Routine
;=========================================================================

babyuni:
	lda	pointertimer		; since the animation only runs
	beq	babyend			; every other vertical blank
					; we can use the pointer's timer!

	ldy	#$002c			; sprite #'s data offset
	ldx	babyunioffset		; get the baby unicycle's offset
	lda	babyuniframe,x		; read the frame #
	sta	oam+2,y			; store it in OAM list
	
	inc	babyunioffset		; increase frame offset
	lda	babyunioffset
	cmp	#$14			; is it past $14?
	bne	babyend
	stz	babyunioffset		; if so, then set it to 0
babyend:
	rts

babyuniframe:
	dc.b	$66,$68,$6a,$6c,$6e,$80,$82,$84,$86,$88,$8a
	dc.b	$88,$86,$84,$82,$80,$6e,$6c,$6a,$68

;=========================================================================
;                              Pointer Routine
;=========================================================================

pointer:


	rep	#$30	

	lda	pointHV			; get pointer's H and V pos
	sta	oam			; H is the low byte, V is the high
					; byte!

	lda	pointertimer		; 
	eor	#$01			; timer only needs to know odd
	sta	pointertimer		; and even intervals (this makes it
	beq	pointerend		; every other frame!)


	lda	pointeroffset		; get pointer's frame offset
	inc a
	and	#$000f			; increase it and allow only 16 frames
	sta	pointeroffset		; store it
	asl a				; multiply by 2 to get offset stored
	tax				; as words
	lda	pointerframes,x
	ora	#$3000			; set the priority bits (sprites
	sta	oam+2			; will get higher priority)

pointerend:
	sep	#$20
	rts

pointerframes:
	dcr.w	$40,$44,$48,$4c	
	dcr.w	$80,$84,$88,$8c	
	dcr.w	$c0,$c4,$c8,$cc	
	dcr.w	$100,$104,$108,$10c	


;==========================================================================
;                            Copy Sprite Data to OAM
;==========================================================================
copyoam:
	rep	#$30
	sep	#$20
	
				; start of General DMA graphics copy routine!
	lda	#$00
	sta	$4370		; 0= 1 byte per register (not a word!)
	lda	#$04
	sta	$4371		; 21xx   this is 2104 (OAM)
	ldx	#oam
	stx	$4372		; ram at $1b00
	lda	#$7e
	sta	$4374		; bank address of data in ram
	ldx	#$0220
	stx	$4375		; # of bytes to be transferred

	lda	#$63
	sta	$2101
	stz	$2102
	stz	$2103

	lda	#$80		; turn on bit 7 (%10000000=$80) of G-DMA channel
	sta	$420b
	rts


;===========================================================================
;                        Start Of Joypad Routine
;===========================================================================

Joypad:
	lda	$4212		; test if it's ok to read pad
	and	#$01
	bne	Joypad		; nope, go back!

	rep	#$30

	lda	$4218		; read Controller 1
	sta	joydata		; store data

	sep	#$20
	lda	joydata+1
	bit	#$01
	bne	movepointright1	; did the controller move right?
	bit	#$02
	bne	movepointleft1	; did the controller move left?

testjoy2:

	sep	#$20
	lda	joydata+1
	bit	#$04
	bne 	movepointdown1	; did the controller move down?
	bit	#$08
	bne	movepointup1	; did the controller move up?
	rts	

movepointright1:
	jsr	movepointright2	; go to the right routine
	jmp	testjoy2	; go back and check up/down
movepointleft1:
	jsr	movepointleft2	; go to the left routine
	jmp	testjoy2	; go back and check up/down
movepointdown1:
	jmp	movepointdown2	; go to the down routine
movepointup1:
	jmp	movepointup2	; go to the up routine

movepointright2:
	rep	#$30
	lda	pointHV
	and	#$00ff		; get only Horiz pos
	cmp	#$00de		; this is the right most limit
	bne	okmovepointright2
	sep	#$20
	rts

okmovepointright2:
	rep	#$30
	lda	pointHV
	and	#$ff00
	sta	xstorage1

	lda	pointHV
	inc a			; increase H pos by two (move right two dots)
	inc a
	and	#$00ff
	ora	xstorage1

	sta	pointHV
	sep	#$20
	rts


movepointleft2:
	rep	#$30
	lda	pointHV
	and	#$00ff		; get only Horiz pos
	cmp	#$0000
	bne	okmovepointleft2
	sep	#$20
	rts

okmovepointleft2:
	rep	#$30
	lda	pointHV
	and	#$ff00
	sta	xstorage1

	lda	pointHV
	dec a			; move left two dots
	dec a
	and	#$00ff
	ora	xstorage1

	sta	pointHV
	sep	#$20
	rts
movepointdown2:
	rep	#$30
	lda	pointHV
	and	#$ff00		; get only vert pos
	cmp	#$c000
	bne	okmovepointdown2
	sep	#$20
	rts

okmovepointdown2:
	rep	#$30
	


	lda	pointHV
	and	#$00ff
	sta	xstorage1



	lda	pointHV
	xba
	inc a			; move down two lines
	inc a
	and	#$00ff
	xba
	ora	xstorage1

	sta	pointHV
	sep	#$20
	rts
movepointup2:
	rep	#$30
	lda	pointHV
	and	#$ff00		; get only vert pos
	cmp	#$9000
	bne	okmovepointup2

	sep	#$20
	rts

okmovepointup2:
	rep	#$30
	lda	pointHV
	and	#$00ff
	sta	xstorage1

	lda	pointHV
	xba
	dec a			; move up two lines
	dec a
	and	#$00ff
	xba
	ora	xstorage1

	sta	pointHV
	sep	#$20
	rts

;==========================================================================
;                              Joy Button Routine
;==========================================================================

joybutton:
	rep	#$30
	lda	joydata
	and	#$c0c0		; check if a,b,x,y was pressed
	bne	buttonabxy
	sep	#$20
	rts

buttonabxy:

	sep	#$20

	lda	pointHV+1		; pointer's vertical possition
	clc
	adc	#$10			; add 16 to center it 

	cmp	#$b0			; is it higher than the numbers?
	bcc	collisionfailed
	cmp	#$c0			; is it lower?
	bcs	collisionfailed


	sep	#$20
	lda	pointHV			; get pointer's horizontal position
	clc
	adc	#$17			; add $17 to get right most of point
	lsr a
	lsr a		            	; divide by 8 to get tile column pos
	lsr a				; it's easier to check for 32 bytes
	sta	xstorage1		; than 256 bits!

	ldx	#$0000
findselection:
	lda	musicnumber,x		; check numbers column position
	cmp	xstorage1		; with pointer's column position
	beq	selectionfound
	lda	xstorage1
	inc a				; since the #s are 16*16 we should
	cmp	musicnumber,x		; check for 2 positions...
	beq	selectionfound		; this will check for the left most
	inx
	cpx	#$0009			; keep checking until it hits a 
	bne	findselection		; number, or goes past too many numbers

collisionfailed:
	rts				; nothing interesting happened..

selectionfound:

	stx	xstorage1		; store the offset of the column pos


	lda	musicnumber,x		; get the column pos
	asl a
	asl a		; * 8		; multiply by 8 to get sprite pos
	asl a

	
	ldx	#$0028
	sta	oam,x			; store highlight box H pos!

	ldx	#$002c
	sta	oam,x			; store baby uni-cycle h pos!


	rep	#$30

	lda	xstorage1		;music number offset = song #!
	and	#$00ff
	asl a
	tax
	jsr	(musicrouts,x)		; to go corresponding music setup!
	sep	#$20
	rts

musicnumber:
	dc.b	3,6,9,$c,$f,$12,$15,$18,$1b	; column position..




;==========================================================================
;                        Vertical Blank Wait Routine
;==========================================================================
WaitVb:	
	lda	$4210
	bpl     WaitVb	; is the number higher than #$7f? (#$80-$ff)
			; bpl tests bit #7 ($80) if this bit is set it means
			; the byte is negative (BMI, Branch on Minus)
			; BPL (Branch on Plus) if bit #7 is set in $4210
			; it means that it is at the start of V-Blank
			; if not it will keep testing $4210 until bit #7
			; is on (which would make it a negative (BMI)
WaitVb2:
	lda	$4210
	bmi	WaitVb2
	rts

;==========================================================================
;       	     SETUP ROUTINES FOR PROGRAM
;==========================================================================

;==========================================================================
;                         Copy graf-x data
;==========================================================================

Copy_Gfx:
	ldx	#$0000		; Vram address $0000 (Mode 7 is always
	stx	$2116		; located at VRAM address 0
	ldx	#$0000
Clearvr:
	stz	$2118		; clear entire Vram
	stz	$2119
	inx
	cpx	#$0000		;
	bne	Clearvr

	rep	#$30

	ldx	#$0000
	stx	$2116		; gfx for background at $0000
copylogo:
	lda	>logogfx,x	;  load up the GFX from $logogfx
	sta	$2118		;  reda from another bank
	inx
	inx
	cpx	#8544
	bne	copylogo

	ldx	#$6000
	stx	$2116
	ldx	#$0000
copyspritegfx:
	lda	>spritegfx,x	; read sprite gfx from another bank
	sta	$2118
	inx
	inx
	cpx	#$4000
	bne	copyspritegfx

	ldx	#$3000
	stx	$2116

	ldx	#$0000
copystreet:
	lda	>streetgfx,x
	sta	$2118
	inx
	inx
	cpx	#6336
	bne	copystreet

	sep	#$20
	rts

;==========================================================================
;                      Copy Colors
;==========================================================================
Copy_colors:
	stz	$2121		; Select Color Register 1
	ldx	#$0000
CopCol:	
	lda	>Colors,X
	sta	$2122
	inx
	cpx	#$0200 		; copy all colors
	bne	CopCol
	rts
;==========================================================================
;                      Make Tiles
;==========================================================================

Make_tiles:
	rep	#$30
	ldx	#$4000
	stx	$2116


	ldx	#$0000
copytiles1:
	lda	>logotiles,x	; read tiles from another bank
	sta	$2118
	inx
	inx
	cpx	#$0200
	bne	copytiles1

copytiles2:
	lda	>logotiles,x	; read tiles again from another bank
	ora	#$0400		; make these tiles use the green palette
	sta	$2118
	inx
	inx
	cpx	#$03c0
	bne	copytiles2

	ldx	#$4640		; screen at $4400
	stx	$2116
	ldx	#$0000

	stx	xstorage1
copystreettiles:
	ldy	xstorage1
	lda	>streetanim1,x
	sta	$2118

	lda	xstorage1
	inc a
	inc a
	and	#$3f
	sta	xstorage1

	inx
	inx
	cpx	#$0300
	bne	copystreettiles


	ldx	#$4800
	stx	$2116

	ldx	#$0000
copysnowtiles:
	lda	>snowtiles,x
	sta	$2118
	inx
	inx
	cpx	#$0800
	bne	copysnowtiles

	ldx	#$4c00
	stx	$2116

	ldx	#$0000

	lda	#$4080
shiftflakes:
	sta	$2118
	inx
	cpx	#$0020
	bne	shiftflakes	



	sep	#$20
	rts


;==========================================================================
;                         HDMA Setup Routine
;==========================================================================

HDMA:



	ldx	#$0000
	txy
plane1hsetup:
	lda	#$01
	sta	>$7e9800,x	; set up plane 1 H pos HDMA
	inx
	lda	#$00
	sta	>$7e9800,x
	inx
	lda	#$00
	sta	>$7e9800,x
	inx
	iny
	cpy	#$00ff
	bne	plane1hsetup
	lda	#$00
	sta	>$7e9800,x
	sta	>$7e9801,x
	sta	>$7e9802,x



	jsr	Plane1hHDMA	; draw first lines


	

	


	
	lda	#$00
	sta	$4300		; 0= 1 byte per register (not a word!)
	lda	#$21
	sta	$4301		; 21xx   this is 2121 (color palette)
	ldx	#hdmapal	; the address of where it's located
	stx	$4302
	lda	#^hdmapal	
	sta	$4304		; bank address of data in ram

	lda	#$02		; write twice
	sta	$4310
	lda	#$22		; color register
	sta	$4311
	ldx	#hdmacol	; address where the list is located
	stx	$4312
	lda	#^hdmacol	; bank the list is located
	sta	$4314


	lda	#$02		; write twice
	sta	$4320
	lda	#$0d		; $210d, plane 1 H pos offset
	sta	$4321
	ldx	#$9800		; the colors will be at $7f8000!!
	stx	$4322
	lda	#$7e
	sta	$4324

	lda	#$00
	sta	$4330
	lda	#$05		; $2105, screen mode, tile size.. etc
	sta	$4331
	ldx	#hdmamode
	stx	$4332		
	lda	#^hdmamode
	sta	$4334


	lda	#$00
	sta	$4340
	lda	#$08
	sta	$4341		; $2108 (plane 2 tile location)
	ldx	#hdmaplan2
	stx	$4342
	lda	#^hdmaplan2
	sta	$4344

	lda	#$00
	sta	$4350
	lda	#$0b
	sta	$4351		; $210b (plane 1&2 gfx location)
	ldx	#hdmaplan12gfx
	stx	$4352
	lda	#^hdmaplan12gfx
	sta	$4354




	jsr	WaitVb
	lda	#%111111
	sta	$420c
	rts

hdmaplan12gfx:
	dc.b	$40,0,$40,0
	dc.b	1,$32,0,0

hdmamode:
	dc.b	$40,2,$40,2
	dc.b	1,1,0,0

hdmaplan2:
	
	dc.b	$40,$48,$40,$48
	dc.b	1,$44,0,0


hdmapal:

	dc.b	$40,0,$40,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	0,0

hdmacol:
	dc.b	$40
	dcr.w	$0000
	dc.b	$40
	dcr.w	$0000
	dc.b	1
	dcr.w	$0421
	dc.b	1
	dcr.w	$0842
	dc.b	1
	dcr.w	$0C63
	dc.b	1
	dcr.w	$1084
	dc.b	1
	dcr.w	$14A5
	dc.b	1
	dcr.w	$18C6
	dc.b	1
	dcr.w	$1CE7
	dc.b	1
	dcr.w	$2108
	dc.b	1
	dcr.w	$2529
	dc.b	1
	dcr.w	$294A
	dc.b	1
	dcr.w	$2D6B
	dc.b	1
	dcr.w	$318C
	dc.b	0
	dcr.w	0 
 



;==========================================================================
;                              Sprite Setup Routine
;==========================================================================

Sprite_setup:
	ldx	#$0000
	ldy	#$0000
sprtclear:
	stz	oam,x		; H pos
	inx
	lda	#$e0
	sta	oam,x		; V pos
	inx
	stz	oam,x		; object
	inx
	stz	oam,x		;priority
	inx
	iny
	cpy	#$0080
	bne	sprtclear
	ldx	#$0000
sprtdataclear:
	stz	oam,x
	inx
	stz	oam,x
	inx
	cpx	#$0020
	bne	sprtdataclear

	ldx	#$200


	lda	#%00000010
	sta	oam,x



	lda	#$50
	sta	oam
	sta	oam+1
	lda	#$08
	sta	oam+2		; pointer's sprite info
	lda	#$31
	sta	oam+3

	ldx	#$0000
	txy	

	lda	#$18
	sta	xstorage1

copynumbersprites:
	lda	xstorage1
	sta	oam+4,x
	lda	#$b0
	sta	oam+5,x
	
	lda	numbers1,y	; song # sprites 1-9
	sta	oam+6,x
	lda	#$33
	sta	oam+7,x

	lda	xstorage1
	clc
	adc	#$18
	sta	xstorage1

	inx
	inx
	inx
	inx
	iny
	cpy	#$0009
	bne	copynumbersprites

	ldx	#$0028
	lda	#$18
	sta	oam,x
	lda	#$b0
	sta	oam+1,x
	lda	#$64		; selected song # highlight box
	sta	oam+2,x
	lda	#$31
	sta	oam+3,x



	ldx	#$002c
	lda	#$18
	sta	oam,x
	lda	#$a0
	sta	oam+1,x
	lda	#$66		; selected song # baby uni sprite data
	sta	oam+2,x
	lda	#$31
	sta	oam+3,x


	ldx	#$30
	lda	#$80
	sta	oam,x
	lda	#$68
	sta	oam+1,x
	lda	#$02		; top of Turtle
	sta	oam+2,x
	lda	#$34
	sta	oam+3,x

	ldx	#$34
	lda	#$80
	sta	oam,x
	lda	#$78
	sta	oam+1,x		; bottom of Turtle
	lda	#$22
	sta	oam+2,x
	lda	#$34
	sta	oam+3,x


	ldx	#$38
	lda	#$a0
	sta	oam,x
	lda	#$78
	sta	oam+1,x
	lda	#$06		; Turtle Shell
	sta	oam+2,x
	lda	#$34
	sta	oam+3,x




	rts


numbers1:
	dc.b	$42,$44,$46,$48,$4a,$4c,$4e,$60,$62



;==========================================================================
;                    SNES Register Initialization Routine
;==========================================================================
Snes_Init:
	sep 	#$30    ; X,Y,A are 8 bit numbers
	lda 	#$8F    ; screen off, full brightness
	sta 	$2100   ; brightness + screen enable register 
	stz 	$2101   ; Sprite register (size + address in VRAM)
	stz 	$2102   ; Sprite registers (address of sprite memory [OAM])
	stz 	$2103   ;    ""                       ""
	stz 	$2105   ; Mode 0, = Graphic mode register
	stz 	$2106   ; noplanes, no mosaic, = Mosaic register
	stz 	$2107   ; Plane 0 map VRAM location
	stz 	$2108   ; Plane 1 map VRAM location
	stz 	$2109   ; Plane 2 map VRAM location
	stz 	$210A   ; Plane 3 map VRAM location
	stz 	$210B   ; Plane 0+1 Tile data location
	stz 	$210C   ; Plane 2+3 Tile data location
	stz 	$210D   ; Plane 0 scroll x (first 8 bits)
	stz 	$210D   ; Plane 0 scroll x (last 3 bits) #$0 - #$07ff
	stz 	$210E   ; Plane 0 scroll y (first 8 bits)
	stz 	$210E   ; Plane 0 scroll y (last 3 bits) #$0 - #$07ff
	stz 	$210F   ; Plane 1 scroll x (first 8 bits)
	stz 	$210F   ; Plane 1 scroll x (last 3 bits) #$0 - #$07ff
	stz 	$2110   ; Plane 1 scroll y (first 8 bits)
	stz 	$2110   ; Plane 1 scroll y (last 3 bits) #$0 - #$07ff
	stz 	$2111   ; Plane 2 scroll x (first 8 bits)
	stz 	$2111   ; Plane 2 scroll x (last 3 bits) #$0 - #$07ff
	stz 	$2112   ; Plane 2 scroll y (first 8 bits)
	stz 	$2112   ; Plane 2 scroll y (last 3 bits) #$0 - #$07ff
	stz 	$2113   ; Plane 3 scroll x (first 8 bits)
	stz 	$2113   ; Plane 3 scroll x (last 3 bits) #$0 - #$07ff
	stz 	$2114   ; Plane 3 scroll y (first 8 bits)
	stz 	$2114   ; Plane 3 scroll y (last 3 bits) #$0 - #$07ff
	lda 	#$80    ; increase VRAM address after writing to $2119
	sta 	$2115   ; VRAM address increment register
	stz 	$2116   ; VRAM address low
	stz 	$2117   ; VRAM address high
	stz 	$211A   ; Initial Mode 7 setting register
	stz 	$211B   ; Mode 7 matrix parameter A register (low)
	lda 	#$01
	sta 	$211B   ; Mode 7 matrix parameter A register (high)
	stz 	$211C   ; Mode 7 matrix parameter B register (low)
	stz 	$211C   ; Mode 7 matrix parameter B register (high)
	stz 	$211D   ; Mode 7 matrix parameter C register (low)
	stz 	$211D   ; Mode 7 matrix parameter C register (high)
	stz 	$211E   ; Mode 7 matrix parameter D register (low)
	sta 	$211E   ; Mode 7 matrix parameter D register (high)
	stz 	$211F   ; Mode 7 center position X register (low)
	stz 	$211F   ; Mode 7 center position X register (high)
	stz 	$2120   ; Mode 7 center position Y register (low)
	stz 	$2120   ; Mode 7 center position Y register (high)
	stz 	$2121   ; Color number register ($0-ff)
	stz 	$2123   ; BG1 & BG2 Window mask setting register
	stz 	$2124   ; BG3 & BG4 Window mask setting register
	stz 	$2125   ; OBJ & Color Window mask setting register
	stz 	$2126   ; Window 1 left position register
	stz 	$2127   ; Window 2 left position register
	stz 	$2128   ; Window 3 left position register
	stz 	$2129   ; Window 4 left position register
	stz 	$212A   ; BG1, BG2, BG3, BG4 Window Logic register
	stz 	$212B   ; OBJ, Color Window Logic Register (or,and,xor,xnor)
	sta 	$212C   ; Main Screen designation (planes, sprites enable)
	stz 	$212D   ; Sub Screen designation
	stz 	$212E   ; Window mask for Main Screen
	stz 	$212F   ; Window mask for Sub Screen
	lda 	#$30
	sta 	$2130   ; Color addition & screen addition init setting
	stz 	$2131   ; Add/Sub sub designation for screen, sprite, color
	lda 	#$E0
	sta 	$2132   ; color data for addition/subtraction
	stz 	$2133   ; Screen setting (interlace x,y/enable SFX data)
	stz 	$4200   ; Enable V-blank, interrupt, Joypad register
	lda 	#$FF
	sta 	$4201   ; Programmable I/O port
	stz 	$4202   ; Multiplicand A
	stz 	$4203   ; Multiplier B
	stz 	$4204   ; Multiplier C
	stz 	$4205   ; Multiplicand C
	stz 	$4206   ; Divisor B
	stz 	$4207   ; Horizontal Count Timer
	stz 	$4208   ; Horizontal Count Timer MSB (most significant bit)
	stz 	$4209   ; Vertical Count Timer
	stz 	$420A   ; Vertical Count Timer MSB
	stz 	$420B   ; General DMA enable (bits 0-7)
	stz 	$420C   ; Horizontal DMA (HDMA) enable (bits 0-7)
	stz 	$420D	; Access cycle designation (slow/fast rom)
	rtl






musicrouts:

	dcr.w	music0
	dcr.w	music1
	dcr.w	music2
	dcr.w	music3
	dcr.w	music4
	dcr.w	music5
	dcr.w	music6
	dcr.w	music7
	dcr.w	music8

music0:
	sep	#$20
	REP #$30
	

	LDX #$0032 	;32 32 32 32 32 33 32 32 32
	JSL $82807E
	REP #$10   
	LDX #$0035	;36 36 36 36 36 37 34  34 35 
	JSL $82807E
	REP #$10   
	LDX #$0039	;42 41 3f 3e 40 3c 3a  38 39
	JSL $82807E
	LDX #$FBd5	;fb55 fb55 fb55 fb55 fb55 fb15 fbd5 fb15 fbd5 
	JSL $8282A5
	LDA #$0102 
	JSL $828000
	LDA #$08FF 
	JSL $828000
	LDA #$077F 	; 77f
	JSL $828000
	SEP #$20

	jsr	muscloop1
	jsr	muscloop1
	jsr	muscloop1
	rts

music1:
	sep	#$20
	REP #$30
	

	LDX #$0032 	;32 32 32 32 32 33 32 32 32
	JSL $82807E
	REP #$10   
	LDX #$0034	;36 36 36 36 36 37 34  34 35 
	JSL $82807E
	REP #$10   
	LDX #$0038	;42 41 3f 3e 40 3c 3a  38 39
	JSL $82807E
	LDX #$FB15	;fb55 fb55 fb55 fb55 fb55 fb15 fbd5 fb15 fbd5 
	JSL $8282A5
	LDA #$0102 
	JSL $828000
	LDA #$08FF 
	JSL $828000
	LDA #$077F 	; 77f
	JSL $828000
	SEP #$20

	jsr	muscloop1
	jsr	muscloop1
	jsr	muscloop1
	rts


music2:
	sep	#$20
	REP #$30
	

	LDX #$0032 	;32 32 32 32 32 33 32 32 32
	JSL $82807E
	REP #$10   
	LDX #$0034	;36 36 36 36 36 37 34  34 35 
	JSL $82807E
	REP #$10   
	LDX #$003a	;42 41 3f 3e 40 3c 3a  38 39
	JSL $82807E
	LDX #$FBd5	;fb55 fb55 fb55 fb55 fb55 fb15 fbd5 fb15 fbd5 
	JSL $8282A5
	LDA #$0102 
	JSL $828000
	LDA #$08FF 
	JSL $828000
	LDA #$077F 	; 77f
	JSL $828000
	SEP #$20

	jsr	muscloop1
	jsr	muscloop1
	jsr	muscloop1
	rts


music3:
	sep	#$20
	REP #$30
	

	LDX #$0033 	;32 32 32 32 32 33 32 32 32
	JSL $82807E
	REP #$10   
	LDX #$0037	;36 36 36 36 36 37 34  34 35 
	JSL $82807E
	REP #$10   
	LDX #$003c	;42 41 3f 3e 40 3c 3a  38 39
	JSL $82807E
	LDX #$FB15	;fb55 fb55 fb55 fb55 fb55 fb15 fbd5 fb15 fbd5 
	JSL $8282A5
	LDA #$0102 
	JSL $828000
	LDA #$08FF 
	JSL $828000
	LDA #$077F 	; 77f
	JSL $828000
	SEP #$20

	jsr	muscloop1
	jsr	muscloop1
	jsr	muscloop1
	rts


music4:
	sep	#$20
	REP #$30
	

	LDX #$0032 	;32 32 32 32 32 33 32 32 32
	JSL $82807E
	REP #$10   
	LDX #$0036	;36 36 36 36 36 37 34  34 35 
	JSL $82807E
	REP #$10   
	LDX #$0040	;42 41 3f 3e 40 3c 3a  38 39
	JSL $82807E
	LDX #$FB55	;fb55 fb55 fb55 fb55 fb55 fb15 fbd5 fb15 fbd5 
	JSL $8282A5
	LDA #$0102 
	JSL $828000
	LDA #$08FF 
	JSL $828000
	LDA #$077F 	; 77f
	JSL $828000
	SEP #$20

	jsr	muscloop1
	jsr	muscloop1
	jsr	muscloop1
	rts



music5:
	sep	#$20
	REP #$30
	

	LDX #$0032 	;32 32 32 32 32 33 32 32 32
	JSL $82807E
	REP #$10   
	LDX #$0036	;36 36 36 36 36 37 34  34 35 
	JSL $82807E
	REP #$10   
	LDX #$003e	;42 41 3f 3e 40 3c 3a  38 39
	JSL $82807E
	LDX #$FB55	;fb55 fb55 fb55 fb55 fb55 fb15 fbd5 fb15 fbd5 
	JSL $8282A5
	LDA #$0102 
	JSL $828000
	LDA #$08FF 
	JSL $828000
	LDA #$077F 	; 77f
	JSL $828000
	SEP #$20

	jsr	muscloop1
	jsr	muscloop1
	jsr	muscloop1
	rts



music6:
	sep	#$20
	REP #$30
	

	LDX #$0032 	;32 32 32 32 32 33 32 32 32
	JSL $82807E
	REP #$10   
	LDX #$0036	;36 36 36 36 36 37 34  34 35 
	JSL $82807E
	REP #$10   
	LDX #$003f	;42 41 3f 3e 40 3c 3a  38 39
	JSL $82807E
	LDX #$FB55	;fb55 fb55 fb55 fb55 fb55 fb15 fbd5 fb15 fbd5 
	JSL $8282A5
	LDA #$0102 
	JSL $828000
	LDA #$08FF 
	JSL $828000
	LDA #$077F 	; 77f
	JSL $828000
	SEP #$20

	jsr	muscloop1
	jsr	muscloop1
	jsr	muscloop1
	rts


music7:
	sep	#$20
	REP #$30
	

	LDX #$0032 	;32 32 32 32 32 33 32 32 32
	JSL $82807E
	REP #$10   
	LDX #$0036	;36 36 36 36 36 37 34  34 35 
	JSL $82807E
	REP #$10   
	LDX #$0041	;42 41 3f 3e 40 3c 3a  38 39
	JSL $82807E
	LDX #$FB55	;fb55 fb55 fb55 fb55 fb55 fb15 fbd5 fb15 fbd5 
	JSL $8282A5
	LDA #$0102 
	JSL $828000
	LDA #$08FF 
	JSL $828000
	LDA #$077F 	; 77f
	JSL $828000
	SEP #$20

	jsr	muscloop1
	jsr	muscloop1
	jsr	muscloop1
	rts


music8:
	sep	#$20
	REP #$30
	

	LDX #$0032 	;32 32 32 32 32 33 32 32 32
	JSL $82807E
	REP #$10   
	LDX #$0036	;36 36 36 36 36 37 34  34 35 
	JSL $82807E
	REP #$10   
	LDX #$0042	;42 41 3f 3e 40 3c 3a  38 39
	JSL $82807E
	LDX #$FB55	;fb55 fb55 fb55 fb55 fb55 fb15 fbd5 fb15 fbd5 
	JSL $8282A5
	LDA #$0102 
	JSL $828000
	LDA #$08FF 
	JSL $828000
	LDA #$077F 	; 77f
	JSL $828000
	SEP #$20

	jsr	muscloop1
	jsr	muscloop1
	jsr	muscloop1
	rts


muscloop1:
	JSL $828035
	LDA $4212  
	BMI muscloop1
muscloop2:
	JSL $828035
	LDA $4212  
	BPL muscloop2
	rts


muscloop3:
	JSL $828035
	LDA $4212  
	BMI muscloop3
muscloop4:
	JSL $828035
	LDA $4212  
	BPL muscloop4
	rtl


	org	$fffc	;reset vector in 6502 mode
	dcr.w	Start
	.pad



Colors:

	; BG colors
	.bin	xmas1.col
	.bin	xmas2.col
	.bin	street1.col
	.bin	street2.col

	; snow colors

	dc.w	$0000,$0000,$0000,$0000,$0000,$0000,$0000,$0000
	dc.w	$0000,$0000,$0000,$0000,$FF7F,$0000,$1042,$0000 
 
 

	dc.w	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	dc.w	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	dc.w	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	;sprite colors
	.bin	unipoint.col
	.bin	unifont.col
	.bin	turt.col
	dc.w	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	dc.w	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	dc.w	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	dc.w	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	dc.w	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	

logogfx:
	.bin	xmas1.dat
logotiles:


	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0520,$0620,$0720,$0820,$0920
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0A20,$0B20,$0C20,$0D20,$0E20
	dc.w	$0020,$0F20,$1020,$1120,$1220,$0020,$1320,$1420
	dc.w	$1520,$1620,$1720,$0020,$1820,$1920,$1A20,$1B20
	dc.w	$1C20,$1D20,$1E20,$0020,$1F20,$2020,$0020,$0020
	dc.w	$0020,$0020,$2120,$2220,$2320,$2420,$2520,$2620
	dc.w	$2720,$2820,$2920,$2A20,$2B20,$2C20,$2D20,$2E20
	dc.w	$2F20,$3020,$3120,$3220,$3320,$3420,$3520,$3620
	dc.w	$3720,$3820,$3920,$3A20,$3B20,$3C20,$0020,$0020
	dc.w	$0020,$0020,$3D20,$3E20,$3F20,$4020,$4120,$4220
	dc.w	$4320,$4420,$4520,$4620,$4720,$4820,$4920,$4A20
	dc.w	$4B20,$4C20,$4D20,$4E20,$4F20,$5020,$5120,$5220
	dc.w	$0020,$5320,$5420,$5520,$5620,$0020,$0020,$0020
	dc.w	$0020,$0020,$5720,$5820,$5920,$0020,$5A20,$5B20
	dc.w	$5C20,$5D20,$5E20,$5F20,$6020,$6120,$6220,$6320
	dc.w	$0020,$0020,$0020,$6420,$6520,$0020,$0020,$0020
	dc.w	$0020,$6620,$6720,$6820,$6920,$0020,$0020,$0020
	dc.w	$0020,$0020,$6A20,$6B20,$0020,$0020,$6C20,$6D20
	dc.w	$6E20,$6F20,$7020,$7120,$7220,$7320,$7420,$7520
	dc.w	$0020,$0020,$0020,$7620,$7720,$0020,$0020,$0020
	dc.w	$7820,$7920,$7A20,$7B20,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$7C20,$7D20,$7E20,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$7F20,$8020,$8120,$8220,$8320
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$8420,$8520
	dc.w	$8620,$8720,$8820,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$8920,$8A20,$8B20,$8C20,$8D20
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$8E20,$8F20
	dc.w	$9020,$9120,$9220,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$9320,$9420,$9520,$9620,$0020
	dc.w	$9720,$9820,$9920,$9A20,$9B20,$9C20,$9D20,$9E20
	dc.w	$9F20,$A020,$A120,$A220,$A320,$A420,$A520,$A620
	dc.w	$0020,$A720,$A820,$A920,$AA20,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$AB20,$AC20,$AD20,$0020
	dc.w	$AE20,$AF20,$B020,$B120,$B220,$B320,$B420,$B520
	dc.w	$B620,$B720,$B820,$B920,$BA20,$BB20,$BC20,$BD20
	dc.w	$BE20,$BF20,$C020,$C120,$C220,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$C320,$C420,$C520,$C620,$C720
	dc.w	$C820,$C920,$CA20,$CB20,$CC20,$CD20,$CE20,$CF20
	dc.w	$D020,$D120,$D220,$D320,$D420,$D520,$D620,$D720
	dc.w	$D820,$D920,$DA20,$DB20,$DC20,$1E20,$0020,$0020
	dc.w	$0020,$0020,$DD20,$DE20,$DF20,$E020,$E120,$E220
	dc.w	$E320,$0020,$0020,$0020,$0020,$E420,$E520,$E620
	dc.w	$E720,$E820,$E920,$EA20,$EB20,$EC20,$ED20,$EE20
	dc.w	$EF20,$F020,$F120,$F220,$F320,$F420,$0020,$0020
	dc.w	$0020,$0020,$F520,$F620,$F720,$F820,$F920,$FA20
	dc.w	$FB20,$0020,$0020,$0020,$0020,$FC20,$FD20,$0020
	dc.w	$FE20,$FF20,$0021,$0121,$0221,$0321,$0421,$0521
	dc.w	$0621,$0721,$0821,$0921,$0A21,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020
	dc.w	$0020,$0020,$0020,$0020,$0020,$0020,$0020,$0020 
 
snowtiles:

	dc.w	$0030,$0130,$0030,$0030,$0030,$0030,$0330,$0030 ;
	dc.w	$0030,$0030,$0430,$0030,$0030,$0030,$0230,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0130,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0330 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0230,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0330,$0030 ;
	dc.w	$0030,$0030,$0430,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0130,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0130,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0430,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0230 ;
	dc.w	$0030,$0030,$0430,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0430,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0430,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0330,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0430,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0230,$0030,$0030,$0030,$0030,$0330,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0130
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0330,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0330,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0230,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0430,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0330,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0430,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0130,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0230,$0030,$0030,$0430 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0430,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0130,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0330,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0230,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0430
	dc.w	$0030,$0030,$0030,$0230,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0130,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0430,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0430,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0330
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0130,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0430,$0030,$0030,$0130,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0430,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0330,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0230,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0330,$0030
	dc.w	$0030,$0330,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0330,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0330,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0330,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0430,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0430,$0030,$0030
	dc.w	$0030,$0130,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0130,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0130,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0130,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0230,$0030,$0030,$0030 ;
	dc.w	$0430,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0430,$0030
	dc.w	$0030,$0030,$0330,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0330,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0430,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0230,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030
	dc.w	$0030,$0030,$0030,$0030,$0030,$0030,$0030,$0030 ;
	dc.w	$0030,$0030,$0030,$0030,$0130,$0030,$0030,$0030
	dc.w	$0030,$0130,$0030,$0030,$0330,$0030,$0030,$0130 ;
	dc.w	$0030,$0030,$0330,$0030,$0030,$0230,$0030,$0030 
 



spritegfx:
	.bin	unipoint.dat

sine:

 dcr.w  -1,6,12,18,25,31,37,43,49,55,62,68,74,80,86,91,97,103,109,114
 dcr.w  120,125,131,136,141,147,152,157,162,166,171,176,180,185,189
 dcr.w  193,197,201,205,208,212,215,219,222,225,228,230,233,236,238
 dcr.w  240,242,244,246,247,249,250,251,252,253,254,254,255,255,255
 dcr.w  255,255,254,254,253,252,251,250,249,247,246,244,242,240,238
 dcr.w  236,233,230,228,225,222,219,215,212,208,205,201,197,193,189
 dcr.w  185,180,176,171,166,162,157,152,147,141,136,131,125,120,114
 dcr.w  109,103,97,91,86,80,74,68,62,55,49,43,37,31,25,18,12,6,-1,-7
 dcr.w  -13,-19,-26,-32,-38,-44,-50,-56,-63,-69,-75,-81,-87,-92,-98
 dcr.w  -104,-110,-115,-121,-126,-132,-137,-142,-148,-153,-158,-163
 dcr.w  -167,-172,-177,-181,-186,-190,-194,-198,-202,-206,-209,-213
 dcr.w  -216,-220,-223,-226,-229,-231,-234,-237,-239,-241,-243,-245
 dcr.w  -247,-248,-250,-251,-252,-253,-254,-255,-255,-256,-256,-256
 dcr.w  -256,-256,-255,-255,-254,-253,-252,-251,-250,-248,-247,-245
 dcr.w  -243,-241,-239,-237,-234,-231,-229,-226,-223,-220,-216,-213
 dcr.w  -209,-206,-202,-198,-194,-190,-186,-181,-177,-172,-167,-163
 dcr.w  -158,-153,-148,-142,-137,-132,-126,-121,-115,-110,-104,-98
 dcr.w  -92,-87,-81,-75,-69,-63,-56,-50,-44,-38,-32,-26,-19,-13,-7



	.pad
musiccode:
	.bin	music.prg


streetgfx:
	.bin	street.dat

streetanim1:

	dc.w	$0028
	dc.w	$0028,$0028,$0028,$0028,$0128,$0228,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;;
	dc.w	$502c,$512c,$002c,$002c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$0028,$0728,$0828,$0928,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;;
	dc.w	$5A2c,$5B2c,$5C2c,$5D2c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$0028,$0E28,$0F28,$1028,$1128,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028 
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;;
	dc.w	$662c,$672c,$682c,$692c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$0028,$1928,$1A28,$1B28,$1C28,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;;
	dc.w	$732c,$742c,$752c,$762c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$2528,$2628,$2728,$2828,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;;
	dc.w	$802c,$812c,$822c,$832c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$3128,$3228,$3328,$3428,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;;
	dc.w	$8C2c,$8D2c,$8E2c,$8F2c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$3628,$3728,$3828,$3928,$3A28,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;;
	dc.w	$982c,$992c,$9A2c,$9B2c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$3B28,$3C28,$3D28,$3E28,$3F28,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$A62c ;;
	dc.w	$A72c,$A82c,$A92c,$AA2c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$4028,$4128,$4228,$0028,$4328,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$B52c ;;
	dc.w	$B62c,$B72c,$B82c,$B92c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$4428,$4528,$0028,$0028,$4628,$4728 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$C22c ;;
	dc.w	$C32c,$002c,$C42c,$C52c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;;
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;;
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c 
 

streetanim2:

	dc.w	$0028
	dc.w	$0028,$0028,$0028,$0028,$0328,$0428,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;*
	dc.w	$4C2c,$4D2c,$4E2c,$4F2c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$0028,$0028,$0A28,$0B28,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;;
	dc.w	$562c,$572c,$582c,$592c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$0028,$1228,$1328,$1428,$1528,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;;
	dc.w	$622c,$632c,$642c,$652c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$0028,$1D28,$1E28,$1F28,$2028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$6E2c ;;
	dc.w	$6F2c,$702c,$712c,$722c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$2528,$2928,$2A28,$2B28,$2C28,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$7B2c ;;
	dc.w	$7C2c,$7D2c,$7E2c,$7F2c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$3128,$3228,$3328,$3428,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;;
	dc.w	$882c,$892c,$8A2c,$8B2c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$3628,$3728,$3828,$3928,$3A28,$0028 ; 
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;;
	dc.w	$942c,$952c,$962c,$972c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$3B28,$3C28,$3D28,$3E28,$3F28,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$A12c ;;
	dc.w	$A22c,$A32c,$A42c,$A52c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$4028,$4128,$4228,$0028,$4328,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$B02c ;;
	dc.w	$B12c,$B22c,$B32c,$B42c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$4428,$4528,$0028,$0028,$4628,$4728 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$BE2c ;;
	dc.w	$BF2c,$002c,$C02c,$C12c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;;
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;;
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c 
 

streetanim3:
	dc.w	$0028
	dc.w	$0028,$0028,$0028,$0028,$0528,$0628,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028  
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;*
	dc.w	$482c,$492c,$4A2c,$4B2c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$0028,$0028,$0C28,$0D28,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;*
	dc.w	$522c,$532c,$542c,$552c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$0028,$1628,$1728,$1828,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;*
	dc.w	$5E2c,$5F2c,$602c,$612c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$0028,$2128,$2228,$2328,$2428,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;*
	dc.w	$6A2c,$6B2c,$6C2c,$6D2c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$2528,$2D28,$2E28,$2F28,$3028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;*
	dc.w	$772c,$782c,$792c,$7A2c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$3128,$3228,$3528,$3428,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;*
	dc.w	$842c,$852c,$862c,$872c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$3628,$3728,$3828,$3928,$3A28,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;*
	dc.w	$902c,$912c,$922c,$932c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$3B28,$3C28,$3D28,$3E28,$3F28,$0028 ; 
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$9C2c ;*
	dc.w	$9D2c,$9E2c,$9F2c,$A02c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$4028,$4128,$4228,$0028,$4328,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$AB2c ;*
	dc.w	$AC2c,$AD2c,$AE2c,$AF2c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$4428,$4528,$0028,$0028,$4628,$4728 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$BA2c ;*
	dc.w	$BB2c,$002c,$BC2c,$BD2c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;*
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028 ;
	dc.w	$0028,$0028,$0028,$0028,$0028,$0028,$0028,$0028
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c ;*
	dc.w	$002c,$002c,$002c,$002c,$002c,$002c,$002c,$002c 
 
	.pad

;============================================================================
;                        Start of ESI intro routine
;============================================================================

ESIStart:
	sei			; Stop Interrupts
	phk			; Actuell bank on stack
	plb			; Actuell bank from stack on data bank 
	clc			; Clr Carry
	xce			; Native 16 bitmode  (no 6502 Emulation!) 
;==========================================================================
	jsr	!ESISnes_init

	sep	#$20
	REP #$30
	

	LDX #$0032 	;32 32 32 32 32 33 32 32 32
	JSL $82807E
	REP #$10   
	LDX #$0034	;36 36 36 36 36 37 34  34 35 
	JSL $82807E
	REP #$10   
	LDX #$003a	;42 41 3f 3e 40 3c 3a  38 39
	JSL $82807E
	LDX #$FBd5	;fb55 fb55 fb55 fb55 fb55 fb15 fbd5 fb15 fbd5 
	JSL $8282A5
	LDA #$0102 
	JSL $828000
	LDA #$08FF 
	JSL $828000
	LDA #$077F 	; 77f
	JSL $828000
	SEP #$20
	jsl	>muscloop3
	jsl	>muscloop3
	jsl	>muscloop3


	rep     #$30		; X,Y,A fixed -> 16 bit mode
	sep     #$20		; Accumulator ->  8 bit mode

	Lda	#$01		; mode 1, 8/8 dot
	Sta	$2105	

	Lda	#$70		; Start Tile Adres BG1 $7000
	Sta	$2107	
	Stz	$210b		; Start Gfx in Vram  $0000

	lda	#$74
	sta	$2109
	lda	#$44
	sta	$210c
	
	lda	#$fc
	sta	$2112
	lda	#$07
	sta	$2112

	Lda	#$00		; BG1 Enable
	Sta	$212c
	jsr	!ESICopy_Gfx
	jsr	!ESICopy_Colors
	jsr	!ESIMake_Tiles
	stz	hdmaplaneon		; value for HDMA planes (# planes on)
	jsr	!ESIHDMA
	ldx	#$0000
	stx	currentline		; current # of line
	stx	drawonoff		; toggle hdma plane draw on/off 0=on
	stx	scrollonoff
	stx	speedtoggle
	lda	#$01
	sta	$4200


	Lda	#$0f		; Screen Blanker Enabled
	Sta	$2100		;
;======================= End Init =========================================

ESIWait1:
	jsr	!ESIWaitVb


	lda	drawonoff
	bne	Planestop
	jsr	!Planedraw
	bra	ESIWait1
Planestop:
	lda	#$05
	sta	$212c
ESIWait2:
	jsr	!ESIcleanram
	ldx	#$0000
	stx	scrollxoffset		; scroll x offset
	stx	scrolltextoffset		; scroll text offset
	stx	cycleoffset		; cycle offset
	stx	scrollonoff		; scroll stop  1=stop
	ldx	#$00ff
	stx	doublechar
ESIWait3:
	jsr	!ESIWaitVb
	jsr	!ESIscr
	jsr	!ESIcyc
	jsr	!ESIscroll
	jsr	!ESIcount

	lda	speedtoggle
	eor	#$01
	sta	speedtoggle
	beq	ESIskipframe

	jsr	!ESIscroll
	jsr	!ESIcount
ESIskipframe:
	jsr	!ESIjoypad



	lda	scrollonoff
	beq	ESIWait3
	jsr	!ESIWaitVb
	stz	$420b
	stz	$420c
	lda	#$80
	sta	$2100
	stz	$212c

ESIWait5:
	rtl

;==========================================================================
;                        Start of ESI joypad intro exit
;==========================================================================

ESIjoypad:
	lda	$4212
	and	#$01
	bne	ESIjoypad

	rep	#$30
	lda	$4218
	and	#$c0c0
	bne	ESIintroend
	sep	#$20
	rts

ESIintroend:
	sep	#$20
	lda	#$01
	sta	scrollonoff
	rts


;==========================================================================
;                         Start of ESI Scroll routine
;==========================================================================

ESIcyc:
	ldx	#$7720
	stx	$2116

	ldx	cycleoffset
	ldy	#$0000
ESIcopESIcyc
	lda	!ESIcycle,x
	sta	$2119
	inx
	iny
	cpy	#$0020
	bne	ESIcopESIcyc	
	inc	cycleoffset
	lda	cycleoffset
	cmp	#$20
	beq	ESIcycreset
	rts
ESIcycreset:
	stz	cycleoffset
	rts

ESIscr:
	lda	#$00
	sta	$4330		; 0= 1 byte per register (not a word!)
	lda	#$18
	sta	$4331		; 21xx   this is 2118 (VRAM)
	lda	#$00
	sta	$4332
	lda	#$0a		; address = $7e0a00
	sta	$4333
	lda	#$7e
	sta	$4334		; bank address of data in ram
	ldx	#$0100
	stx	$4335		; # of bytes to be transferred
	lda	#$00
	sta	$2115		; increase V-Ram address after writing to
				; $2118
	ldx	#$4000
	stx	$2116		; address of VRAM to copy garphics in
	lda	#$08		; turn on bit 4 (%1000=8) of G-DMA channel
	sta	$420b
	lda	#$80		; increase V-Ram address after writing to
	sta	$2115		; $2119
	rts


ESIscroll:
	ldx	#$0000
RollESI:
	lda	doublechar
	beq	Rollcopybit1
	lda	$0b00,x
	asl a
	bra	Rollcopybit2
Rollcopybit1:
	asl	$0b00,x
Rollcopybit2:
	rol	$0af8,x
	rol	$0af0,x
	rol	$0ae8,x
	rol	$0ae0,x
	rol	$0ad8,x
	rol	$0ad0,x
	rol	$0ac8,x
	rol	$0ac0,x
	rol	$0ab8,x
	rol	$0ab0,x
	rol	$0aa8,x
	rol	$0aa0,x
	rol	$0a98,x
	rol	$0a90,x
	rol	$0a88,x
	rol	$0a80,x
	rol	$0a78,x
	rol	$0a70,x
	rol	$0a68,x
	rol	$0a60,x
	rol	$0a58,x
	rol	$0a50,x
	rol	$0a48,x
	rol	$0a40,x
	rol	$0a38,x
	rol	$0a30,x
	rol	$0a28,x
	rol	$0a20,x
	rol	$0a18,x
	rol	$0a10,x
	rol	$0a08,x
	rol	$0a00,x
	inx
	cpx	#$0008
	bne	RollESI
	lda	doublechar
	eor	#$ff
	sta	doublechar
	rts
ESIcount:
	lda	scrollxoffset
	inc a
	and	#$0f
	sta	scrollxoffset
	beq	GetESI
	rts
GetESI:
	ldx	scrolltextoffset
	lda	!ESIscrolltxt,x
	beq	ESIresetbscrpos
	rep	#$30
	and	#$003f
	asl a
	asl a
	asl a
	tax
	sep	#$20
	ldy	#$0000
ESIcopybscrdata:
	lda	>scrollchar,x
	sta	$0b00,y
	inx
	iny
	cpy	#$08
	bne	ESIcopybscrdata
	ldx	scrolltextoffset
	inx
	stx	scrolltextoffset
	rts
ESIresetbscrpos:
	inc	scrollonoff
	ldx	#$0000
	stx	scrolltextoffset
	jmp	!GetESI



;==========================================================================
;                        Start Vertical Blank
;==========================================================================
ESIWaitVb:
	lda	$4210		; NMI Enable (Begin V-Blank)
	bpl	ESIWaitVb		; 
	lda	$4210		; Reset NMI Flag By Reading it
	rts

;==========================================================================
;                         Clen Ram For Scroll
;==========================================================================

ESIcleanram:
	ldx	#$0a00
ESIcleanr:
	stz	$0000,x
	inx
	cpx	#$0b08
	bne	ESIcleanr
	rts
;==========================================================================
;                       Copy Graphics To Vram
;==========================================================================
ESICopy_Gfx:
	Ldx	#$0000		; Select Vram address $0000
	stx	$2116
ESICleanram:
	stz	$2118
	stz	$2119
	inx
	cpx	#$0000
	bne	ESICleanram



ESICopgfx:
	Lda	>ESIPIC,X	; Copy Gfx
	Sta	$2118
	Inx
	Lda	>ESIPIC,X
	Sta	$2119
	Inx
	Cpx	#$6800		; 32*28*8     *8       = $e000
	Bne	ESICopgfx		; x  y  bytes  planes  

	ldx	#$4000
	stx	$2116
	ldx	#$0000
ESICop2:	;lda	>scrollchar,x
	stz	$2118
	stz	$2119
	inx
	cpx	#$0280
	bne	ESICop2
	rts
;==========================================================================
;                      Copy Colors
;==========================================================================
ESICopy_Colors:
	Stz	$2121		; Select Color Register 1
	Ldx	#$0000
ESICopCol:
	Lda	>ESICOL,X
	Sta	$2122
	Inx
	Cpx	#$0010		; Number of Colors * 2(word) = $8 
	Bne	ESICopCol
	lda	#$09
	sta	$2121
	lda	#$18
	sta	$2122
	lda	#$63
	sta	$2122
	lda	#$0d
	sta	$2121
	lda	#$ff
	sta	$2122
	sta	$2122
	rts
;==========================================================================
;                      Make Tiles
;==========================================================================
ESIMake_Tiles:
	Ldx	#$7000		; Select Vram Address $7000
	Stx	$2116	
	Rep	#$20		; Accu 16 bits
	Lda	#$0000
ESIMTiles:	
	Sta	$2118
	inc a
	Cmp	#$0400		; 32 * 28 = x * y
	Bne	ESIMTiles
	Sep	#$20		; Accu 8 bits
	ldx	#$7400
	stx	$2116
	ldx	#$0000
ESIplane2:
	lda	#$20
	sta	$2118
	stz	$2119
	inx
	cpx	#$0400
	bne	ESIplane2
	ldx	#$7720
	stx	$2116
	ldx	#$0000
	lda	#$00
ESIdrawplane2:
	sta	$2118
	pha
	lda	#$0c
	sta	$2119
	pla
	inc a
	inx
	cpx	#$0020
	bne	ESIdrawplane2
	rts
;==========================================================================
;                         SNES Reg Init
;==========================================================================
ESISnes_init:
	sep 	#$30    ; X,Y,A are 8 bit numbers
	lda 	#$8F    ; screen off, full brightness
	sta 	$2100   ; brightness + screen enable register 
	stz 	$2101   ; Sprite register (size + address in VRAM)
	stz 	$2102   ; Sprite registers (address of sprite memory [OAM])
	stz 	$2103   ;    ""                       ""
	stz 	$2105   ; Mode 0, = Graphic mode register
	stz 	$2106   ; noplanes, no mosaic, = Mosaic register
	stz 	$2107   ; Plane 0 map VRAM location
	stz 	$2108   ; Plane 1 map VRAM location
	stz 	$2109   ; Plane 2 map VRAM location
	stz 	$210A   ; Plane 3 map VRAM location
	stz 	$210B   ; Plane 0+1 Tile data location
	stz 	$210C   ; Plane 2+3 Tile data location
	stz 	$210D   ; Plane 0 scroll x (first 8 bits)
	stz 	$210D   ; Plane 0 scroll x (last 3 bits) #$0 - #$07ff
	stz 	$210E   ; Plane 0 scroll y (first 8 bits)
	stz 	$210E   ; Plane 0 scroll y (last 3 bits) #$0 - #$07ff
	stz 	$210F   ; Plane 1 scroll x (first 8 bits)
	stz 	$210F   ; Plane 1 scroll x (last 3 bits) #$0 - #$07ff
	stz 	$2110   ; Plane 1 scroll y (first 8 bits)
	stz 	$2110   ; Plane 1 scroll y (last 3 bits) #$0 - #$07ff
	stz 	$2111   ; Plane 2 scroll x (first 8 bits)
	stz 	$2111   ; Plane 2 scroll x (last 3 bits) #$0 - #$07ff
	stz 	$2112   ; Plane 2 scroll y (first 8 bits)
	stz 	$2112   ; Plane 2 scroll y (last 3 bits) #$0 - #$07ff
	stz 	$2113   ; Plane 3 scroll x (first 8 bits)
	stz 	$2113   ; Plane 3 scroll x (last 3 bits) #$0 - #$07ff
	stz 	$2114   ; Plane 3 scroll y (first 8 bits)
	stz 	$2114   ; Plane 3 scroll y (last 3 bits) #$0 - #$07ff
	lda 	#$80    ; increase VRAM address after writing to $2119
	sta 	$2115   ; VRAM address increment register
	stz 	$2116   ; VRAM address low
	stz 	$2117   ; VRAM address high
	stz 	$211A   ; Initial Mode 7 setting register
	stz 	$211B   ; Mode 7 matrix parameter A register (low)
	lda 	#$01
	sta 	$211B   ; Mode 7 matrix parameter A register (high)
	stz 	$211C   ; Mode 7 matrix parameter B register (low)
	stz 	$211C   ; Mode 7 matrix parameter B register (high)
	stz 	$211D   ; Mode 7 matrix parameter C register (low)
	stz 	$211D   ; Mode 7 matrix parameter C register (high)
	stz 	$211E   ; Mode 7 matrix parameter D register (low)
	sta 	$211E   ; Mode 7 matrix parameter D register (high)
	stz 	$211F   ; Mode 7 center position X register (low)
	stz 	$211F   ; Mode 7 center position X register (high)
	stz 	$2120   ; Mode 7 center position Y register (low)
	stz 	$2120   ; Mode 7 center position Y register (high)
	stz 	$2121   ; Color number register ($0-ff)
	stz 	$2123   ; BG1 & BG2 Window mask setting register
	stz 	$2124   ; BG3 & BG4 Window mask setting register
	stz 	$2125   ; OBJ & Color Window mask setting register
	stz 	$2126   ; Window 1 left position register
	stz 	$2127   ; Window 2 left position register
	stz 	$2128   ; Window 3 left position register
	stz 	$2129   ; Window 4 left position register
	stz 	$212A   ; BG1, BG2, BG3, BG4 Window Logic register
	stz 	$212B   ; OBJ, Color Window Logic Register (or,and,xor,xnor)
	sta 	$212C   ; Main Screen designation (planes, sprites enable)
	stz 	$212D   ; Sub Screen designation
	stz 	$212E   ; Window mask for Main Screen
	stz 	$212F   ; Window mask for Sub Screen
	lda 	#$30
	sta 	$2130   ; Color addition & screen addition init setting
	stz 	$2131   ; Add/Sub sub designation for screen, sprite, color
	lda 	#$E0
	sta 	$2132   ; color data for addition/subtraction
	stz 	$2133   ; Screen setting (interlace x,y/enable SFX data)
	stz 	$4200   ; Enable V-blank, interrupt, Joypad register
	lda 	#$FF
	sta 	$4201   ; Programmable I/O port
	stz 	$4202   ; Multiplicand A
	stz 	$4203   ; Multiplier B
	stz 	$4204   ; Multiplier C
	stz 	$4205   ; Multiplicand C
	stz 	$4206   ; Divisor B
	stz 	$4207   ; Horizontal Count Timer
	stz 	$4208   ; Horizontal Count Timer MSB (most significant bit)
	stz 	$4209   ; Vertical Count Timer
	stz 	$420A   ; Vertical Count Timer MSB
	stz 	$420B   ; General DMA enable (bits 0-7)
	stz 	$420C   ; Horizontal DMA (HDMA) enable (bits 0-7)
	stz 	$420D	; Access cycle designation (slow/fast rom)
	rts


;============================================================================
;                    Start ESIHDMA routine to setup plane on/off HDMA
;============================================================================


ESIHDMA:
	rep	#$30
	sep	#$20
	;stz	$212c
	ldx	#$0000
	lda	#$00
ESIcleanHram
	sta	$7e8000,x
	inx
	cpx	#$8000
	bne	ESIcleanHram		; clean up ram, we need clean ram!!
	ldx	#$0000
	txy
Planesetup:
	lda	#$01
	sta	$7e8000,x		; line width = 1
	inx
	lda	hdmaplaneon			; planes on: 1 
	sta	$7e8000,x
	inx
	iny
	cpy	#$00ff
	bne	Planesetup
	lda	#$00			; width = 0; end HDMA
	sta	$7e8000,x
	sta	$7e8001,x


	lda	#$00
	sta	$4300		; 0= 1 byte per register (not a word!)
	lda	#$2c
	sta	$4301		; 21xx   this is 2118 (VRAM)
	lda	#$00
	sta	$4302
	lda	#$80		; address = $7e8000
	sta	$4303
	lda	#$7e
	sta	$4304		; bank address of data in ram


	jsr	!ESIWaitVb
	lda	#$01
	sta	$420c
	rts

;============================================================================
;                       Start of HDMA Plane Draw Routine
;============================================================================
Planedraw:

	rep	#$30
	lda	currentline
	asl a			; multiply by 2
	inc a
	tax
	sep	#$20
	lda	#$01
	sta	$7e8000,x	; turn on plane on in HDMA
	
	inc	currentline
	lda	currentline
	cmp	#$c8
	beq	StopPlaneDraw
	rts
StopPlaneDraw:
	inc	drawonoff
	stz	$420c
	lda	#$01
	sta	$212c
	rts



	; the following text for this ESI intro was taken from PIRATES!
	; cracked by ESI on the C64, text is exactly as it is in intro.
ESIscrolltxt:
	dc.b	"    -=*> 1994 CHRISTMAS LEFTOVERS <*=- WAS CRACKED BY EAGLE SOFT "
	DC.B	"INCORPORATED ON MAY 16TH, 1987...  AS USUAL MICROPROSE ANOTHER"
	DC.B	" FINE JOB! AND AS USUAL UCF IN PANIC!  WELL LOOKIE, LOOKIE "
	DC.B	"THAT MAKES TWO IN A ROW...     GREETINGS TO NEPA, THE ALLIANCE, "
	DC.B	"PFI, SRI, JAZZCAT, DYNAMIC DUO, UPN, AND ALL FLYERS FANS!!!"
	DC.B	"       QUESTION: WHY DO ALL LOOSER GROUPS START WITH THE LETTER "
	DC.B	'"U"?    FOR EXAMPLE UCF, UAN, AND USSPE...    ESI & RUSH ROCKS THE'
	DC.B	" USA...       WAITING FOR THE WINDS OF CHANGE TO SWEEP THE CLOUDS "
	DC.B	"A WAY.  WAITING FOR THE RAINDOW'S END TO CAST ITS GOLD YOUR WAY"
	DC.B	",  COUNTLESS THE WAYS YOU PASS YOUR DAYS, WAITING FOR SOMEONE TO "
	DC.B	"COME AND TURN YOUR WORLD AROUND,  LOOKING FOR AN ANSWER FOR THE"
	DC.B	" QUESTION YOU HAVE FOUND,  LOOKING FOR AN OPEN DOOR!   YOU DON'T"
	DC.B	" GET SOMETHING FOR NOTHING.  YOU CAN'T HAVE FREEDOM FOR FREE,  "
	DC.B	"YOU WON'T GET WISE WITH THE SLEEP STILL IN YOUR EYES, NO MATTER "
	DC.B	"WHAT YOUR DREAM MIGHT BE!     RUSH #1      FLYERS #1      OILERS #0"
	DC.B	"      UCF #0              J.J. LEARN ANYTHING FROM LEADER BOARD YET?"
	DC.B	"                   ",0

ESIcycle:
	dc.b	$0,$0,$0,$0,$4,$4,$4,$4,$8,$8,$8,$8,$c,$c,$c,$c
	dc.b	$8,$8,$8,$8,$4,$4,$4,$4,$0,$0,$0,$0,$0,$0,$0,$0
	dc.b	$0,$0,$0,$0,$4,$4,$4,$4,$8,$8,$8,$8,$c,$c,$c,$c
	dc.b	$8,$8,$8,$8,$4,$4,$4,$4,$0,$0,$0,$0,$0,$0,$0,$0

	;dc.b	$0,$0,$0,$4,$4,$4,$8,$8,$8,$c,$c,$c,$8,$8,$8,$4,$4,$4
	;dc.b	$0,$0,$0,$4,$4,$4,$8,$8,$8,$c,$c,$c,$8,$8,$8,$4,$4,$4

scrollchar:

;============================================================================
;= Cyber Font-Editor V1.4  Rel. by Frantic (c) 1991-1992 Sanity Productions =
;============================================================================
	dc.b	$00,$00,$00,$00,$00,$00,$00,$00	;' '
	dc.b	$0c,$3e,$36,$66,$7e,$c6,$c6,$00	;'!'
	dc.b	$fc,$fe,$06,$fc,$c6,$fe,$fc,$00	;'"'
	dc.b	$7c,$fe,$c6,$c0,$c6,$fe,$7c,$00	;'#'
	dc.b	$fc,$fe,$06,$c6,$c6,$fe,$fc,$00	;'$'
	dc.b	$7e,$fe,$c0,$fe,$c0,$fe,$7e,$00	;'%'
	dc.b	$fe,$fe,$00,$fc,$c0,$c0,$c0,$00	;'&'
	dc.b	$7c,$fe,$c0,$ce,$c6,$fe,$7c,$00	;'''
	dc.b	$c6,$c6,$c6,$f6,$c6,$c6,$c6,$00	;'('
	dc.b	$7e,$7e,$18,$18,$18,$7e,$7e,$00	;')'
	dc.b	$7e,$7e,$0c,$cc,$cc,$fc,$78,$00	;'*'
	dc.b	$c6,$cc,$d8,$f0,$d8,$cc,$c6,$00	;'+'
	dc.b	$c0,$c0,$c0,$c0,$c0,$fe,$7e,$00	;','
	dc.b	$c6,$ee,$fe,$fe,$d6,$c6,$c6,$00	;'-'
	dc.b	$cc,$ec,$fc,$fc,$dc,$cc,$cc,$00	;'.'
	dc.b	$7c,$fe,$c6,$c6,$c6,$fe,$7c,$00	;'/'
	dc.b	$fc,$fe,$06,$fc,$c0,$c0,$c0,$00	;'0'
	dc.b	$7c,$fe,$c6,$c6,$c6,$fe,$7b,$00	;'1'
	dc.b	$f8,$fe,$06,$fc,$c6,$c6,$c6,$00	;'2'
	dc.b	$7e,$fe,$c0,$7c,$06,$fe,$fc,$00	;'3'
	dc.b	$f8,$fc,$0c,$0c,$0c,$0c,$0c,$00	;'4'
	dc.b	$c6,$c6,$c6,$c6,$c6,$fe,$7c,$00	;'5'
	dc.b	$c6,$c6,$c6,$c6,$ee,$7c,$38,$00	;'6'
	dc.b	$c6,$c6,$d6,$fe,$fe,$ee,$c6,$00	;'7'
	dc.b	$c6,$ee,$7c,$38,$7c,$ee,$c6,$00	;'8'
	dc.b	$66,$66,$66,$3c,$18,$18,$18,$00	;'9'
	dc.b	$fe,$fe,$1c,$38,$70,$fe,$fe,$00	;':'
	dc.b	$00,$00,$00,$00,$00,$00,$00,$00	;';'
	dc.b	$00,$00,$00,$00,$00,$00,$00,$00	;'<'
	dc.b	$00,$00,$00,$00,$00,$00,$00,$00	;'='
	dc.b	$00,$00,$00,$00,$00,$00,$00,$00	;'>'
	dc.b	$00,$00,$00,$00,$00,$00,$00,$00	;'?'
	dc.b	$00,$00,$00,$00,$00,$00,$00,$00	;'@'
	dc.b	$18,$18,$18,$18,$00,$18,$18,$00	;'A'
	dc.b	$66,$66,$66,$00,$00,$00,$00,$00	;'B'
	dc.b	$6c,$fe,$6c,$6c,$6c,$fe,$6c,$00	;'C'
	dc.b	$10,$7e,$d0,$7c,$16,$fc,$10,$00	;'D'
	dc.b	$00,$00,$00,$00,$00,$00,$00,$00	;'E'
	dc.b	$78,$cc,$78,$70,$de,$cc,$7e,$00	;'F'	
	dc.b	$18,$18,$18,$00,$00,$00,$00,$00	;'G'
	dc.b	$18,$30,$60,$60,$60,$30,$18,$00	;'H'
	dc.b	$30,$18,$0c,$0c,$0c,$18,$30,$00	;'I'
	dc.b	$00,$54,$38,$7c,$38,$54,$00,$00	;'J'
	dc.b	$00,$18,$18,$7e,$7e,$18,$18,$00	;'K'
	dc.b	$00,$00,$00,$00,$00,$18,$18,$30	;'L'
	dc.b	$00,$00,$00,$7e,$00,$00,$00,$00	;'M'
	dc.b	$00,$00,$00,$00,$00,$18,$18,$00	;'N'
	dc.b	$00,$03,$06,$0c,$18,$30,$60,$00	;'O'
	dc.b	$7c,$fe,$ce,$d6,$e6,$fe,$7c,$00	;'P'
	dc.b	$30,$70,$30,$30,$30,$fc,$fc,$00	;'Q'
	dc.b	$fc,$fe,$0e,$3c,$f0,$fe,$fe,$00	;'R'
	dc.b	$fc,$fe,$06,$7c,$06,$fe,$fc,$00	;'S'
	dc.b	$c0,$c0,$cc,$cc,$fe,$fe,$0c,$00	;'T'
	dc.b	$fe,$fe,$c0,$fc,$0e,$fe,$fc,$00	;'U'
	dc.b	$7e,$fe,$c0,$fc,$c6,$fe,$7c,$00	;'V'
	dc.b	$fe,$fe,$0e,$1c,$38,$38,$38,$00	;'W'
	dc.b	$7c,$fe,$c6,$7c,$c6,$fe,$7c,$00	;'X'
	dc.b	$7c,$fe,$c6,$fe,$06,$fe,$7c,$00	;'Y'
	dc.b	$00,$30,$30,$00,$30,$30,$00,$00	;'Z'
	dc.b	$00,$18,$18,$00,$18,$18,$30,$00	;'['
	dc.b	$0e,$18,$30,$60,$30,$18,$0e,$00	;'\'
	dc.b	$00,$00,$7e,$00,$7e,$00,$00,$00	;']'
	dc.b	$70,$18,$0c,$06,$0c,$18,$70,$00	;'^'
	dc.b	$3c,$66,$06,$0c,$18,$00,$18,$00	;'_'




	.pad


ESICOL:             
	.bin esi.col
                    
ESIPIC:            
        .bin esi.dat
	.pad



;===========================================================================
;                           Start Of DYXBP dot Scroll
;===========================================================================

dscroll:

	jsl	>Snes_Init

	phk
	plb

	rep	#$10
	sep	#$20
	lda	#$80
	sta	$2100
	ldx	#$0000
	stx	$2116
	ldx	#$0000
	lda	#$00
cleardsvram:
	stz	$2118
	stz	$2119
	inx
	cpx	#$4000
	bne	cleardsvram

	ldx	#$7400
	stx	$2116
	ldx	#$0000
cleardtram:
	stz	$2118
	lda	#$01
	sta	$2119
	inx
	cpx	#$0400
	bne	cleardtram

	ldx	#$7800
	stx	$2116
	ldx	#$0000
cleardtram2:
	stz	$2118
	lda	#$01
	sta	$2119
	inx
	cpx	#$0400
	bne	cleardtram2


	ldx	#$74c1
	stx	$2116

	ldx	#$0000
copydotscreen:
	lda	!dscreen,x
	sta	$2118
	lda	!dscreen2,x
	sta	$2119
	inx
	cpx	#$0200
	bne	copydotscreen

	ldx	#$78c1
	stx	$2116
	ldx	#$0000
copydotscreen2:
	lda	!dscreen,x
	sta	$2118
	lda	!dscreen2,x
	sta	$2119
	inx
	cpx	#$0200
	bne	copydotscreen2

	ldx	#$4000
	stx	$2116
	ldx	#$0000
copybbsgfx:
	lda	!bbsgfx,x
	sta	$2118
	inx
	lda	!bbsgfx,x
	sta	$2119
	inx
	cpx	#2080
	bne	copybbsgfx

	ldx	#$5000
	stx	$2116
	ldx	#$0000
copybbstiles:
	lda	!bbstiles,x
	sta	$2118
	inx
	lda	!bbstiles,x
	sta	$2119
	inx
	cpx	#2048
	bne	copybbstiles



	ldx	#$0200
zerogfxram:
	stz	$0000,x
	inx
	cpx	#$0a90
	bne	zerogfxram





	stz	$2121
	ldx	#$0000
copydscrollcol:
	lda	!dscrcol,x
	sta	$2122
	inx
	cpx	#$0100
	bne	copydscrollcol



	Lda	#$00		; mode 0, 8/8 dot
	Sta	$2105	

	lda	#$50		; plane 3 tile address $5000
	Sta	$2109
	lda	#$74
	sta	$2108		; plane 2 tile address $7400
	lda	#$78
	sta	$2107		; plane 1 tile address $7800
	lda	#$00
	sta	$210b		; plane 1&2 graphics data $0000
	lda	#$04
	sta	$210c		; plane 3 graphics data $4000
	lda	#$01
	sta	$210d		; shift first image of scroll right
	stz	$210d
	sta	$210e		; shift first image of scroll up
	stz	$210e
	lda	#$07		;  Plane 1,2,3 Enabled
	sta	$212c





	
	ldx	#$0000
	stx	dsinepos		; reste sine position



	ldx	#$0000
	stx	scrollend		; end scroll flag

	ldx	#$0000
	stx	bitoffset
	stx	xsinestore
	stx	xsine


	ldx	#$0100
	stx	dsinexpos		; reset sine pos for X pos




	ldx	#$0000
	stx	scrollcharoffset

	ldx	#$0000
	stx	scrollbitoffset


	lda	#$01
	sta	$4200


	lda	#$0f
	sta	$2100
	
	ldx	#$002a
looptonotskip:
	jsr	!DWaitVb
	dex
	bne	looptonotskip


;===========================================================================
;                            Start of DYXCP scroll
;===========================================================================



waitthis:
	jsr	!DWaitVb

	jsr	!MoveSVD
	jsr	!dotscrsine
	jsr	!movebscd

Dotjoypad:
	lda	$4212		; test if it's ok to read pad
	and	#$01
	bne	Dotjoypad	; nope, go back!


	lda	$4218		; read Controller 1
	ora	$4219
	ora	scrollend		; check if scroll is ended
	bit	#$c0
	beq	waitthis

	jsr	!DWaitVb
	lda	#$80
	sta	$2100
	rtl

MoveSVD:

	;rep	#$10	; x,y = 16 bit
	;sep	#$20	; a = 8 bit
			; start of General DMA graphics copy routine!
	lda	#$00
	sta	$4330		; 0= 1 byte per register (not a word!)
	lda	#$18
	sta	$4331		; 21xx   this is 2118 (VRAM)
	lda	#$00
	sta	$4332
	lda	#$02		; address = $7e0200
	sta	$4333
	lda	#$7e
	sta	$4334		; bank address of data in ram
	ldx	#$0800
	stx	$4335		; # of bytes to be transferred
	lda	#$00
	sta	$2115		; increase V-Ram address after writing to
				; $2118
	ldx	#$0000
	stx	$2116		; address of VRAM to copy garphics in
	lda	#$08		; turn on bit 4 (%1000=8) of G-DMA channel
	sta	$420b
	lda	#$80		; increase V-Ram address after writing to
	sta	$2115		; $2119
	rts


;==========================================================================
;                    Plot positions for each char's pixel
;==========================================================================



dotscrsine:
	rep	#$30
shootd:
	jsr	!cleardsinebuffer	; clear gfx buffer

	ldx	#$0000		; column #
	stx	column
	stx	ysine		; reset column, y&xsine counters
	stx	xsine

	lda	dsinepos
	clc
	adc	#$03		; y speed and direction!
	and	#$01ff
	sta	dsinepos
	sta	ysine		; store this value


	lda	dsinexpos
	clc
	adc	#$01fe
	and	#$01ff		; x speed and direction
	sta	dsinexpos
	sta	xsine		; store this value

	ldx	#$0000		; scroll char gfx offset
	stx	scrollgfxoffset
	

	ldx	#$0008
	stx	bitcounter		; reset the counter




	ldx	ysine
	rep	#$30
	lda	!DSCROLLSINE,x	; read sine data
	and	#$00ff		; get only 1 byte	y position
	sta	ysinestore	; store it

	ldx	xsine
	lda	!DSCROLLSINEX,x	; get X position
	and	#$0007
	sta	xsinestore

	lda	!DSCROLLSINEX,x
	and	#%11111000	; highest 5 bit and multiply by 16
	asl a
	asl a
	asl a			; *16
	asl a
	;clc
	adc	ysinestore
	sta	ysinestore

	sep	#$20

	ldy	#$0000
	sty	bitoffset		; clear bitoffset for scrollchar

beforesined:
	ldy	scrollgfxoffset		; current scrollgfx offset
scrollersined:



	ldx	bitoffset		 ;current bit offset (0-7)
	lda	$0a00,y
	and	!BITON,x		; get bit position value
	beq	overbitd		; in case of 0, don't draw pixel
	ldx	ysinestore	
	lda	$0200,x		; draw bit on the screen
	ldx	xsinestore
	ora	!BITON,x	; get bit # to put on screen
	ldx	ysinestore

	sta	$0200,x
overbitd:
	iny			; get next char
	ldx	ysinestore
	inx
	inx
	stx	ysinestore	; increase the sine data (to reach next line)
				; character counter
	dec	bitcounter
	;lda	bitcounter
	bne	scrollersined
	lda	#$08
	sta	bitcounter		; reset the counter

	jsr	!incds
	ldy	scrollgfxoffset	; get current scroll char location

				; increase bit offset
	inc	bitoffset
	lda	bitoffset
	cmp	#$08		; increase scroll bit offset
	bne	scrollersined

	stz	bitoffset		; yes; reset bit offset
	lda	#$08
	sta	bitcounter		; reset char counter offset

	rep	#$30
	lda	scrollgfxoffset
	clc
	adc	#$0008		; add 8 to char buffer offset
	sta	scrollgfxoffset

	sep	#$20
	inc	column		; increase # of columns
	jsr	!incds

	lda	column
	cmp	#$0e		; 
	bne	beforesined

	rts




incds:
	rep	#$30
	lda	xsine
	inc a
	inc a			; increase X angle
	inc a
	and	#$01ff
	sta	xsine

	lda	ysine
	inc a			; increase Y angle
	inc a
	and	#$01ff
	sta	ysine

	ldx	ysine
	rep	#$30
	lda	!DSCROLLSINE,x	; read sine data
	and	#$00ff		; get only 1 byte	y position
	sta	ysinestore		; store it
	ldx	xsine
	lda	!DSCROLLSINEX,x	; get X position
	and	#$0007
	sta	xsinestore
	lda	!DSCROLLSINEX,x
	and	#%11111000
	asl a
	asl a
	asl a
	asl a
	;clc
	adc	ysinestore
	sta	ysinestore
	sep	#$20
	rts
	


movebscd:

	asl	$0a80
	rol	$0a78
	rol	$0a70
	rol	$0a68
	rol	$0a60
	rol	$0a58
	rol	$0a50
	rol	$0a48
	rol	$0a40
	rol	$0a38
	rol	$0a30
	rol	$0a28
	rol	$0a20
	rol	$0a18
	rol	$0a10
	rol	$0a08
	rol	$0a00

	asl	$0a81
	rol	$0a79
	rol	$0a71
	rol	$0a69
	rol	$0a61
	rol	$0a59
	rol	$0a51
	rol	$0a49
	rol	$0a41
	rol	$0a39
	rol	$0a31
	rol	$0a29
	rol	$0a21
	rol	$0a19
	rol	$0a11
	rol	$0a09
	rol	$0a01

	asl	$0a82
	rol	$0a7a
	rol	$0a72
	rol	$0a6a
	rol	$0a62
	rol	$0a5a
	rol	$0a52
	rol	$0a4a
	rol	$0a42
	rol	$0a3a
	rol	$0a32
	rol	$0a2a
	rol	$0a22
	rol	$0a1a
	rol	$0a12
	rol	$0a0a
	rol	$0a02

	asl	$0a83
	rol	$0a7b
	rol	$0a73
	rol	$0a6b
	rol	$0a63
	rol	$0a5b
	rol	$0a53
	rol	$0a4b
	rol	$0a43
	rol	$0a3b
	rol	$0a33
	rol	$0a2b
	rol	$0a23
	rol	$0a1b
	rol	$0a13
	rol	$0a0b
	rol	$0a03

	asl	$0a84
	rol	$0a7c
	rol	$0a74
	rol	$0a6c
	rol	$0a64
	rol	$0a5c
	rol	$0a54
	rol	$0a4c
	rol	$0a44
	rol	$0a3c
	rol	$0a34
	rol	$0a2c
	rol	$0a24
	rol	$0a1c
	rol	$0a14
	rol	$0a0c
	rol	$0a04

	asl	$0a85
	rol	$0a7d
	rol	$0a75
	rol	$0a6d
	rol	$0a65
	rol	$0a5d
	rol	$0a55
	rol	$0a4d
	rol	$0a45
	rol	$0a3d
	rol	$0a35
	rol	$0a2d
	rol	$0a25
	rol	$0a1d
	rol	$0a15
	rol	$0a0d
	rol	$0a05

	asl	$0a86
	rol	$0a7e
	rol	$0a76
	rol	$0a6e
	rol	$0a66
	rol	$0a5e
	rol	$0a56
	rol	$0a4e
	rol	$0a46
	rol	$0a3e
	rol	$0a36
	rol	$0a2e
	rol	$0a26
	rol	$0a1e
	rol	$0a16
	rol	$0a0e
	rol	$0a06

	asl	$0a87
	rol	$0a7f
	rol	$0a77
	rol	$0a6f
	rol	$0a67
	rol	$0a5f
	rol	$0a57
	rol	$0a4f
	rol	$0a47
	rol	$0a3f
	rol	$0a37
	rol	$0a2f
	rol	$0a27
	rol	$0a1f
	rol	$0a17
	rol	$0a0f
	rol	$0a07



	lda	scrollbitoffset
	inc a
	and	#$07
	sta	scrollbitoffset
	beq	Getchard
	rts
Getchard:
	rep	#$30
	ldx	scrollcharoffset
	lda	!dscrolltxt,x
	beq	resetbscrposd
	and	#$003f
	asl a
	asl a
	asl a
	tax
	sep	#$20
	ldy	#$0000
copybscrdatad:
	lda	!Dscrollchar,x
	sta	$0a80,y
	inx
	iny
	cpy	#$08
	bne	copybscrdatad
	ldx	scrollcharoffset
	inx
	stx	scrollcharoffset
	rts
resetbscrposd:
	rep	#$30
	lda	#$00c0
	sta	scrollend
	ldx	#$0000
	stx	scrollcharoffset
	jmp	!Getchard


;==========================================================================
;                        Vertical Blank Wait Routine
;==========================================================================
DWaitVb:	
	lda	$4210
	bpl     DWaitVb	; is the number higher than #$7f? (#$80-$ff)
			; bpl tests bit #7 ($80) if this bit is set it means
			; the byte is negative (BMI, Branch on Minus)
			; BPL (Branch on Plus) if bit #7 is set in $4210
			; it means that it is at the start of V-Blank
			; if not it will keep testing $4210 until bit #7
			; is on (which would make it a negative (BMI)
DWaitVb2:
	lda	$4210
	bmi	DWaitVb2
	rts


Dscrollchar:

;============================================================================
;= Cyber Font-Editor V1.4  Rel. by Frantic (c) 1991-1992 Sanity Productions =
;============================================================================
	dc.b	$3c,$66,$6e,$6e,$60,$62,$3c,$00	;' '
	dc.b	$18,$3c,$66,$7e,$66,$66,$66,$00	;'!'
	dc.b	$7c,$66,$66,$7c,$66,$66,$7c,$00	;'"'
	dc.b	$3c,$66,$60,$60,$60,$66,$3c,$00	;'#'
	dc.b	$78,$6c,$66,$66,$66,$6c,$78,$00	;'$'
	dc.b	$7e,$60,$60,$78,$60,$60,$7e,$00	;'%'
	dc.b	$7e,$60,$60,$78,$60,$60,$60,$00	;'&'
	dc.b	$3c,$66,$60,$6e,$66,$66,$3c,$00	;'''
	dc.b	$66,$66,$66,$7e,$66,$66,$66,$00	;'('
	dc.b	$3c,$18,$18,$18,$18,$18,$3c,$00	;')'
	dc.b	$1e,$0c,$0c,$0c,$0c,$6c,$38,$00	;'*'
	dc.b	$66,$6c,$78,$70,$78,$6c,$66,$00	;'+'
	dc.b	$60,$60,$60,$60,$60,$60,$7e,$00	;','
	dc.b	$63,$77,$7f,$6b,$63,$63,$63,$00	;'-'
	dc.b	$66,$76,$7e,$7e,$6e,$66,$66,$00	;'.'
	dc.b	$3c,$66,$66,$66,$66,$66,$3c,$00	;'/'
	dc.b	$7c,$66,$66,$7c,$60,$60,$60,$00	;'0'
	dc.b	$3c,$66,$66,$66,$66,$3c,$0e,$00	;'1'
	dc.b	$7c,$66,$66,$7c,$78,$6c,$66,$00	;'2'
	dc.b	$3c,$66,$60,$3c,$06,$66,$3c,$00	;'3'
	dc.b	$7e,$18,$18,$18,$18,$18,$18,$00	;'4'
	dc.b	$66,$66,$66,$66,$66,$66,$3c,$00	;'5'
	dc.b	$66,$66,$66,$66,$66,$3c,$18,$00	;'6'
	dc.b	$63,$63,$63,$6b,$7f,$77,$63,$00	;'7'
	dc.b	$66,$66,$3c,$18,$3c,$66,$66,$00	;'8'
	dc.b	$66,$66,$66,$3c,$18,$18,$18,$00	;'9'
	dc.b	$7e,$06,$0c,$18,$30,$60,$7e,$00	;':'
	dc.b	$3c,$30,$30,$30,$30,$30,$3c,$00	;';'
	dc.b	$00,$60,$30,$18,$0c,$06,$03,$00	;'<'
	dc.b	$3c,$0c,$0c,$0c,$0c,$0c,$3c,$00	;'='
	dc.b	$10,$38,$6c,$c6,$00,$00,$00,$00	;'>'
	dc.b	$00,$00,$00,$00,$00,$00,$00,$7e	;'?'
	dc.b	$00,$00,$00,$00,$00,$00,$00,$00	;'@'
	dc.b	$18,$18,$18,$18,$00,$00,$18,$00	;'A'
	dc.b	$66,$66,$66,$00,$00,$00,$00,$00	;'B'
	dc.b	$66,$66,$ff,$66,$ff,$66,$66,$00	;'C'
	dc.b	$18,$3e,$60,$3c,$06,$7c,$18,$00	;'D'
	dc.b	$62,$66,$0c,$18,$30,$66,$46,$00	;'E'
	dc.b	$3c,$66,$3c,$38,$67,$66,$3f,$00	;'F'
	dc.b	$06,$0c,$18,$00,$00,$00,$00,$00	;'G'
	dc.b	$0c,$18,$30,$30,$30,$18,$0c,$00	;'H'
	dc.b	$30,$18,$0c,$0c,$0c,$18,$30,$00	;'I'
	dc.b	$00,$66,$3c,$ff,$3c,$66,$00,$00	;'J'
	dc.b	$00,$18,$18,$7e,$18,$18,$00,$00	;'K'
	dc.b	$00,$00,$00,$00,$00,$18,$18,$30	;'L'
	dc.b	$00,$00,$00,$7e,$00,$00,$00,$00	;'M'
	dc.b	$00,$00,$00,$00,$00,$18,$18,$00	;'N'
	dc.b	$00,$03,$06,$0c,$18,$30,$60,$00	;'O'
	dc.b	$3c,$66,$6e,$76,$66,$66,$3c,$00	;'P'
	dc.b	$18,$18,$38,$18,$18,$18,$7e,$00	;'Q'
	dc.b	$3c,$66,$06,$0c,$30,$60,$7e,$00	;'R'
	dc.b	$3c,$66,$06,$1c,$06,$66,$3c,$00	;'S'
	dc.b	$06,$0e,$1e,$66,$7f,$06,$06,$00	;'T'
	dc.b	$7e,$60,$7c,$06,$06,$66,$3c,$00	;'U'
	dc.b	$3c,$66,$60,$7c,$66,$66,$3c,$00	;'V'
	dc.b	$7e,$66,$0c,$18,$18,$18,$18,$00	;'W'
	dc.b	$3c,$66,$66,$3c,$66,$66,$3c,$00	;'X'
	dc.b	$3c,$66,$66,$3e,$06,$66,$3c,$00	;'Y'
	dc.b	$00,$00,$18,$00,$00,$18,$00,$00	;'Z'
	dc.b	$00,$00,$18,$00,$00,$18,$18,$30	;'['
	dc.b	$0e,$18,$30,$60,$30,$18,$0e,$00	;'\'
	dc.b	$00,$00,$7e,$00,$7e,$00,$00,$00	;']'
	dc.b	$70,$18,$0c,$06,$0c,$18,$70,$00	;'^'
	dc.b	$3c,$66,$06,$0c,$18,$00,$18,$00	;'_'


dscrolltxt:
	;	different y-x bit position scroll
	dc.b	" ! D-Y-X-B-P !   YET ANOTHER ROUTINE NEVER SEEN ON THIS "
	DC.B	"MACHINE! THIS CODE IS OLD, BUT I NEVER USED IT.. SO HERE IT "
	DC.B	"IS FOR YOU TO PLAY WITH! WHY DOES IT SEEM LIKE I'M THE "
	DC.B	"ONLY GUY GIVING OUT SOURCE CODES? THERE'RE SO MANY CHEAPOS OUT "
	DC.B	"THERE THAT WOULDN'T EVEN GIVE OUT THEIR DIRTY UNDERWEAR!  "
	DC.B	"UNBELIEVABLE.... LET'S JUST GO TO THE NEXT PART....   "
	DC.B	"                   ",0,0

BITON:
	dc.b	$80,$40,$20,$10,$8,$4,$2,$1



DSCROLLSINE:


 dc.b  56,57,57,58,59,59,60,61,61,62,63,64,64,65,66,66,67,68,68,69
 dc.b  70,70,71,72,72,73,74,74,75,76,76,77,77,78,79,79,80,81,81,82
 dc.b  82,83,84,84,85,85,86,87,87,88,88,89,89,90,90,91,92,92,93,93
 dc.b  94,94,95,95,96,96,97,97,97,98,98,99,99,100,100,101,101,101
 dc.b  102,102,103,103,103,104,104,104,105,105,105,106,106,106,107
 dc.b  107,107,107,108,108,108,108,109,109,109,109,110,110,110,110
 dc.b  110,110,111,111,111,111,111,111,111,111,112,112,112,112,112
 dc.b  112,112,112,112,112,112,112,112,112,112,112,112,112,112,112
 dc.b  112,111,111,111,111,111,111,111,111,110,110,110,110,110,110
 dc.b  109,109,109,109,108,108,108,108,107,107,107,107,106,106,106
 dc.b  105,105,105,104,104,104,103,103,103,102,102,101,101,101,100
 dc.b  100,99,99,98,98,97,97,97,96,96,95,95,94,94,93,93,92,92,91,90
 dc.b  90,89,89,88,88,87,87,86,85,85,84,84,83,82,82,81,81,80,79,79
 dc.b  78,77,77,76,76,75,74,74,73,72,72,71,70,70,69,68,68,67,66,66
 dc.b  65,64,64,63,62,61,61,60,59,59,58,57,57,56,55,55,54,53,53,52
 dc.b  51,51,50,49,48,48,47,46,46,45,44,44,43,42,42,41,40,40,39,38
 dc.b  38,37,36,36,35,35,34,33,33,32,31,31,30,30,29,28,28,27,27,26
 dc.b  25,25,24,24,23,23,22,22,21,20,20,19,19,18,18,17,17,16,16,15
 dc.b  15,15,14,14,13,13,12,12,11,11,11,10,10,9,9,9,8,8,8,7,7,7,6
 dc.b  6,6,5,5,5,5,4,4,4,4,3,3,3,3,2,2,2,2,2,2,1,1,1,1,1,1,1,1,0,0
 dc.b  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2
 dc.b  2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,7,7,7,8,8,8,9,9,9,10,10
 dc.b  11,11,11,12,12,13,13,14,14,15,15,15,16,16,17,17,18,18,19,19
 dc.b  20,20,21,22,22,23,23,24,24,25,25,26,27,27,28,28,29,30,30,31
 dc.b  31,32,33,33,34,35,35,36,36,37,38,38,39,40,40,41,42,42,43,44
 dc.b  44,45,46,46,47,48,48,49,50,51,51,52,53,53,54,55


 dc.b  56,57,57,58,59,59,60,61,61,62,63,64,64,65,66,66,67,68,68,69
 dc.b  70,70,71,72,72,73,74,74,75,76,76,77,77,78,79,79,80,81,81,82
 dc.b  82,83,84,84,85,85,86,87,87,88,88,89,89,90,90,91,92,92,93,93
 dc.b  94,94,95,95,96,96,97,97,97,98,98,99,99,100,100,101,101,101
 dc.b  102,102,103,103,103,104,104,104,105,105,105,106,106,106,107
 dc.b  107,107,107,108,108,108,108,109,109,109,109,110,110,110,110
 dc.b  110,110,111,111,111,111,111,111,111,111,112,112,112,112,112
 dc.b  112,112,112,112,112,112,112,112,112,112,112,112,112,112,112
 dc.b  112,111,111,111,111,111,111,111,111,110,110,110,110,110,110
 dc.b  109,109,109,109,108,108,108,108,107,107,107,107,106,106,106
 dc.b  105,105,105,104,104,104,103,103,103,102,102,101,101,101,100
 dc.b  100,99,99,98,98,97,97,97,96,96,95,95,94,94,93,93,92,92,91,90
 dc.b  90,89,89,88,88,87,87,86,85,85,84,84,83,82,82,81,81,80,79,79
 dc.b  78,77,77,76,76,75,74,74,73,72,72,71,70,70,69,68,68,67,66,66
 dc.b  65,64,64,63,62,61,61,60,59,59,58,57,57,56,55,55,54,53,53,52
 dc.b  51,51,50,49,48,48,47,46,46,45,44,44,43,42,42,41,40,40,39,38
 dc.b  38,37,36,36,35,35,34,33,33,32,31,31,30,30,29,28,28,27,27,26
 dc.b  25,25,24,24,23,23,22,22,21,20,20,19,19,18,18,17,17,16,16,15
 dc.b  15,15,14,14,13,13,12,12,11,11,11,10,10,9,9,9,8,8,8,7,7,7,6
 dc.b  6,6,5,5,5,5,4,4,4,4,3,3,3,3,2,2,2,2,2,2,1,1,1,1,1,1,1,1,0,0
 dc.b  0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2
 dc.b  2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,7,7,7,8,8,8,9,9,9,10,10
 dc.b  11,11,11,12,12,13,13,14,14,15,15,15,16,16,17,17,18,18,19,19
 dc.b  20,20,21,22,22,23,23,24,24,25,25,26,27,27,28,28,29,30,30,31
 dc.b  31,32,33,33,34,35,35,36,36,37,38,38,39,40,40,41,42,42,43,44
 dc.b  44,45,46,46,47,48,48,49,50,51,51,52,53,53,54,55



DSCROLLSINEX:



 dc.b  60,61,61,62,63,64,64,65,66,67,67,68,69,70,70,71,72,72,73,74
 dc.b  75,75,76,77,77,78,79,80,80,81,82,82,83,84,84,85,86,86,87,88
 dc.b  88,89,90,90,91,91,92,93,93,94,95,95,96,96,97,97,98,99,99,100
 dc.b  100,101,101,102,102,103,103,104,104,105,105,106,106,107,107
 dc.b  108,108,109,109,109,110,110,111,111,111,112,112,113,113,113
 dc.b  114,114,114,115,115,115,115,116,116,116,116,117,117,117,117
 dc.b  118,118,118,118,118,119,119,119,119,119,119,119,119,120,120
 dc.b  120,120,120,120,120,120,120,120,120,120,120,120,120,120,120
 dc.b  120,120,120,120,119,119,119,119,119,119,119,119,118,118,118
 dc.b  118,118,117,117,117,117,116,116,116,116,115,115,115,115,114
 dc.b  114,114,113,113,113,112,112,111,111,111,110,110,109,109,109
 dc.b  108,108,107,107,106,106,105,105,104,104,103,103,102,102,101
 dc.b  101,100,100,99,99,98,97,97,96,96,95,95,94,93,93,92,91,91,90
 dc.b  90,89,88,88,87,86,86,85,84,84,83,82,82,81,80,80,79,78,77,77
 dc.b  76,75,75,74,73,72,72,71,70,70,69,68,67,67,66,65,64,64,63,62
 dc.b  61,61,60,59,59,58,57,56,56,55,54,53,53,52,51,50,50,49,48,48
 dc.b  47,46,45,45,44,43,43,42,41,40,40,39,38,38,37,36,36,35,34,34
 dc.b  33,32,32,31,30,30,29,29,28,27,27,26,25,25,24,24,23,23,22,21
 dc.b  21,20,20,19,19,18,18,17,17,16,16,15,15,14,14,13,13,12,12,11
 dc.b  11,11,10,10,9,9,9,8,8,7,7,7,6,6,6,5,5,5,5,4,4,4,4,3,3,3,3,2
 dc.b  2,2,2,2,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
 dc.b  0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6
 dc.b  6,7,7,7,8,8,9,9,9,10,10,11,11,11,12,12,13,13,14,14,15,15,16
 dc.b  16,17,17,18,18,19,19,20,20,21,21,22,23,23,24,24,25,25,26,27
 dc.b  27,28,29,29,30,30,31,32,32,33,34,34,35,36,36,37,38,38,39,40
 dc.b  40,41,42,43,43,44,45,45,46,47,48,48,49,50,50,51,52,53,53,54
 dc.b  55,56,56,57,58,59


 dc.b  60,61,61,62,63,64,64,65,66,67,67,68,69,70,70,71,72,72,73,74
 dc.b  75,75,76,77,77,78,79,80,80,81,82,82,83,84,84,85,86,86,87,88
 dc.b  88,89,90,90,91,91,92,93,93,94,95,95,96,96,97,97,98,99,99,100
 dc.b  100,101,101,102,102,103,103,104,104,105,105,106,106,107,107
 dc.b  108,108,109,109,109,110,110,111,111,111,112,112,113,113,113
 dc.b  114,114,114,115,115,115,115,116,116,116,116,117,117,117,117
 dc.b  118,118,118,118,118,119,119,119,119,119,119,119,119,120,120
 dc.b  120,120,120,120,120,120,120,120,120,120,120,120,120,120,120
 dc.b  120,120,120,120,119,119,119,119,119,119,119,119,118,118,118
 dc.b  118,118,117,117,117,117,116,116,116,116,115,115,115,115,114
 dc.b  114,114,113,113,113,112,112,111,111,111,110,110,109,109,109
 dc.b  108,108,107,107,106,106,105,105,104,104,103,103,102,102,101
 dc.b  101,100,100,99,99,98,97,97,96,96,95,95,94,93,93,92,91,91,90
 dc.b  90,89,88,88,87,86,86,85,84,84,83,82,82,81,80,80,79,78,77,77
 dc.b  76,75,75,74,73,72,72,71,70,70,69,68,67,67,66,65,64,64,63,62
 dc.b  61,61,60,59,59,58,57,56,56,55,54,53,53,52,51,50,50,49,48,48
 dc.b  47,46,45,45,44,43,43,42,41,40,40,39,38,38,37,36,36,35,34,34
 dc.b  33,32,32,31,30,30,29,29,28,27,27,26,25,25,24,24,23,23,22,21
 dc.b  21,20,20,19,19,18,18,17,17,16,16,15,15,14,14,13,13,12,12,11
 dc.b  11,11,10,10,9,9,9,8,8,7,7,7,6,6,6,5,5,5,5,4,4,4,4,3,3,3,3,2
 dc.b  2,2,2,2,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
 dc.b  0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6
 dc.b  6,7,7,7,8,8,9,9,9,10,10,11,11,11,12,12,13,13,14,14,15,15,16
 dc.b  16,17,17,18,18,19,19,20,20,21,21,22,23,23,24,24,25,25,26,27
 dc.b  27,28,29,29,30,30,31,32,32,33,34,34,35,36,36,37,38,38,39,40
 dc.b  40,41,42,43,43,44,45,45,46,47,48,48,49,50,50,51,52,53,53,54
 dc.b  55,56,56,57,58,59

dscreen:
	dc.b	0,$0,$0,$0,$0,$0,$0,$0,$0,$10,$20,$30,$40,$50,$60,$70,$80,$90,$a0,$b0,$c0,$d0,$e0,$f0,$0,$0,$0,$0,$0,$0,$0,$0
	dc.b	0,$0,$0,$0,$0,$0,$0,$0,$1,$11,$21,$31,$41,$51,$61,$71,$81,$91,$a1,$b1,$c1,$d1,$e1,$f1,$0,$0,$0,$0,$0,$0,$0,$0
	dc.b	0,$0,$0,$0,$0,$0,$0,$0,$2,$12,$22,$32,$42,$52,$62,$72,$82,$92,$a2,$b2,$c2,$d2,$e2,$f2,$0,$0,$0,$0,$0,$0,$0,$0
	dc.b	0,$0,$0,$0,$0,$0,$0,$0,$3,$13,$23,$33,$43,$53,$63,$73,$83,$93,$a3,$b3,$c3,$d3,$e3,$f3,$0,$0,$0,$0,$0,$0,$0,$0
	dc.b	0,$0,$0,$0,$0,$0,$0,$0,$4,$14,$24,$34,$44,$54,$64,$74,$84,$94,$a4,$b4,$c4,$d4,$e4,$f4,$0,$0,$0,$0,$0,$0,$0,$0
	dc.b	0,$0,$0,$0,$0,$0,$0,$0,$5,$15,$25,$35,$45,$55,$65,$75,$85,$95,$a5,$b5,$c5,$d5,$e5,$f5,$0,$0,$0,$0,$0,$0,$0,$0
	dc.b	0,$0,$0,$0,$0,$0,$0,$0,$6,$16,$26,$36,$46,$56,$66,$76,$86,$96,$a6,$b6,$c6,$d6,$e6,$f6,$0,$0,$0,$0,$0,$0,$0,$0
	dc.b	0,$0,$0,$0,$0,$0,$0,$0,$7,$17,$27,$37,$47,$57,$67,$77,$87,$97,$a7,$b7,$c7,$d7,$e7,$f7,$0,$0,$0,$0,$0,$0,$0,$0
	dc.b	0,$0,$0,$0,$0,$0,$0,$0,$8,$18,$28,$38,$48,$58,$68,$78,$88,$98,$a8,$b8,$c8,$d8,$e8,$f8,$0,$0,$0,$0,$0,$0,$0,$0
	dc.b	0,$0,$0,$0,$0,$0,$0,$0,$9,$19,$29,$39,$49,$59,$69,$79,$89,$99,$a9,$b9,$c9,$d9,$e9,$f9,$0,$0,$0,$0,$0,$0,$0,$0
	dc.b	0,$0,$0,$0,$0,$0,$0,$0,$a,$1a,$2a,$3a,$4a,$5a,$6a,$7a,$8a,$9a,$aa,$ba,$ca,$da,$ea,$fa,$0,$0,$0,$0,$0,$0,$0,$0
	dc.b	0,$0,$0,$0,$0,$0,$0,$0,$b,$1b,$2b,$3b,$4b,$5b,$6b,$7b,$8b,$9b,$ab,$bb,$cb,$db,$eb,$fb,$0,$0,$0,$0,$0,$0,$0,$0
	dc.b	0,$0,$0,$0,$0,$0,$0,$0,$c,$1c,$2c,$3c,$4c,$5c,$6c,$7c,$8c,$9c,$ac,$bc,$cc,$dc,$ec,$fc,$0,$0,$0,$0,$0,$0,$0,$0
	dc.b	0,$0,$0,$0,$0,$0,$0,$0,$d,$1d,$2d,$3d,$4d,$5d,$6d,$7d,$8d,$9d,$ad,$bd,$cd,$dd,$ed,$fd,$0,$0,$0,$0,$0,$0,$0,$0
	dc.b	0,$0,$0,$0,$0,$0,$0,$0,$e,$1e,$2e,$3e,$4e,$5e,$6e,$7e,$8e,$9e,$ae,$be,$ce,$de,$ee,$fe,$0,$0,$0,$0,$0,$0,$0,$0
	dc.b	0,$0,$0,$0,$0,$0,$0,$0,$f,$1f,$2f,$3f,$4f,$5f,$6f,$7f,$8f,$9f,$af,$bf,$cf,$df,$ef,$ff,$0,$0,$0,$0,$0,$0,$0,$0


dscreen2:
	dc.b	1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
	dc.b	1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
	dc.b	1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
	dc.b	1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
	dc.b	1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
	dc.b	1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
	dc.b	1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
	dc.b	1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
	dc.b	1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
	dc.b	1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
	dc.b	1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
	dc.b	1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
	dc.b	1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
	dc.b	1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
	dc.b	1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
	dc.b	1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1

cleardsinebuffer:

	rep	#$30

	stz	$0200
	stz	$0202
	stz	$0204
	stz	$0206
	stz	$0208
	stz	$020a
	stz	$020c
	stz	$020e

	stz	$0210
	stz	$0212
	stz	$0214
	stz	$0216
	stz	$0218
	stz	$021a
	stz	$021c
	stz	$021e


	stz	$0220
	stz	$0222
	stz	$0224
	stz	$0226
	stz	$0228
	stz	$022a
	stz	$022c
	stz	$022e


	stz	$0230
	stz	$0232
	stz	$0234
	stz	$0236
	stz	$0238
	stz	$023a
	stz	$023c
	stz	$023e


	stz	$0240
	stz	$0242
	stz	$0244
	stz	$0246
	stz	$0248
	stz	$024a
	stz	$024c
	stz	$024e


	stz	$0250
	stz	$0252
	stz	$0254
	stz	$0256
	stz	$0258
	stz	$025a
	stz	$025c
	stz	$025e

	stz	$0260
	stz	$0262
	stz	$0264
	stz	$0266
	stz	$0268
	stz	$026a
	stz	$026c
	stz	$026e


	stz	$0270
	stz	$0272
	stz	$0274
	stz	$0276
	stz	$0278
	stz	$027a
	stz	$027c
	stz	$027e


	stz	$0280
	stz	$0282
	stz	$0284
	stz	$0286
	stz	$0288
	stz	$028a
	stz	$028c
	stz	$028e

	stz	$0290
	stz	$0292
	stz	$0294
	stz	$0296
	stz	$0298
	stz	$029a
	stz	$029c
	stz	$029e


	stz	$02a0
	stz	$02a2
	stz	$02a4
	stz	$02a6
	stz	$02a8
	stz	$02aa
	stz	$02ac
	stz	$02ae


	stz	$02b0
	stz	$02b2
	stz	$02b4
	stz	$02b6
	stz	$02b8
	stz	$02ba
	stz	$02bc
	stz	$02be


	stz	$02c0
	stz	$02c2
	stz	$02c4
	stz	$02c6
	stz	$02c8
	stz	$02ca
	stz	$02cc
	stz	$02ce


	stz	$02d0
	stz	$02d2
	stz	$02d4
	stz	$02d6
	stz	$02d8
	stz	$02da
	stz	$02dc
	stz	$02de


	stz	$02e0
	stz	$02e2
	stz	$02e4
	stz	$02e6
	stz	$02e8
	stz	$02ea
	stz	$02ec
	stz	$02ee


	stz	$02f0
	stz	$02f2
	stz	$02f4
	stz	$02f6
	stz	$02f8
	stz	$02fa
	stz	$02fc
	stz	$02fe









	stz	$0300
	stz	$0302
	stz	$0304
	stz	$0306
	stz	$0308
	stz	$030a
	stz	$030c
	stz	$030e
	stz	$0310
	stz	$0312
	stz	$0314
	stz	$0316
	stz	$0318
	stz	$031a
	stz	$031c
	stz	$031e
	stz	$0320
	stz	$0322
	stz	$0324
	stz	$0326
	stz	$0328
	stz	$032a
	stz	$032c
	stz	$032e
	stz	$0330
	stz	$0332
	stz	$0334
	stz	$0336
	stz	$0338
	stz	$033a
	stz	$033c
	stz	$033e
	stz	$0340
	stz	$0342
	stz	$0344
	stz	$0346
	stz	$0348
	stz	$034a
	stz	$034c
	stz	$034e
	stz	$0350
	stz	$0352
	stz	$0354
	stz	$0356
	stz	$0358
	stz	$035a
	stz	$035c
	stz	$035e
	stz	$0360
	stz	$0362
	stz	$0364
	stz	$0366
	stz	$0368
	stz	$036a
	stz	$036c
	stz	$036e
	stz	$0370
	stz	$0372
	stz	$0374
	stz	$0376
	stz	$0378
	stz	$037a
	stz	$037c
	stz	$037e
	stz	$0380
	stz	$0382
	stz	$0384
	stz	$0386
	stz	$0388
	stz	$038a
	stz	$038c
	stz	$038e
	stz	$0390
	stz	$0392
	stz	$0394
	stz	$0396
	stz	$0398
	stz	$039a
	stz	$039c
	stz	$039e
	stz	$03a0
	stz	$03a2
	stz	$03a4
	stz	$03a6
	stz	$03a8
	stz	$03aa
	stz	$03ac
	stz	$03ae
	stz	$03b0
	stz	$03b2
	stz	$03b4
	stz	$03b6
	stz	$03b8
	stz	$03ba
	stz	$03bc
	stz	$03be
	stz	$03c0
	stz	$03c2
	stz	$03c4
	stz	$03c6
	stz	$03c8
	stz	$03ca
	stz	$03cc
	stz	$03ce
	stz	$03d0
	stz	$03d2
	stz	$03d4
	stz	$03d6
	stz	$03d8
	stz	$03da
	stz	$03dc
	stz	$03de
	stz	$03e0
	stz	$03e2
	stz	$03e4
	stz	$03e6
	stz	$03e8
	stz	$03ea
	stz	$03ec
	stz	$03ee
	stz	$03f0
	stz	$03f2
	stz	$03f4
	stz	$03f6
	stz	$03f8
	stz	$03fa
	stz	$03fc
	stz	$03fe


	stz	$0400
	stz	$0402
	stz	$0404
	stz	$0406
	stz	$0408
	stz	$040a
	stz	$040c
	stz	$040e
	stz	$0410
	stz	$0412
	stz	$0414
	stz	$0416
	stz	$0418
	stz	$041a
	stz	$041c
	stz	$041e
	stz	$0420
	stz	$0422
	stz	$0424
	stz	$0426
	stz	$0428
	stz	$042a
	stz	$042c
	stz	$042e
	stz	$0430
	stz	$0432
	stz	$0434
	stz	$0436
	stz	$0438
	stz	$043a
	stz	$043c
	stz	$043e
	stz	$0440
	stz	$0442
	stz	$0444
	stz	$0446
	stz	$0448
	stz	$044a
	stz	$044c
	stz	$044e
	stz	$0450
	stz	$0452
	stz	$0454
	stz	$0456
	stz	$0458
	stz	$045a
	stz	$045c
	stz	$045e
	stz	$0460
	stz	$0462
	stz	$0464
	stz	$0466
	stz	$0468
	stz	$046a
	stz	$046c
	stz	$046e
	stz	$0470
	stz	$0472
	stz	$0474
	stz	$0476
	stz	$0478
	stz	$047a
	stz	$047c
	stz	$047e
	stz	$0480
	stz	$0482
	stz	$0484
	stz	$0486
	stz	$0488
	stz	$048a
	stz	$048c
	stz	$048e
	stz	$0490
	stz	$0492
	stz	$0494
	stz	$0496
	stz	$0498
	stz	$049a
	stz	$049c
	stz	$049e
	stz	$04a0
	stz	$04a2
	stz	$04a4
	stz	$04a6
	stz	$04a8
	stz	$04aa
	stz	$04ac
	stz	$04ae
	stz	$04b0
	stz	$04b2
	stz	$04b4
	stz	$04b6
	stz	$04b8
	stz	$04ba
	stz	$04bc
	stz	$04be
	stz	$04c0
	stz	$04c2
	stz	$04c4
	stz	$04c6
	stz	$04c8
	stz	$04ca
	stz	$04cc
	stz	$04ce
	stz	$04d0
	stz	$04d2
	stz	$04d4
	stz	$04d6
	stz	$04d8
	stz	$04da
	stz	$04dc
	stz	$04de
	stz	$04e0
	stz	$04e2
	stz	$04e4
	stz	$04e6
	stz	$04e8
	stz	$04ea
	stz	$04ec
	stz	$04ee
	stz	$04f0
	stz	$04f2
	stz	$04f4
	stz	$04f6
	stz	$04f8
	stz	$04fa
	stz	$04fc
	stz	$04fe



	stz	$0500
	stz	$0502
	stz	$0504
	stz	$0506
	stz	$0508
	stz	$050a
	stz	$050c
	stz	$050e
	stz	$0510
	stz	$0512
	stz	$0514
	stz	$0516
	stz	$0518
	stz	$051a
	stz	$051c
	stz	$051e
	stz	$0520
	stz	$0522
	stz	$0524
	stz	$0526
	stz	$0528
	stz	$052a
	stz	$052c
	stz	$052e
	stz	$0530
	stz	$0532
	stz	$0534
	stz	$0536
	stz	$0538
	stz	$053a
	stz	$053c
	stz	$053e
	stz	$0540
	stz	$0542
	stz	$0544
	stz	$0546
	stz	$0548
	stz	$054a
	stz	$054c
	stz	$054e
	stz	$0550
	stz	$0552
	stz	$0554
	stz	$0556
	stz	$0558
	stz	$055a
	stz	$055c
	stz	$055e
	stz	$0560
	stz	$0562
	stz	$0564
	stz	$0566
	stz	$0568
	stz	$056a
	stz	$056c
	stz	$056e
	stz	$0570
	stz	$0572
	stz	$0574
	stz	$0576
	stz	$0578
	stz	$057a
	stz	$057c
	stz	$057e
	stz	$0580
	stz	$0582
	stz	$0584
	stz	$0586
	stz	$0588
	stz	$058a
	stz	$058c
	stz	$058e
	stz	$0590
	stz	$0592
	stz	$0594
	stz	$0596
	stz	$0598
	stz	$059a
	stz	$059c
	stz	$059e
	stz	$05a0
	stz	$05a2
	stz	$05a4
	stz	$05a6
	stz	$05a8
	stz	$05aa
	stz	$05ac
	stz	$05ae
	stz	$05b0
	stz	$05b2
	stz	$05b4
	stz	$05b6
	stz	$05b8
	stz	$05ba
	stz	$05bc
	stz	$05be
	stz	$05c0
	stz	$05c2
	stz	$05c4
	stz	$05c6
	stz	$05c8
	stz	$05ca
	stz	$05cc
	stz	$05ce
	stz	$05d0
	stz	$05d2
	stz	$05d4
	stz	$05d6
	stz	$05d8
	stz	$05da
	stz	$05dc
	stz	$05de
	stz	$05e0
	stz	$05e2
	stz	$05e4
	stz	$05e6
	stz	$05e8
	stz	$05ea
	stz	$05ec
	stz	$05ee
	stz	$05f0
	stz	$05f2
	stz	$05f4
	stz	$05f6
	stz	$05f8
	stz	$05fa
	stz	$05fc
	stz	$05fe


	stz	$0600
	stz	$0602
	stz	$0604
	stz	$0606
	stz	$0608
	stz	$060a
	stz	$060c
	stz	$060e
	stz	$0610
	stz	$0612
	stz	$0614
	stz	$0616
	stz	$0618
	stz	$061a
	stz	$061c
	stz	$061e
	stz	$0620
	stz	$0622
	stz	$0624
	stz	$0626
	stz	$0628
	stz	$062a
	stz	$062c
	stz	$062e
	stz	$0630
	stz	$0632
	stz	$0634
	stz	$0636
	stz	$0638
	stz	$063a
	stz	$063c
	stz	$063e
	stz	$0640
	stz	$0642
	stz	$0644
	stz	$0646
	stz	$0648
	stz	$064a
	stz	$064c
	stz	$064e
	stz	$0650
	stz	$0652
	stz	$0654
	stz	$0656
	stz	$0658
	stz	$065a
	stz	$065c
	stz	$065e
	stz	$0660
	stz	$0662
	stz	$0664
	stz	$0666
	stz	$0668
	stz	$066a
	stz	$066c
	stz	$066e
	stz	$0670
	stz	$0672
	stz	$0674
	stz	$0676
	stz	$0678
	stz	$067a
	stz	$067c
	stz	$067e
	stz	$0680
	stz	$0682
	stz	$0684
	stz	$0686
	stz	$0688
	stz	$068a
	stz	$068c
	stz	$068e
	stz	$0690
	stz	$0692
	stz	$0694
	stz	$0696
	stz	$0698
	stz	$069a
	stz	$069c
	stz	$069e
	stz	$06a0
	stz	$06a2
	stz	$06a4
	stz	$06a6
	stz	$06a8
	stz	$06aa
	stz	$06ac
	stz	$06ae
	stz	$06b0
	stz	$06b2
	stz	$06b4
	stz	$06b6
	stz	$06b8
	stz	$06ba
	stz	$06bc
	stz	$06be
	stz	$06c0
	stz	$06c2
	stz	$06c4
	stz	$06c6
	stz	$06c8
	stz	$06ca
	stz	$06cc
	stz	$06ce
	stz	$06d0
	stz	$06d2
	stz	$06d4
	stz	$06d6
	stz	$06d8
	stz	$06da
	stz	$06dc
	stz	$06de
	stz	$06e0
	stz	$06e2
	stz	$06e4
	stz	$06e6
	stz	$06e8
	stz	$06ea
	stz	$06ec
	stz	$06ee
	stz	$06f0
	stz	$06f2
	stz	$06f4
	stz	$06f6
	stz	$06f8
	stz	$06fa
	stz	$06fc
	stz	$06fe


	stz	$0700
	stz	$0702
	stz	$0704
	stz	$0706
	stz	$0708
	stz	$070a
	stz	$070c
	stz	$070e
	stz	$0710
	stz	$0712
	stz	$0714
	stz	$0716
	stz	$0718
	stz	$071a
	stz	$071c
	stz	$071e
	stz	$0720
	stz	$0722
	stz	$0724
	stz	$0726
	stz	$0728
	stz	$072a
	stz	$072c
	stz	$072e
	stz	$0730
	stz	$0732
	stz	$0734
	stz	$0736
	stz	$0738
	stz	$073a
	stz	$073c
	stz	$073e
	stz	$0740
	stz	$0742
	stz	$0744
	stz	$0746
	stz	$0748
	stz	$074a
	stz	$074c
	stz	$074e
	stz	$0750
	stz	$0752
	stz	$0754
	stz	$0756
	stz	$0758
	stz	$075a
	stz	$075c
	stz	$075e
	stz	$0760
	stz	$0762
	stz	$0764
	stz	$0766
	stz	$0768
	stz	$076a
	stz	$076c
	stz	$076e
	stz	$0770
	stz	$0772
	stz	$0774
	stz	$0776
	stz	$0778
	stz	$077a
	stz	$077c
	stz	$077e
	stz	$0780
	stz	$0782
	stz	$0784
	stz	$0786
	stz	$0788
	stz	$078a
	stz	$078c
	stz	$078e
	stz	$0790
	stz	$0792
	stz	$0794
	stz	$0796
	stz	$0798
	stz	$079a
	stz	$079c
	stz	$079e
	stz	$07a0
	stz	$07a2
	stz	$07a4
	stz	$07a6
	stz	$07a8
	stz	$07aa
	stz	$07ac
	stz	$07ae
	stz	$07b0
	stz	$07b2
	stz	$07b4
	stz	$07b6
	stz	$07b8
	stz	$07ba
	stz	$07bc
	stz	$07be
	stz	$07c0
	stz	$07c2
	stz	$07c4
	stz	$07c6
	stz	$07c8
	stz	$07ca
	stz	$07cc
	stz	$07ce
	stz	$07d0
	stz	$07d2
	stz	$07d4
	stz	$07d6
	stz	$07d8
	stz	$07da
	stz	$07dc
	stz	$07de
	stz	$07e0
	stz	$07e2
	stz	$07e4
	stz	$07e6
	stz	$07e8
	stz	$07ea
	stz	$07ec
	stz	$07ee
	stz	$07f0
	stz	$07f2
	stz	$07f4
	stz	$07f6
	stz	$07f8
	stz	$07fa
	stz	$07fc
	stz	$07fe


	stz	$0800
	stz	$0802
	stz	$0804
	stz	$0806
	stz	$0808
	stz	$080a
	stz	$080c
	stz	$080e
	stz	$0810
	stz	$0812
	stz	$0814
	stz	$0816
	stz	$0818
	stz	$081a
	stz	$081c
	stz	$081e
	stz	$0820
	stz	$0822
	stz	$0824
	stz	$0826
	stz	$0828
	stz	$082a
	stz	$082c
	stz	$082e
	stz	$0830
	stz	$0832
	stz	$0834
	stz	$0836
	stz	$0838
	stz	$083a
	stz	$083c
	stz	$083e
	stz	$0840
	stz	$0842
	stz	$0844
	stz	$0846
	stz	$0848
	stz	$084a
	stz	$084c
	stz	$084e
	stz	$0850
	stz	$0852
	stz	$0854
	stz	$0856
	stz	$0858
	stz	$085a
	stz	$085c
	stz	$085e
	stz	$0860
	stz	$0862
	stz	$0864
	stz	$0866
	stz	$0868
	stz	$086a
	stz	$086c
	stz	$086e
	stz	$0870
	stz	$0872
	stz	$0874
	stz	$0876
	stz	$0878
	stz	$087a
	stz	$087c
	stz	$087e
	stz	$0880
	stz	$0882
	stz	$0884
	stz	$0886
	stz	$0888
	stz	$088a
	stz	$088c
	stz	$088e
	stz	$0890
	stz	$0892
	stz	$0894
	stz	$0896
	stz	$0898
	stz	$089a
	stz	$089c
	stz	$089e
	stz	$08a0
	stz	$08a2
	stz	$08a4
	stz	$08a6
	stz	$08a8
	stz	$08aa
	stz	$08ac
	stz	$08ae
	stz	$08b0
	stz	$08b2
	stz	$08b4
	stz	$08b6
	stz	$08b8
	stz	$08ba
	stz	$08bc
	stz	$08be
	stz	$08c0
	stz	$08c2
	stz	$08c4
	stz	$08c6
	stz	$08c8
	stz	$08ca
	stz	$08cc
	stz	$08ce
	stz	$08d0
	stz	$08d2
	stz	$08d4
	stz	$08d6
	stz	$08d8
	stz	$08da
	stz	$08dc
	stz	$08de
	stz	$08e0
	stz	$08e2
	stz	$08e4
	stz	$08e6
	stz	$08e8
	stz	$08ea
	stz	$08ec
	stz	$08ee
	stz	$08f0
	stz	$08f2
	stz	$08f4
	stz	$08f6
	stz	$08f8
	stz	$08fa
	stz	$08fc
	stz	$08fe



	stz	$0900
	stz	$0902
	stz	$0904
	stz	$0906
	stz	$0908
	stz	$090a
	stz	$090c
	stz	$090e
	stz	$0910
	stz	$0912
	stz	$0914
	stz	$0916
	stz	$0918
	stz	$091a
	stz	$091c
	stz	$091e
	stz	$0920
	stz	$0922
	stz	$0924
	stz	$0926
	stz	$0928
	stz	$092a
	stz	$092c
	stz	$092e
	stz	$0930
	stz	$0932
	stz	$0934
	stz	$0936
	stz	$0938
	stz	$093a
	stz	$093c
	stz	$093e
	stz	$0940
	stz	$0942
	stz	$0944
	stz	$0946
	stz	$0948
	stz	$094a
	stz	$094c
	stz	$094e
	stz	$0950
	stz	$0952
	stz	$0954
	stz	$0956
	stz	$0958
	stz	$095a
	stz	$095c
	stz	$095e
	stz	$0960
	stz	$0962
	stz	$0964
	stz	$0966
	stz	$0968
	stz	$096a
	stz	$096c
	stz	$096e
	stz	$0970
	stz	$0972
	stz	$0974
	stz	$0976
	stz	$0978
	stz	$097a
	stz	$097c
	stz	$097e
	stz	$0980
	stz	$0982
	stz	$0984
	stz	$0986
	stz	$0988
	stz	$098a
	stz	$098c
	stz	$098e
	stz	$0990
	stz	$0992
	stz	$0994
	stz	$0996
	stz	$0998
	stz	$099a
	stz	$099c
	stz	$099e
	stz	$09a0
	stz	$09a2
	stz	$09a4
	stz	$09a6
	stz	$09a8
	stz	$09aa
	stz	$09ac
	stz	$09ae
	stz	$09b0
	stz	$09b2
	stz	$09b4
	stz	$09b6
	stz	$09b8
	stz	$09ba
	stz	$09bc
	stz	$09be
	stz	$09c0
	stz	$09c2
	stz	$09c4
	stz	$09c6
	stz	$09c8
	stz	$09ca
	stz	$09cc
	stz	$09ce
	stz	$09d0
	stz	$09d2
	stz	$09d4
	stz	$09d6
	stz	$09d8
	stz	$09da
	stz	$09dc
	stz	$09de
	stz	$09e0
	stz	$09e2
	stz	$09e4
	stz	$09e6
	stz	$09e8
	stz	$09ea
	stz	$09ec
	stz	$09ee
	stz	$09f0
	stz	$09f2
	stz	$09f4
	stz	$09f6
	stz	$09f8
	stz	$09fa
	stz	$09fc
	stz	$09fe



	rts

bbsgfx:
	.bin	dscroll.dat
bbstiles:
	.bin	dscroll.char
dscrcol:
	dc.w	$0000,$ff7f,$0000,$0000,$0000,$0000,$0000,$0000
	dc.w	$0000,$0000,$0000,$0000,$0000,$0000,$0000,$0000
	dc.w	$0000,$0000,$0000,$0000,$0000,$0000,$0000,$0000
	dc.w	$0000,$0000,$0000,$0000,$0000,$0000,$0000,$0000

	dc.w	0,$ff7f,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0

	.bin	dscroll.col


	.bin	dscroll.col
	.pad



;============================================================================
;                              START OF BANK #$01
;============================================================================

gStart:
	sei			; Stop Interrupts
	phk			; Actuell bank on stack
	plb			; Actuell bank from stack on data bank 
	clc			; Clr Carry
	xce			; Native 16 bitmode  (no 6502 Emulation!) 
	REP #$30  
	LDA #$1FFF
	TCS       
	LDA #$0000
	TCD
;==========================================================================


	jsr	!gSnes_init

	rep     #$30		; X,Y,A fixed -> 16 bit mode
	sep     #$20		; Accumulator ->  8 bit mode


	Lda	#$31		; mode 1, 16*16 dot
	Sta	$2105	

	Lda	#$50		; Start Tile Adres BG1 $5000
	Sta	$2107	
	lda	#$58
	sta	$2108		; start tile BG2 $5800

	Stz	$210b		; Start Gfx in Vram  $0000


	lda	#$74
	sta	$2109
	lda	#$44
	sta	$210c
	
	lda	#$fc
	sta	$2112
	lda	#$07
	sta	$2112

	Lda	#$00		; BG1 Enable
	Sta	$212c



	jsr	 gCopy_Gfx
	jsr	 gCopy_Colors
	;jsr	 gMake_Tiles
	jsr	Sprite_Setup
	jsr	Levelmapramcopy
	jsr	 gHDMA
	rep	#$30
	ldx	#$0000
	stx	Plane0X		; current horizontal offset

	ldx	#$00ff
	stx	Plane0Y		; vertical offset

	ldx	#$0000
	stx	column_map_offset		; column map offset

	ldx	#$0000
	stx	joypaddata		; joypad data!

	lda	Map+4
	xba
	sta	MapX		; read map X length

	lda	Map+6		
	xba
	sta	MapY		; read map Y length (always #$0020)

	stx	Plane0TileAddress		; Plane0TileAddress storage value

	stx	Vramtransfer	; vram map transfer flag ( 1 = transfer)
				; transfers plane0 data to column

	ldx	#$001f
	stx	Screen0Column		; screen column offset

	ldx	#$0000
	stx	Plane1X

	lda	#$00ff
	lsr a
	sta	Plane1Y

	ldx	#$0000
	stx	column_map_offset2

	ldx	#$001f
	stx	Screen1Column

	lda	Map2+4
	xba
	sta	MapX2

	lda	Map2+6
	xba
	sta	MapY2

	ldx	#$0000
	stx	Vramtransfer2
	stx	Plane1TileAddress




	ldx	#$0020
	stx	MainH		; H position of main character sprite
	ldx	#$0040
	stx	MainV		; V position of Main character sprite
	stx	MainJump
	ldx	#$0000
	stx	MainAnim	; anim frame # for main character
	stx	MainFlip	; left/right #$40 = left

	stx	Jumpflag
	stx	Jumpoffset
	stx	JumpFallflag
	stx	PickObjTest  
	stx	PickObjChar1 
	stx	PickObjChar2 
	stx	PickObjAdd   
	stx	Storage5     
	stx	Storage6


	stx	Jumpflag    
	stx	MainJump    
	stx	Jumpoffset  
	stx	JumpFallflag
	stx	PickObjTest 
	stx	PickObjChar1
	stx	PickObjChar2
	stx	PickObjAdd  
	stx	Storage5    
	stx	Storage6    
	stx	PickObjHelp 
	stx	PickObjTest2
	stx	PickObjAdd2 
	stx	Fireonflag  
	stx	Firedistance
	stx	Firestore

	stx	Firestore2 
	stx	Firechaindistance 
	stx	Firechaindisplacement 
	stx	Firechainsprite   
	stx	FirechaindistanceV 
	stx	FirechaindisplacementV 
	stx	Firestore3        
	stx	Fallfixer     
	stx	FireHoriz  
	stx	FireVert
	stx	Scorelo     
	stx	Scorehi   
	stx	Scoredigit1 
	stx	Scoredigit3 
	stx	Scoredigit5 
	stx	Scoredigit7 
	stx	Scoreoffset
	stx	Objectchangetest
	stx	ObjectchangeAdd
	stx	Objectchangechar
	stx	BallH
	stx	BallV
	stx	SCROLLEOR
	ldx	#$0001		; 0 = slow, 1 = med, 2 = fast
	stx	Scrollspeed
	ldx	#$0000
	stx	Bombon     
	stx	Bombleft   
	stx	Bombright  
	ldx	#%00101111
	stx	Bombaddsub
	ldx	#%01011111
	stx	Bombcolor
	ldx	#$0020
	stx	Bombeffecton
	ldx	#$0000
	stx	backmapeor

	stx	Starannimcount
	stx	Starframecount
	stx	Programeor
	stx	Weapontestoffset 
	stx	Weapontestcount
	stx	Weapontestchange
	stx	Storage7
	stx	Storage8
	stx	healthlo     
	stx	healthhi     
	stx	healthdigit1 
	stx	healthdigit3 
	stx	healthdigit5 
	stx	healthdigit7 
	stx	healthoffset
	stx	Movescreentest
	stx	Movescreentest2
	stx	Movescreentest3
	stx	Jumphalftest
	stx	Joybounceone
	stx	HeadFallflag
	stx	Fallflag
	stx	endgame


	ldx	#$0004
	stx	healthdigit1
	ldx	#$0002
	stx	healthdigit3

	sep	#$20


	jsr	Weaponclear	; clear weapon data
	jsr      gMake_Tiles

	Lda	#$0f		; Screen Blanker Enabled
	Sta	$2100	
				;
	lda	#$13
	sta	$212c		; plane 0, sprites on

	lda	#$33		; planes 0-3 uses Window 1
	sta	$2123
	stz	$2134

	lda	#$c3		; Color window uses window 2
	sta	$2125		; Obj window uses window 1
	
	lda	#$00		; window 1 start
	sta	$2126
	lda	#$ff		; window 1 end
	sta	$2127

	;lda	#$40		; window 2 start
	lda	Bombleft
	sta	$2128
	;lda	#$a0		; Window 2 end
	lda	Bombright
	sta	$2129

	lda	#$0c		; Color Window Logic 0 = or
	sta	$212b		; 4 =and , 8 = xor, c = xnor

	lda	#%11111		; Main screen mask belongs to obj, and planes
	sta	$212e		; same with subscreen
	lda	#$00
	sta	$212f

	;lda	#$20		; sub screen window, effect happens INSIDE
	lda	Bombeffecton
	sta	$2130		; window	; 30 = turn effect OFF
						; 20 = turn effect on in window
						; 00 = on ALWAYS
	;lda	#%00101111	; Color addition
	lda	Bombaddsub
 	sta	$2131		; not 1/2 bright, back, no obj, bg0-3

	;lda	#%01011111	; blue off, green on, red off
	lda	Bombcolor
	sta	$2132		; lowest 5 bits = brightness
	

	lda	#$00
	sta	$2133		; #$08 = pseudo 512 mode, makes a nice 
				; blend effect, blends all graf-x 
				; with the 0 color background!
				; +1 = interlace, nice  HAZY look
	lda	#$01
	sta	$4200		; enable joypad

;======================= End Init =========================================

gWait1:
	
	jsr	 gWaitVb		; Wait for Vertical blank

	lda	#$8f
	sta	$2100

	jsr	Copyspriteoam	; copy Sprite data to OAM
	lda	Vramtransfer	; test vram transfer flag
	beq	novrammap

	jsr	Copymapvram	; transfer Map column to vram

novrammap:

	lda	Vramtransfer2
	beq	novrambackmap
	jsr	Copybackmapvram

novrambackmap:
	jsr	Staranimtransfer
	jsr	Mainsprgfx
	jsr	Pickobjvram	; delete picked up object from Vram
	jsr	Objectchange
	jsr	Bombmaker
	sep	#$20
	lda	Plane0X		; get X value for Plane 0
	sta	$210d
	lda	Plane0X+1
	sta	$210d

	lda	Plane0Y		; get Y value for Plane 0
	sta	$210e
	lda	Plane0Y+1
	sta	$210e

	lda	Plane1X
	sta	$210f
	lda	Plane1X+1
	sta	$210f
	rep	#$30
	lda	Plane0Y
	inc a
	and	#$01ff
	lsr a
	sep	#$20
	sta	$2110
	stz	$2110

	jsr	gJoypad		; Read Joypad and store it in joypaddata
	jsr	Walkmove	; check joypad for left/right/up/down

	jsr	Walkmovescreen
	jsr	MainSprite	; Do main sprite's functions


	jsr	Joybuttons	; Read joybuttons and flag routines



	jsr	Objectchangetester

	jsr	Halfspeedrouts
	jsr	Halfspeedrouts2
	sep	#$20
	lda	#$0f
	sta	$2100

	jsr	PAUSE
	lda	Programeor
	eor	#$01
	sta	Programeor

	rep	#$30
	lda	healthdigit1
	ora	healthdigit3
	bne	noendgame
	lda	#$0040
	sta	endgame
noendgame:
	sep	#$20



	lda	joypaddata
	ora	endgame
	bit	#$40		; if X or timer end flag = $40, end game
	bne	stopgame
	jmp	!gWait1		; go back to Main Loop
stopgame:

	sep	#$20
	jsr	!gWaitVb
	stz	$420c
	stz	$420b
	lda	#$80
	sta	$2100
	jml	>continue



;==========================================================================
;                        Start Vertical Blank
;==========================================================================
gWaitVb:
	lda	$4210		; NMI Enable (Begin V-Blank)
	bpl	gWaitVb		; 
	lda	$4210		; Reset NMI Flag By Reading it
	rts




;=========================================================================
;                         Routines at 2 vblank times
;=========================================================================

Halfspeedrouts:
	sep	#$20
	lda	Programeor
	beq	Halfspeedroutsok
	rts
Halfspeedroutsok:

	jsr	Pickobjup 	;pick object from screen routine         
        jsr	Pickobjup2  	;pick up object from screen (head height)
	jsr	Scoresprite	; print score as sprites on top of screen
	rts

;==========================================================================
;         Routines at 2 vblank times, parallel to above - next frame
;==========================================================================
Halfspeedrouts2:
	sep	#$20
	lda	Programeor
	bne	Halfspeedroutsok2
	rts
Halfspeedroutsok2:
	jsr	Healthsprite	; prints health counter as sprites at bottom 
	jsr	Staranim	; calcs the current pointer for star animation
	jsr	HDMAcolpoint	; calcs the HDMA color backdrop via Plane0Y
	jsr	Healthdecone
 	rts



;==========================================================================
;                      Health counter decrease 
;==========================================================================

Healthdecone:
	rep	#$20
	lda	healthdigit1		; check if the Health is 0000
	ora	healthdigit3
	bne	Healthdecok		; branch if Not Equal
	sep	#$20
	rts
Healthdecok:
	sep	#$20
	lda	healthdigit5	; seconds counter
	dec a
	and	#$1f
	sta	healthdigit5	; timer to slow things down
	beq	Healthsubone
	rts
Healthsubone:

	lda	healthdigit3+1	; check if the number is less than 200
	bne	Healthsuboneok1	; if so, then set up alert
	lda	healthdigit3
	cmp	#$02		; is hundreds below 200 ? (199->)
	bcs	Healthsuboneok1
	lda	#$01
	sta	healthdigit7	; flag to enable blinking
	bra	Healthsuboneok2
Healthsuboneok1:
	stz	healthdigit7
Healthsuboneok2:
	dec	healthdigit1
	lda	healthdigit1
	bmi	Healthsubonepass	; decrease ones
	rts
Healthsubonepass:
	lda	#$09
	sta	healthdigit1
	dec	healthdigit1+1
	lda	healthdigit1+1		; decrease tens
	bmi	Healthsubtenpass
	rts
Healthsubtenpass:
	lda	#$09
	sta	healthdigit1+1
	dec	healthdigit3
	lda	healthdigit3		; decrease hundreds
	bmi	Healthsubhundredpass
	rts
Healthsubhundredpass:
	lda	#$09
	sta	healthdigit3
	dec	healthdigit3+1		; decrease thousands
	rts	




;==========================================================================
;                          Main Sprite GFX animation frame copy
;==========================================================================

Mainsprgfx:
	
	rep	#$30
	lda	MainAnim		; read anim frame #
	and	#$00ff			; get only byte
	cmp	#$30
	beq	Mainframereset		; 30 frames
	bcc	Mainframenoreset	; lower than 30 frames
Mainframereset:
	sep	#$20
	lda	#$00
	sta	MainAnim		; if frame count passes $30 then reset 
Mainframenoreset:
	rep	#$30
	lda	MainAnim
	tax
	lda	MainAnimFrames,x
	and	#$00ff	
	asl a
	asl a
	asl a 				; *64, 16bits wide per sprite
	asl a
	asl a
	asl a
	asl a
	sta	Storage5
	clc
	adc	#Mainspriteanim1
	sta	Storage

	lda	Storage5
	clc
	adc	#Mainspriteanim2
	sta	Storage2

	lda	Storage5
	clc
	adc	#Mainspriteanim3
	sta	Storage3



	lda	Storage5
	clc
	adc	#Mainspriteanim4
	sta	Storage4



	sep	#$20

	lda	#$80
	sta	$2115		; increase V-Ram after writing to $2119	

	lda	#$01
	sta	$4370		; 0= 1 byte per register (not a word!)
	lda	#$18
	sta	$4371		; 21xx   this is 2118 (VRAM)
	ldx	Storage
	stx	$4372		; address of anim frame

	lda	#^Mainspriteanim1
	sta	$4374		; bank address of data in mem
	ldx	#$0080
	stx	$4375		; # of bytes to be transferred

	ldx	#$6000		; 0000
	stx	$2116		; address of VRAM to copy garphics in
	lda	#$80		; turn on bit 4 (%10000000=$80) of G-DMA channel
	sta	$420b

	
				; start of General DMA graphics copy routine!
	lda	#$01
	sta	$4370		; 0= 1 byte per register (not a word!)
	lda	#$18
	sta	$4371		; 21xx   this is 2118 (VRAM)
	ldx	Storage2
	stx	$4372		; address of anim frame
	lda	#^Mainspriteanim2
	sta	$4374		; bank address of data in mem
	ldx	#$0080
	stx	$4375		; # of bytes to be transferred
	
	ldx	#$6100
	stx	$2116		; address of VRAM to copy graphics in
	lda	#$80		; turn on bit 4 (%10000000=$80) of G-DMA channel
	sta	$420b


	lda	#$01
	sta	$4370		; 0= 1 byte per register (not a word!)
	lda	#$18
	sta	$4371		; 21xx   this is 2118 (VRAM)
	ldx	Storage3
	stx	$4372		; address of anim frame

	lda	#^Mainspriteanim3
	sta	$4374		; bank address of data in mem
	ldx	#$0080
	stx	$4375		; # of bytes to be transferred

	ldx	#$6200		; 0000
	stx	$2116		; address of VRAM to copy garphics in
	lda	#$80		; turn on bit 4 (%10000000=$80) of G-DMA channel
	sta	$420b

	
				; start of General DMA graphics copy routine!
	lda	#$01
	sta	$4370		; 0= 1 byte per register (not a word!)
	lda	#$18
	sta	$4371		; 21xx   this is 2118 (VRAM)
	ldx	Storage4
	stx	$4372		; address of anim frame
	lda	#^Mainspriteanim4
	sta	$4374		; bank address of data in mem
	ldx	#$0080
	stx	$4375		; # of bytes to be transferred
	
	ldx	#$6300
	stx	$2116		; address of VRAM to copy graphics in
	lda	#$80		; turn on bit 4 (%10000000=$80) of G-DMA channel
	sta	$420b
	rts





;==========================================================================
;                     Star animation transfer routine
;==========================================================================

Staranimtransfer:
	rep	#$30
	lda	Starframecount
	clc
	adc	#Starstop
	sta	Storage

	lda	Starframecount
	clc
	adc	#Starsbottom
	sta	Storage2


	sep	#$20
	
				; start of General DMA graphics copy routine!
	lda	#$01
	sta	$4370		; 0= 1 byte per register (not a word!)
	lda	#$18
	sta	$4371		; 21xx   this is 2118 (VRAM)
	ldx	Storage
	stx	$4372		; address of anim frame

	lda	#^Starstop
	sta	$4374		; bank address of data in mem
	ldx	#$0040
	stx	$4375		; # of bytes to be transferred
	lda	#$80
	sta	$2115		; increase V-Ram address after writing to
				; $2119, 32 by 32
	ldx	#$ae0		; 15c0
	stx	$2116		; address of VRAM to copy garphics in
	lda	#$80		; turn on bit 4 (%10000000=$80) of G-DMA channel
	sta	$420b
	lda	#$80		; increase V-Ram address after writing to
	sta	$2115		; $2119


	
				; start of General DMA graphics copy routine!
	lda	#$01
	sta	$4370		; 0= 1 byte per register (not a word!)
	lda	#$18
	sta	$4371		; 21xx   this is 2118 (VRAM)
	ldx	Storage2
	stx	$4372		; address of anim frame
	lda	#^Starstop
	sta	$4374		; bank address of data in mem
	ldx	#$0040
	stx	$4375		; # of bytes to be transferred
	lda	#$80
	sta	$2115		; increase V-Ram address after writing to
				; $2119, 32 by 32
	ldx	#$be0
	stx	$2116		; address of VRAM to copy garphics in
	lda	#$80		; turn on bit 4 (%10000000=$80) of G-DMA channel
	sta	$420b
	lda	#$80		; increase V-Ram address after writing to
	sta	$2115		; $2119




	rts










;==========================================================================
;                          Star animation, tile 107, char # $ae
;==========================================================================


Staranim:
	rep	#$30
	ldx	Starannimcount
	lda	Starframe,x
	and	#$00ff
	asl a
	asl a
	asl a		; * 32 (8 lines, by 4 planes = 32 bytes per char) 
	asl a
	asl a
	asl a
	sta	Starframecount
	inx
	cpx	#$0018
	bne	Staranimend
	ldx	#$0000
Staranimend:
	stx	Starannimcount
	sep	#$20
	rts

Starframe:

	dc.b	0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,2,2,2,2,1,1,1,1


;==========================================================================
;                    Create a color addition/subtraction bomb
;==========================================================================

Bombmaker:
	sep	#$20
	lda	Bombon
	bne	Bombison
	


	lda	#$30		; sub screen window, effect happens INSIDE
	sta	$2130		; window	; 30 = turn effect OFF
						; 20 = turn effect on in window
						; 00 = on ALWAYS
	lda	joypaddata
	and	#$80
	bne	Bombturnon
	rts

Bombturnon:
	inc	Bombon		; turn the bomb on	
	
	lda	MainH      
	sta     Bombleft
	inc a    
	sta     Bombright   

	ldx     #%00101111  
	stx     Bombaddsub  
	ldx     #%01011111  
	stx     Bombcolor   
	ldx     #$0020      
	stx     Bombeffecton

Bombison:
		
	lda	Bombright
	sec
	sbc	Bombleft
	lsr a
	lsr a
	lsr a
	sta	Storage	



	lda	Bombleft	; window 2 start
	sta	$2128
	lda	Bombright	; Window 2 end
	sta	$2129

	lda	Bombeffecton	; sub screen window, effect happens INSIDE
	sta	$2130		; window	; 30 = turn effect OFF
						; 20 = turn effect on in window
						; 00 = on ALWAYS
	lda	Bombaddsub	; Color addition
 	sta	$2131		; not 1/2 bright, back, no obj, bg0-3

	lda	Bombcolor	; blue off, green on, red off
	and	#%11100000
	ora	Storage
	sta	$2132		; lowest 5 bits = brightness
	
	lda	Bombleft
	beq	Skipbombleft
	dec	Bombleft
Skipbombleft:
	lda	Bombright
	cmp	#$ff
	beq	Skipbombright
	inc	Bombright
	
Skipbombright:
	lda	Bombright
	inc a
	ora	Bombleft
	beq	Bombstop
	rts
Bombstop:
	stz	Bombon
	rts





;==========================================================================
;                           the Pause routine!
;==========================================================================

PAUSE:

	sep	#$20
	lda	joypaddata+1
	and	#$10			; check if start was pressed
	bne	Pauseon
	rts
Pauseon:


	rep	#30


	ldx	#$0000
	stx	Storage3		; sine data position

	ldx	#$0000
	stx	Storage4		; sine counter
	sep	#$20


	


	lda	#%10101010
	sta	$1d02			; setup sprites to be 16*16
	lda	$1d03
	and	#%11111100
	ora	#%00000010		; sprite8+5 to be 16*16
	sta	$1d03




Pauseon2:

	jsr	!gWaitVb			; go to v-blank
	jsr	!Copyspriteoam		; copy sprite data
	

	
	rep	#$30

	ldx	#$0066			; first character to put on screen
	stx	Storage

	ldx	#$0050			; Horizontal position	
	stx	Storage2


	ldy	#$0008			; sprite number
	ldx	#$0000
	tya
	asl a				; *4 for sprite address
	asl a
	tay
copyPause:	
	sep	#$20

	lda	Storage2
	sta	$1b00,y			; horizontal position

	phx				; store sprite counter


	ldx	Storage3		; get sine position
	lda	Pausesine,x
	sec
	sbc	#$10

	sta	$1b01,y			; vertical position

	lda	Storage3
	clc
	adc	#$08
	sta	Storage3

	plx				; get sprite counter back!

	lda	Storage
	sta	$1b02,y			; character #

	lda	#%00110010
	sta	$1b03,y			; palette and priority
	
	inc	Storage			; increase char number by 2
	inc	Storage

	lda	Storage2
	clc
	adc	#$10			; increase height spacing by 10
	sta	Storage2
	
	iny
	iny
	iny
	iny

	inx
	cpx	#$0005
	bne	copyPause

	lda	Storage3
	sec
	sbc	#39
	sta	Storage3

	inc	Storage4
	lda	Storage4
	cmp	#$83
	bne	Pauseon2



	ldx	#$0000

WaitPause:
	jsr	!gWaitVb
	inx
	cpx	#$0020
	bne	WaitPause


					;end of Pause
	sep	#$20
Pauseon3:
	jsr	!gJoypad

	lda	joypaddata+1
	and	#$10
	beq	Pauseon3

Pauseoff:

	ldx	#$0000
	stx	Storage3
	stx	Storage4

Pauseon4:

	jsr	!gWaitVb
	jsr	!Copyspriteoam
	

	
	rep	#$30

	ldx	#$0066			; first character to put on screen
	stx	Storage

	ldx	#$0050			; Horizontal position	
	stx	Storage2


	ldy	#$0008
	ldx	#$0000
	tya
	asl a
	asl a
	tay
copyPause2:	
	sep	#$20
	lda	Storage2
	sta	$1b00,y			; horizontal position

	phx				; store sprite counter


	ldx	Storage3		; get sine position
	lda	Pausesine2,x
	sec
	sbc	#$10
	sta	$1b01,y			; vertical position

	lda	Storage3
	clc
	adc	#$08
	sta	Storage3

	plx				; get sprite counter back!

	lda	Storage
	sta	$1b02,y			; character #

	lda	#%00110010
	sta	$1b03,y			; pallete and priority
	
	inc	Storage
	inc	Storage

	lda	Storage2
	clc
	adc	#$10
	sta	Storage2
	
	iny
	iny
	iny
	iny

	inx
	cpx	#$0005
	bne	copyPause2

	lda	Storage3
	sec
	sbc	#39
	sta	Storage3

	inc	Storage4
	lda	Storage4
	cmp	#$8a
	bne	Pauseon4







	rts





Pausesine:

 dc.b	0,0,0,0,0,0,0,0,0,0,0,1,1,1,2,2,2
 dc.b  3,3,4,4,5,5,6,7,8,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22
 dc.b  23,25,26,27,28,30,31,32,34,35,37,38,40,41,42,44,45,47,48,50
 dc.b  52,53,55,56,58,59,61,62
 dc.b  64,66,67,69,70,72,73,75,76,78,80,81,83,84,86,87,88,90,91,93
 dc.b  94,96,97,98,100,101,102,103,105,106,107,108,109,110,111,112
 dc.b  113,114,115,116,117,118,119,120,120,121,122,123,123,124,124
 dc.b  125,125,126,126,126,127,127,127,128,128,128,128,128,128,128

 dc.b	128,128,128,128,128,128,128,128,128,128,128,128,128,128
 dc.b	128,128,128,128,128,128,128

Pausesine2:
 dc.b	128,128,128,128,128,128,128,128,128,128,128,128,128,128
 dc.b	128,128,128,128,128,128,128

 dc.b  128,128,128,128,127,127,127,126,126,126,125,125,124,124,123
 dc.b  123,122,121,120,120,119,118,117,116,115,114,113,112,111,110
 dc.b  109,108,107,106,105,103,102,101,100,98,97,96,94,93,91,90,88
 dc.b  87,86,84,83,81,80,78,76,75,73,72,70,69,67,66,64,62,61,59,58
 dc.b  56,55,53,52,50,48,47,45,44,42,41,40,38,37,35,34,32,31,30,28
 dc.b  27,26,25,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,8,7
 dc.b  6,5,5,4,4,3,3,2,2,2,1,1,1
 dc.b	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0

 dc.b	0,0,0,0,0,0,0,0,0,0,0,0,0


;==========================================================================
;                 HDMA background color pointer via Plane0Y
;==========================================================================

HDMAcolpoint:
	rep	#$30
	lda	Plane0Y		; get plane pos
	inc a
	and	#$01ff		; get only 1 screen height
		
	lsr a
	lsr a			; (divide by 4!)
	sta	Storage5
	asl a			; multiply it by 2
	clc
	adc	Storage5	; add with the previous out come to get *3
	sta	Storage5
	lda	#$8000
	clc
	adc	Storage5
	sta	$4312
	sep	#$20
	rts








;=========================================================================
;                      Score conversion and sprite setup 
;=========================================================================

Scoresprite:
	rep	#$30
	sep	#$20

	stz	Scorelo		; 0 toggle (don't prints first zeros)
	stz	Scorelo+1


	ldx	#$0007		; # of digits (0-7)
	stx	Scoreoffset

	ldy	#$0000		; sprite # for score
	lda	#$10		; Horizontal offset
	pha
copyscore:
	pla
	sta	$1b00,y
	pha
	lda	#$10		; vertical offset
	sta	$1b01,y
	lda	#$40

	ldx	Scoreoffset	; get the digit offset
	rep	#$30
	lda	Scoredigit1,x	; get the digit
	and	#$00ff
	tax
	sep	#$20
	sta	Scorehi		; temporary storage
	lda	Scorelo		; should we print the zeros?
	bne	Scorenozero
	lda	Scorehi		; in case of zero, skip!
	beq	Skipscorezero
Scorenozero:

	lda	Scorespritenum,x ; get the sprite number of the digit
	sta	$1b02,y
	lda	#%00110010
	sta	$1b03,y
	inc	Scorelo		; enable zeros!
	pla
	clc
	adc	#$10		; space out the numbers
	pha
	bra	Skipscorezero2
Skipscorezero:
	lda	#$e0		; in case of zero, get rid of sprite
	sta	$1b01,y		; (put below screen)
Skipscorezero2:


	dec	Scoreoffset	; move offset to next digit
	iny
	iny
	iny
	iny
	cpy	#$0020
	bne	copyscore
	pla
	lda	Scorelo
	bne	Scoreconts
	ldy	#$0000
	lda	#$10
	sta	$1b00,y
	sta	$1b01,y		; in case the score is 00000000, print a zero
	lda	#$40
	sta	$1b02,y
	lda	#%00110010	;
	sta	$1b03,y

Scoreconts:

	lda	#%10101010
	sta	$1d00		; fix up the MSB and the size (16*16)
	sta	$1d01
	rts

Scorespritenum:
	dc.b	$40,$42,$44,$46,$48,$4a,$4c,$4e,$60,$62



;=========================================================================
;                            Add Ones to Score
;=========================================================================

Scoreone:
	rep	#$10
	sep	#$20			; add accum to one column
	clc
	adc	Scoredigit1
	cmp	#$0a
	bcs	Score1
	sta	Scoredigit1
	rts
Score1:
	sec
	sbc	#$0a
	sta	Scoredigit1
	inc	Scoredigit1+1
	lda	Scoredigit1+1		; inc tens column if overflow
	cmp	#$0a
	beq	Score2
	rts
Score2:
	stz	Scoredigit1+1

Score10cont:
	inc	Scoredigit3		; inc hundreds if overflow
	lda	Scoredigit3
	cmp	#$0a
	beq	Score3
	rts
Score3:
	stz	Scoredigit3

Score100cont:
	inc	Scoredigit3+1		; inc thousands if overflow
	lda	Scoredigit3+1
	cmp	#$0a
	beq	Score4
	rts
Score4:
	stz	Scoredigit3+1
Score1000cont:
	inc	Scoredigit5		; inc ten thousands
	lda	Scoredigit5
	cmp	#$0a
	beq	Score5
	rts
Score5:
	stz	Scoredigit5
	inc	Scoredigit5+1
	lda	Scoredigit5+1		; inc hundred thousands
	cmp	#$0a
	beq	Score6
	rts
Score6:
	stz	Scoredigit5+1
	inc	Scoredigit7		; increase millions
	lda	Scoredigit7
	cmp	#$0a
	beq	Score7
	rts
Score7:
	stz	Scoredigit7
	inc	Scoredigit7+1
	lda	Scoredigit7+1		; increase ten millions
	cmp	#$0a
	beq	Score8
	rts
Score8:
	ldx	#$0000
	stx	Scoredigit1
	stx	Scoredigit3		; TOTAL OVERFLOW!! past 99999999!
	stx	Scoredigit5
	stx	Scoredigit7
	rts


;=========================================================================
;                              Add Tens to Score
;=========================================================================
Scoreten:
	
	rep	#$10
	sep	#$20
	clc				; add Acc to tens
	adc	Scoredigit1+1
	cmp	#$0a
	bcs	Score9
	sta	Scoredigit1+1
	rts
Score9:
	sec
	sbc	#$0a
	sta	Scoredigit1+1
	jmp	!Score10cont
;=========================================================================
;                        Add Hundreds to Score
;=========================================================================

Scorehundred:
	
	rep	#$10
	sep	#$20			; add Acc to hundreds
	clc
	adc	Scoredigit3
	cmp	#$0a
	bcs	Score10
	sta	Scoredigit3
	rts
Score10:
	sec
	sbc	#$0a
	sta	Scoredigit3
	jmp	!Score100cont


;=========================================================================
;                              Add Thousands to Score
;=========================================================================

Scorethousand:
	rep	#$10
	sep	#$20
	clc				; add Acc to thousands
	adc	Scoredigit3+1
	cmp	#$0a
	bcs	Score11
	sta	Scoredigit3+1
	rts
Score11:
	sec
	sbc	#$0a
	sta	Scoredigit3+1
	jmp	!Score1000cont


;==========================================================================
;                   Health Counter Sprite Print Routine
;==========================================================================

Healthsprite:
	rep	#$30
	sep	#$20

	stz	healthlo		; 0 toggle (don't prints first zeros)
	stz	healthlo+1


	ldx	#$0003		; # of digits (0-7)
	stx	healthoffset
	rep	#$30

	ldy	#$000d		; sprite # for health
	tya
	asl a
	asl a
	tay
	sep	#$20
	
	lda	#$10		; Horizontal offset
	pha
copyhealth:
	pla
	sta	$1b00,y
	pha
	lda	#$c0		; vertical offset
	sta	$1b01,y

	ldx	healthoffset	; get the digit offset
	rep	#$30
	lda	healthdigit1,x	; get the digit
	and	#$00ff
	tax
	sep	#$20
	sta	healthhi		; temporary storage
	lda	healthlo		; should we print the zeros?
	bne	healthnozero
	lda	healthhi		; in case of zero, skip!
	beq	Skiphealthzero
healthnozero:

	lda	healthdigit7		; test if blink alert flag is on
	beq	healthnozero2
					; yes it is
	lda	healthdigit5		; get decrease timer
	and	#$0f			; only 16 bits
	cmp	#$07			; is it higher than 7?
	bcs	healthnozero2
	lda	#$0e
	bra	healthnozero3
healthnozero2:
	lda	Scorespritenum,x ; get the sprite number of the digit
	clc
	adc	#$40
healthnozero3:
	sta	$1b02,y
	lda	#%00110010
	sta	$1b03,y
	inc	healthlo		; enable zeros!
	pla
	clc
	adc	#$10		; space out the numbers
	pha
	bra	Skiphealthzero2
Skiphealthzero:
	lda	#$e0		; in case of zero, get rid of sprite
	sta	$1b01,y		; (put below screen)
Skiphealthzero2:


	dec	healthoffset	; move offset to next digit
	iny
	iny
	iny
	iny
	cpy	#$0044
	bne	copyhealth
	pla
	lda	healthlo
	bne	healthconts
	ldy	#$0034
	lda	#$10
	sta	$1b00,y
	lda	#$c0
	sta	$1b01,y		; in case the health is 0000, print a zero
	lda	#$80
	sta	$1b02,y
	lda	#%00110010	;
	sta	$1b03,y

healthconts:

	lda	$1d03
	and	#%00000011	;	fix up the MSB and the size (16*16)
	ora	#%10101000
	sta	$1d03
	lda	$1d04
	and	#%11111100
	ora	#%00000010
	sta	$1d04
	rts



;=========================================================================
;                            Add Ones to health
;=========================================================================

healthone:
	rep	#$10
	sep	#$20			; add accum to one column
	clc
	adc	healthdigit1
	cmp	#$0a
	bcs	health1
	sta	healthdigit1
	rts
health1:
	sec
	sbc	#$0a
	sta	healthdigit1
	inc	healthdigit1+1
	lda	healthdigit1+1		; inc tens column if overflow
	cmp	#$0a
	beq	health2
	rts
health2:
	stz	healthdigit1+1

health10cont:
	inc	healthdigit3		; inc hundreds if overflow
	lda	healthdigit3
	cmp	#$0a
	beq	health3
	rts
health3:
	stz	healthdigit3

health100cont:
	inc	healthdigit3+1		; inc thousands if overflow
	lda	healthdigit3+1
	cmp	#$0a
	beq	health4
	rts
health4:
	lda	#$09
	sta	healthdigit1
	sta	healthdigit1+1
	sta	healthdigit3
	sta	healthdigit3+1

	rts


;=========================================================================
;                              Add Tens to health
;=========================================================================
healthten:
	
	rep	#$10
	sep	#$20
	clc				; add Acc to tens
	adc	healthdigit1+1
	cmp	#$0a
	bcs	health9
	sta	healthdigit1+1
	rts
health9:
	sec
	sbc	#$0a
	sta	healthdigit1+1
	jmp	!health10cont
;=========================================================================
;                        Add Hundreds to health
;=========================================================================

healthhundred:
	
	rep	#$10
	sep	#$20			; add Acc to hundreds
	clc
	adc	healthdigit3
	cmp	#$0a
	bcs	health10
	sta	healthdigit3
	rts
health10:
	sec
	sbc	#$0a
	sta	healthdigit3
	jmp	!health100cont


;=========================================================================
;                              Add Thousands to health
;=========================================================================

healththousand:
	rep	#$10
	sep	#$20
	clc				; add Acc to thousands
	adc	healthdigit3+1
	cmp	#$0a
	bcs	health11
	sta	healthdigit3+1
	rts
health11:
	sec
	sbc	#$0a
	sta	healthdigit3+1
	lda	#$09
	sta	healthdigit1
	sta	healthdigit1+1
	sta	healthdigit3
	sta	healthdigit3+1
	rts










;=========================================================================
;		    Joybuttons Flag routine for jump and fire
;=========================================================================
Joybuttons:
	sep	#$20
	lda	joypaddata+1		; read $4219
	bit	#$80			; check the B button
	bne	JoyJumpB
	ldx	#$00
	stx	Joybounceone
	bit	#$40
	bne	JoyFireA
	rts
JoyJumpB:
	lda	Joybounceone
	beq	JoyJumpB2
	bra	JoyJumpBend
JoyJumpB2:
	
	lda	JumpFallflag		; is Main Sprite already falling?
	bne	JoyJumpBend
	lda	Fallflag		; is main sprite falling without first jumping?
	bne	JoyJumpBend
	lda	Jumpflag		; is jump currently in progress?
	bne	JoyJumpBend
	lda	#$01
	sta	Joybounceone
	lda	#$01			; no, set the jump flag
	sta	Jumpflag
	stz	HeadFallflag		; make it ok to check for head collision check
	stz	Fallflag		; no fall!
	stz	Jumphalftest		; half height jump (2 blocks/32 lines)
	lda	#$01
	sta	JumpFallflag		; sprite is already in motion
JoyJumpBend:
	lda     joypaddata+1
	bit     #$40
	bne     JoyFireA
	rts
JoyFireA:



;==============================================================================
;                            Ball and Chain routine
;==============================================================================

	rep	#$30
	sep	#$20
	lda	Fireonflag	; if link weapon is in motion then skip
	bne	Fireend		; set up
	lda	#$01
	sta	Fireonflag	; link weapon is use
	ldx	#$0000
	stx	Firedistance	; clear distance


	rep	#$30
	sep	#$20

	ldx	#$0090		
	stx	FireHoriz
	ldx	#$0048		; 00;48 = right 90;48 = left
	stx	FireVert


	lda	MainFlip
	bit	#$40
	bne	Fireend		; firgure which way main sprite is facing (left/right)

	ldx	#$0000
	stx	FireHoriz


Fireend:
	rts



;=========================================================================
;                      Sprite Main Character Anim/Movement
;=========================================================================

MainSprite:

	sep	#$20

	lda	Jumpflag	; is jump in progress?
	beq	NoMainJump
	rep	#$10
	ldx	Jumpoffset
	lda	MainV		; get original  Sprite V position
	sta	Storage
	sec
	sbc	Jumpsine,x	; subtract with jump height value
	sta	MainV		; store it in Main V position
	sta	Storage2
	cmp	#$21
	bcc	Jumptestok
	cmp	#$e0
	bcc	Jumptestok

	lda	Storage
	cmp	#$21
	bcs	Jumptestok

	rep	#$20
	lda	Plane0Y
	;and	#$01f0
	cmp	#$01ff
	bcc	Jumptestok
	sep	#$20
	lda	#$01
	sta	MainV
	stz     Jumpflag        ; yes! stop jump    
	stz     Jumpoffset      ; reset jump offset!
	sta	Fallflag
	stz	JumpFallflag
Jumptestok:
	sep	#$20
	;jsr	JumpUp		; do Plane 0 Up routine

	inc	Jumpoffset	; increase jump offset
	lda	Jumpoffset
	cmp	#39	;44		;25
	beq	Jumpended
	cmp	#31
	beq	JumpFallcheck

	cmp	#10
	bcc	Jumpfull
	cmp	#21
	bcs	Jumpfull

	lda	joypaddata+1
	and	#$80
	beq	Jumphalfcheck

	;lda	Jumphalftest
	;bne	Jumpfull

	;lda	Jumpoffset
	;cmp	#$15
	;beq	Jumphalfcheck
Jumpfull:
	;lda	Jumpoffset
	;cmp	#35	;23	; did it hit the peak? if so, make fall detect on!
	;beq	JumpFallcheck
	;cmp	#69	;45		; did it reach the end?
	;beq	Jumpended
	;cmp	#85
	;beq	Jumpended
	bra	NoMainJump

Jumphalfcheck:

	lda	#21
	sta	Jumpoffset
	bra	NoMainJump
	;lda	joypaddata+1
	;and	#$80
	;beq	Jumphalffix
	;lda	#$01
	;sta	Jumphalftest
	;bra	Jumpfull
Jumphalffix:
	;lda	#70
	;sta	Jumpoffset
	;bra	JumpFallcheck





Jumpended:
	rep	#$30
	stz	Jumpflag	; yes! stop jump
	stz	Jumpoffset	; reset jump offset!
JumpFallcheck:
	sep	#$20
	lda	#$01
	sta	Fallflag	; ok to fall
	stz	JumpFallflag	; not in motion jump/fall motion
	

NoMainJump:
	sep	#$20
	lda	Fireonflag
	bne	Fireon
	jmp	!NoFireon
Fireon:



	sep	#$20
	lda	#$90
	sta	$1d20		; 16*16, enabled, type 0
	
	lda	#$80		; 8*8, enabled, type 0
	sta	$1d23
	sta	$1d26
	sta	$1d29
	sta	$1d2c
	sta	$1d2f
	sta	$1d32
	sta	$1d35


	rep	#$30
	lda	#0115		; sprite #
	asl a
	asl a
	tay			; sprite data position
	rep	#$10
	sep	#$20
	rep	#$30
	ldx	Firedistance	; sine offset
	txa
	clc
	adc	FireHoriz	; add fire horiz to change ball swing
	tax
	sep	#$20
	lda	Firesine,x	; read sine data
	sec
	sbc	#48		; center it
	sta	Storage
	lda	MainH		;original MainH position
	clc
	adc	Storage
	sta	BallH
	sta	$1b00,y
	;clc
	;adc	#$08
	sta	Firestore2	; store the Ball's H position







	rep	#$30
	ldx	Firedistance	; get sine offset
	txa
	clc
	adc	FireVert	; add to change ball swing
	tax
	sep	#$20
	lda	Firesine,x	; read sine data
	sec
	sbc	#$38		; center it
	sta	Storage

	lda	MainV		; V pos
	clc
	adc	Storage
	clc
	adc	#$08
	sta	BallV
	sta	$1b01,y
	clc
	adc	#$08
	sta	Firestore
	lda	#$0c		; char number
	sta	$1b02,y
	lda	#$20		; sprite priority
	sta	$1b03,y		; pallete.. junk

	lda	$1d1c
	and	#%10111111
	ora	#$80
	sta	$1d1c		; sprite size for ball is 16*16
	stz	$1d1d

	lda	MainH
	cmp	#$30
	bcs	Firestore2noprob

	lda	Firestore2
	clc
	adc	#48
	bcc	Firestore2noprob
	lda	#$01
	sta	Firestore2
	lda	#$02
	sta	$1b00,y
	sta	BallH

Firestore2noprob:

	lda	MainH
	cmp	#$a0
	bcc	Firestore2noprob2

	lda	Firestore2
	sec
	sbc	#48
	bcs	Firestore2noprob2	
	lda	#$f0
	sta	Firestore2
	lda	#$f0
	sta	$1b00,y
	sta	BallH
Firestore2noprob2:

	lda	MainV
	cmp	#$40
	bcs	Firestore2noprob3

	lda	Firestore
	clc
	adc	#$50
	bcc	Firestore2noprob3

	lda	#$1b
	sta	Firestore
	sta	BallV
	lda	#$01
	sta	$1b01,y


Firestore2noprob3:
	

	lda	$1b00,y
	sta	$1d21		; store H pos in Weapon data
	lda	$1b01,y
	sta	$1d22		; Store V pos in weapon data


	lda	Firestore2
	sec
	sbc	MainH
	inc a
	lsr a
	lsr a
	lsr a
	sta	Firechaindistance



	lda	MainH
	cmp	Firestore2
	bcc	NoNegH
	beq	NoNegH

	lda	MainH
	sec
	sbc	Firestore2
	lsr a
	lsr a
	lsr a
	eor	#$ff
	sta	Firechaindistance


NoNegH:

	lda	Firestore
	cmp	#$1b
	bcs	FireV10high
	lda	#$1b
	sta	Firestore
FireV10high:
	lda	Firestore
	cmp	#$e0
	bcc	FireVF0low
	lda	#$1b
	sta	Firestore
FireVF0low:



	lda	MainV
	clc
	adc	#$0b
	sec	
	sbc	Firestore
	clc
	adc	#$10
	lsr a
	lsr a
	lsr a
	sta	FirechaindistanceV




	lda	Firestore
	sec
	sbc	#$1b
	cmp	MainV
	bcc	NoNegV
	beq	NoNegV

	lda	Firestore
	sec
	sbc	MainV
	sec
	sbc	#$1b
	lsr a
	lsr a
	lsr a
	eor	#$ff
	sta	FirechaindistanceV


NoNegV:


	ldy	#$0001
	sty	Firechainsprite		; sprite #
	
	lda	#$00
	sta	Firechaindisplacement   ; reset displacements
	sta	FirechaindisplacementV
	ldx	#$0003			; weapon data offset

Makefirechain:
	rep	#$30
	ldy	Firechainsprite		; get sprite #
	tya
	clc
	adc	#115			; sprite number is now 116
	asl a				; multiply with 4 to get OAM address
	asl a
	tay
	sep	#$20




	lda	MainH			; get Main Sprite's H pos
	clc
	adc	Firechaindisplacement	; add with chain link displacent
	clc
	adc	#$04			; start of chain from hand H pos
	sta	$1b00,y
	sta	$1d21,x			; store weapon H position


	lda	MainV
	clc
	adc	#$0f			; start of chain fron hand V pos
	clc
	adc	FirechaindisplacementV  ; add with chain link V displacement


	sta	$1b01,y

	sta	$1d22,x			; store weapon V position	
	inx
	inx
	inx

	lda	#$2c
	sta	$1b02,y
	lda	#%00100000		; sprite priority
	sta	$1b03,y


	lda	Firechaindisplacement
	clc
	adc	Firechaindistance	; calculate the displacement by adding
	sta	Firechaindisplacement	; the distance dividened 

	lda	FirechaindisplacementV
	sec
	sbc	FirechaindistanceV	; the same, but for Vertical
	sta	FirechaindisplacementV

	inc	Firechainsprite		; increase to make next chain link
	lda	Firechainsprite		; 
	cmp	#$08			; 8 chains pieces
	bne	Makefirechain



	inc	Firedistance		; increase sine offset to make ball
	inc	Firedistance		; circulate
	inc	Firedistance
	lda	Firedistance		; twice for faster speed
	cmp	#96
	bcc	NoFireon

Turnoffballchain:
	rep	#$30
	lda	#0115
	tax
	asl a
	asl a
	tay
	sep	#$20
turnoffballsprite
	lda	#$00
	sta	$1b00,y		; put ball off screen
	sta	BallH
	lda	#$f0
	sta	$1b01,y
	sta	BallV
	iny
	iny
	iny
	iny
	inx
	cpx	#124
	bne	turnoffballsprite

	ldx	#%00000010	; ball is 16*16
	stx	$1d1c
	ldx	#$0000
	stx	$1d1d
	ldx	#$ffff
	inx
	stx	Firedistance
	stz	Fireonflag		; turn off weapon
	stz	$1d20
	stz	$1d23
	stz	$1d26
	stz	$1d29			; Link weapon OFF
	stz	$1d2c
	stz	$1d2f
	stz	$1d32
	stz	$1d35

NoFireon:
	jsr	!Headsup		; did the Main Sprite hit something above?
	jsr	!MainFall	; Do Main Sprite Fall routine
	jsr	!MainFall
	jsr	!MainFall
	jsr	!MainFall
	jsr	!JumpUp		; during jump, calculate screen movement
	rep	#$30
	ldy	#124		 ;sprite # for main sprite
	tya
	asl a
	asl a
	tay
	lda	MainV
	and	#$00ff
	sta	MainV

	lda	MainH
	and	#$00ff
	sta	MainH

	sep	#$20
	lda	$1d1f
	and	#%10101010
	ora	#%10101010
	sta	$1d1f

	lda	MainH
	sec
	sbc	#$08
	sta	$1b00,y		; store his X value here!
	sta	$1b04,y		; store his X value here!
	clc
	adc	#$10
	sta	$1b08,y
	sta	$1b0c,y

	lda	MainV
	sta	$1b01,y		; store his V value here
	sta	$1b09,y
	clc
	adc	#$10
	sta	$1b05,y		; store his V value here
	sta	$1b0d,y
	rep	#$30
	;tax
	;lda	#125			; sprite #
	;asl a
	;asl a
	;tay
	
	sep	#$20
	;lda	MainAnimFrames,x	; get frame number
	;asl a			; double it for sprite number


	lda	MainFlip
	beq	Nomainflip1

	lda	#$02		; sprite character #$00
	sta	$1b02,y		; store in sprite data area
	dec a
	dec a
	sta	$1b0a,y

	lda	#$22		; get the bottom sprite number
	sta	$1b06,y
	dec a
	dec a
	sta	$1b0e,y	
	bra	Nomainflip2
Nomainflip1:

	lda	#$00		; sprite character #$00
	sta	$1b02,y		; store in sprite data area
	inc a
	inc a
	sta	$1b0a,y

	lda	#$20		; get the bottom sprite number
	sta	$1b06,y
	inc a
	inc a
	sta	$1b0e,y	

Nomainflip2:

	lda	MainFlip	; get X flip for Main Sprite Frame
	ora	#$20		; priority!	
	sta	$1b03,y
	sta	$1b0b,y
	sta	$1b07,y
	sta	$1b0f,y
	rts
MainAnimFrames:
	
	dc.b	0,0,0,0,0,0,0,0
	dc.b	1,1,1,1,1,1,1,1
	dc.b	2,2,2,2,2,2,2,2
	dc.b	3,3,3,3,3,3,3,3
	dc.b	4,4,4,4,4,4,4,4
	dc.b	5,5,5,5,5,5,5,5
	dc.b	5,5,5,5,5,5,5,5
	dc.b	0,0,0,0,0,0,0,0
Jumpsine:
	
	dc.b	4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3
	dc.b	3,3,3		; #20
	dc.b	2,2,2,1,1,0,0,0,0

	dc.b	3,3,2,2,2,1,1,1
	dc.b	-1,-1,-2,-2,-2,-3,-3,-3


	dc.b	0,1,2,1,2,2,3,2,3,4,3,3,3,4,3,3,3,3,2,3,2,3
	dc.b	2,2,1,2,1,0,1,0,0,0,0,0,0,0,0,0,0,$ff,0
	dc.b	-1,-2,-1,-2,-2,-3,-2,-3,-2,-3,-3,-3,-3,-4,-3,-3,-3,-2,-3,-2
	dc.b	-3,-2,-2,-3,-2,-1,0,0,0

	dc.b	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	;dc.b	3,4,3,4,4,3,4,3,3,3,2,3,2,2,1,2,1,0,0,0,0,0,0,0,0
	;dc.b	4,4
	;dc.b	3,2,3,2,3,3,3,3,4,3,3,3,4,3,2,3,2,2,1,2,1,0




Firesine:
	
 ;dc.b  20,23,26,29,32,34,36,38,39,40,40,40,39,38,36,34,32,29,26,23
 ;dc.b  20,17,14,11,8,6,4,2,1,0,0,0,1,2,4,6,8,11,14,17

	;dc.b	0,0,1,2,4,6,8,11,14,17
	;dc.b	20,23,26,29,32,34,36,38,39
	;dc.b	40,40,40,39,38,36,34,32,29,26,23
	;dc.b	20,17,14,11,8,6,4,2,1,0

	;dc.b	0,1,1,2,2,2,3,3,3,3,3,3,3,3,2,2,2,1,1,0,0,$ff,$ff,$fe,$fe,$fe,$fd	;27
	;dc.b	$fd,$fd,$fd,$fd,$fd,$fd,$fd,$fe,$fe,$fe,$ff,$ff,0



 ;dc.b  48,51,54,57,60,63,66,69,72,75,77,80,82,84,86,88,90,91,92,93
 ;dc.b  94,95,96,96,96,96,96,95,94,93,92,91,90,88,86,84,82,80,77,75
 ;dc.b  72,69,66,63,60,57,54,51,48,45,42,39,36,33,30,27,24,21,19,16
 ;dc.b  14,12,10,8,6,5,4,3,2,1,0,0,0,0,0,1,2,3,4,5,6,8,10,12,14,16
 ;dc.b  19,21,24,27,30,33,36,39,42,45

	dc.b	0,0,1,2,3,4,5,6,8,10,12,14,16
	dc.b	19,21,24,27,30,33,36,39,42,45
	dc.b	48,51,54,57,60,63,66,69,72,75,77
	dc.b	80,82,84,86,88,90,91,92,93
	dc.b	94,95,96,96,96,96,96,95,94,93,92
	dc.b	91,90,88,86,84,82,80,77,75
	dc.b	72,69,66,63,60,57,54,51,48,45
	dc.b	42,39,36,33,30,27,24,21,19,16
	dc.b	14,12,10,8,6,5,4,3,2,1,0,0,0


	dc.b	0,0,1,2,3,4,5,6,8,10,12,14,16
	dc.b	19,21,24,27,30,33,36,39,42,45
	dc.b	48,51,54,57,60,63,66,69,72,75,77
	dc.b	80,82,84,86,88,90,91,92,93
	dc.b	94,95,96,96,96,96,96,95,94,93,92
	dc.b	91,90,88,86,84,82,80,77,75
	dc.b	72,69,66,63,60,57,54,51,48,45
	dc.b	42,39,36,33,30,27,24,21,19,16
	dc.b	14,12,10,8,6,5,4,3,2,1,0,0,0


	dc.b	0,0,1,2,3,4,5,6,8,10,12,14,16
	dc.b	19,21,24,27,30,33,36,39,42,45
	dc.b	48,51,54,57,60,63,66,69,72,75,77
	dc.b	80,82,84,86,88,90,91,92,93
	dc.b	94,95,96,96,96,96,96,95,94,93,92
	dc.b	91,90,88,86,84,82,80,77,75
	dc.b	72,69,66,63,60,57,54,51,48,45
	dc.b	42,39,36,33,30,27,24,21,19,16
	dc.b	14,12,10,8,6,5,4,3,2,1,0,0,0



MainFall:
	sep	#$20
	lda	JumpFallflag
	beq	Mainfall1	  	; is main sprite in motion (jumping?)
	rts				; 1 = yes
Mainfall1:

	
	rep	#$30
	lda	Plane0X
	and	#$000f
	sta	Storage4
	lda	MainH
	clc
	adc	Storage4
	inc a
	;clc	
	;adc	#$01			; right most of object
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage
	lda	column_map_offset
	sec				; test if Main Sprite has landed on
	sbc	#$001f			; on the right side of a Stop object
	clc
	adc	Storage
	sta	Storage

	lda	Plane0Y
	clc
	adc	MainV
	clc
	adc	#$0021		;21	; 1 line below sprite to see if
					; there's an object
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage2

	sep	#$20
	lda	Storage2
	sta	$4202

	lda	MapX
	sta	$4203
	nop
	nop
	nop
	nop
	;nop
	;nop
	;nop
	;nop
	rep	#$30
	lda	$4216
	
	clc
	adc	Storage
	sta	Storage3

	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax	
	sep	#$20
	lda	MapAt,x		; get Tile attribute info
	rep	#$30
	and	#$00ff
	tax
	sep	#$20
	lda	MapAttribute,x  ; 0 = FALL, 1= Stop Object
	;cmp	#$00
	beq	FallDowncont
	jmp	!FallDownEnd



FallDowncont:

	rep	#$30
	lda	Plane0X
	and	#$000f
	sta	Storage4
	lda	MainH
	clc
	adc	Storage4
	dec a
	;clc	
	;adc	#$00			; left most of object
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage
	lda	column_map_offset
	sec
	sbc	#$001e
	clc
	adc	Storage
	sta	Storage

	lda	Plane0Y
	clc
	adc	MainV
	clc
	adc	#$0021

	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage2

	sep	#$20
	lda	Storage2
	sta	$4202

	lda	MapX
	sta	$4203
	nop
	nop
	nop
	nop
	;nop
	;nop
	;nop
	;nop
	rep	#$30
	lda	$4216
	
	clc
	adc	Storage
	sta	Storage3

	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax	
	sep	#$20
	lda	MapAt,x		; get Tile attribute info
	rep	#$30
	and	#$00ff
	tax
	sep	#$20
	lda	MapAttribute,x
	;cmp	#$00
	beq	FallDownmove
	bra	FallDownEnd2


FallDownmove:



	sep	#$20
	lda	#$01
	sta	Fallflag		; set fall flag to tell other routines
	lda	MainV			; that it is falling
	cmp	#$a0			; 
	bcs	FallMovePlane0Down
	inc	MainV			; test if the Main Sprite is past #$a0
	;inc	MainV			; V pos, then increase twice
	;inc	MainV


Falldowntheend:
	sep	#$20

	rts
FallMovePlane0Down:
	lda	#$a0
	sta	MainV
	rep	#$30
	lda	Plane0Y		; Get Plane 0 Y position 
	inc a
	;inc a			; move plane 0 3 lines up
	;inc a
	cmp	#$0120
	bcc	FallNoDownStop	; did it reach the bottom?
	stz	Fallflag
	lda	#$0120		; stop it from moving further!
FallNoDownStop:
	sta	Plane0Y		; store it!
	sep	#$20
	rts
FallDownEnd:
	
	rep     #$30                                
	stz     Jumpflag        ; yes! stop jump    
	stz     Jumpoffset      ; reset jump offset!





	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax
	lda	Map45at,x
	and	#$00ff
	asl a
	tax
	jmp	(Fall45routs,x)


FallDownEnd2:
	rep     #$30                                
	stz     Jumpflag        ; yes! stop jump    
	stz     Jumpoffset      ; reset jump offset!





	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax
	lda	Map45at,x
	and	#$00ff
	asl a
	tax
	jmp	(Fall45routs2,x)


Fall45routs:
	dcr.w	Fall450
	dcr.w	Fall451
	dcr.w	Fall450

Fall45routs2:
	dcr.w	Fall450
	dcr.w	Fall450
	dcr.w	Fall452

Fall450:
	jmp	!Falldownexit
Fall451:

	rep	#$30
	lda	Plane0Y
	clc
	adc	MainV
	and	#$000f


	;eor	#$0f
	sta	Storage
	lda	MainV
	and	#$fff0
	sta	Storage2

	lda	Plane0X
	clc
	adc	MainH
	;inc a
	and	#$000f
	sta	Storage3

	lda	Storage3
	cmp	Storage
	bne	Falldownexit2
Falldownexit:
	sep	#$20
	stz	Fallflag
	rts
Falldownexit2:
	jmp	!FallDownmove


Fall452:

	rep	#$30



	lda	Plane0Y
	clc
	adc	MainV
	and	#$000f


	eor	#$0f
	sta	Storage
	lda	MainV
	and	#$fff0
	sta	Storage2

	lda	Plane0X
	clc
	adc	MainH
	and	#$000f
	sta	Storage3

	lda	Storage3
	cmp	Storage
	bne	Falldownexit2
	jmp	!Falldownexit


;=============================================================================
;               Main Sprite hits bottom of object and falls back down
;=============================================================================

Headsup:
	
	sep	#$20
	lda	HeadFallflag
	beq	Headsup2
	rts
Headsup2:

	rep	#$30
	lda	Plane0X
	and	#$000f
	sta	Storage4
	lda	MainH
	clc
	adc	Storage4
	inc a
	;clc	
	;adc	#$01			; right most of object
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage
	lda	column_map_offset
	sec				; test if Main Sprite has landed on
	sbc	#$001f			; on the right side of a Stop object
	clc
	adc	Storage
	sta	Storage

	lda	Plane0Y
	clc
	adc	MainV
	inc a
	;clc
	;adc	#$0001		;21	; 1 line below sprite to see if
					; there's an object
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage2

	sep	#$20
	lda	Storage2
	sta	$4202

	lda	MapX
	sta	$4203
	nop
	nop
	nop
	nop
	;nop
	;nop
	;nop
	;nop
	rep	#$30
	lda	$4216
	
	clc
	adc	Storage
	sta	Storage3

	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax	
	sep	#$20
	lda	MapAt,x		; get Tile attribute info
	rep	#$30
	and	#$00ff
	tax
	sep	#$20
	lda	MapAttribute,x  ; 0 = FALL, 1= Stop Object
	;cmp	#$00
	beq	Headsupcont
	bra	HeadsupEnd



Headsupcont:

	rep	#$30
	lda	Plane0X
	and	#$000f
	sta	Storage4
	lda	MainH
	clc
	adc	Storage4
	dec a
	;dec a
	;clc	
	;adc	#$00			; left most of object
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage
	lda	column_map_offset
	sec
	sbc	#$001e
	clc
	adc	Storage
	sta	Storage

	lda	Plane0Y
	clc
	adc	MainV
	inc a
	;clc
	;adc	#$0001

	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage2

	sep	#$20
	lda	Storage2
	sta	$4202

	lda	MapX
	sta	$4203
	nop
	nop
	nop
	nop
	;nop
	;nop
	;nop
	;nop
	rep	#$30
	lda	$4216
	
	clc
	adc	Storage
	sta	Storage3

	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax	
	sep	#$20
	lda	MapAt,x		; get Tile attribute info
	rep	#$30
	and	#$00ff
	tax
	sep	#$20
	lda	MapAttribute,x
	;cmp	#$00
	beq	Headsupmove
	jmp	!HeadsupEnd
	rts

HeadsupEnd:
	rep     #$30 
	;stz     Jumpflag        ; yes! stop jump    
	;stz     Jumpoffset      ; reset jump offset!
	;lda	#$01
	;sta	Fallflag
	;stz	JumpFallflag
        lda	#26
	sta	Jumpoffset
	sta	HeadFallflag                 
	;sep	#$20
	;stz	$2121
	;stz	$2122
	;stz	$2122
	rts


Headsupmove:
	sep	#$20

	;stz	$2121
	;lda	#$11
	;sta	$2122
	;sta	$2122
	rts





;=========================================================================
;                    Screen Object Change (destroy boulder)
;=========================================================================

Objectchange:
	rep	#$30
	sep	#$20
	lda	#$80
	sta	$2115
	rep	#$30

	ldx	#$0000
copyobjectchange:
	lda	$1d50,x	
	bpl	Objectchangeend
	and	#$7fff
	sta	$2116
	lda	$1d52,x		; get the char to replace with
	sta	$2118
	inx
	inx
	inx
	inx
	cpx	#$0040
	bne	copyobjectchange

Objectchangeend:
	sep	#$20

	rts


;==========================================================================
;                      Test if Ball has hit a screen object (boulder)
;==========================================================================

Objectchangetester:
	
	rep	#$30
	stz	Weapontestoffset	; offset for weapon data pos
	stz	Weapontestcount		; counter for # of weaps to test
	stz	Weapontestchange	; offset for object change
	stz	Storage7
	stz	Storage8
Weapontestthis:
	ldx	Weapontestoffset
	sep	#$20
	lda	$1d20,x
	bmi	objchangetest3
	jsr	!Objectnothing


Weapontestthis2:
	lda	Weapontestcount
	cmp	#$10
	bne	Weapontestthis
	ldx	Weapontestchange
	stz	$1d51,x
	sep	#$20
	rts
objchangetest3:
	jsr	!objchangetest32
	bra	Weapontestthis2
	



objchangetest32:
	rep	#$30
	lda	Plane0X
	and	#$000f
	sta	Storage4
	ldx	Weapontestoffset
	lda	$1d21,x			; get weapon H pos
	and	#$00ff
	;sta	Storage7

	clc
	adc	Storage4
	clc	
	adc	#$08			; right most of object
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage
	sta	Storage5

	lda	column_map_offset
	sec
	sbc	#$001f
	clc
	adc	Storage
	sta	Storage

	lda	$1d22,x
	and	#$00ff
	clc
	adc	Plane0Y
	;lda	Plane0Y
	;clc
	;adc	$1d22,x		; add with weapon V pos
	clc
	adc	#$0008

	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage2
	sta	Storage6
	sep	#$20
	lda	Storage2
	sta	$4202

	lda	MapX
	sta	$4203
	nop
	nop
	nop
	nop
	rep	#$30
	lda	$4216
	
	clc
	adc	Storage
	sta	Storage3

	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax	
	sep	#$20
	lda	MapAt,x		; get Tile attribute info
	cmp	#$00
	beq	Objectnothing
	jmp	!Objecthit



	
	

Objectnothing2:
	sep	#$20
	inc	Weapontestchange
	inc	Weapontestchange
	inc	Weapontestchange
	inc	Weapontestchange
Objectnothing:
	sep	#$20		; touched nothing special...
	ldx	Weapontestoffset
	inx			; move to next weapon
	inx
	inx
	stx	Weapontestoffset

	inc	Weapontestcount ; increase counter
	

	rts


Objecthit:	


	sep	#$20
	sta	Storage		; store attribute
	stz	Storage+1
	rep	#$30
	stx	Storage2	; store attribute offset




	rep	#$30
	lda	Storage
	and	#$0003
	asl a
	tax
	jmp	(Objectchangerouts,x)

Objectchangerouts:
	dcr.w	Objectnothing
	dcr.w	Objectc1
	dcr.w	Objectnothing
	dcr.w	Objectnothing

Objectc1:

	rep	#$30
	ldx	Storage2
	sep	#$20
	lda	Mapobjat,x
	beq	Objectnothing

	sep	#$20
	lda	Storage6	; Y column pos
	sta	$4202

	lda	#$20		; multiply with screen width
	sta	$4203
	nop
	nop
	nop
	nop
	rep	#$30
	lda	Storage5
	and	#$001f
	sta	Storage5

	rep	#$30
	lda	Screen0Column
	clc
	adc	Storage5
	inc a
	and	#$001f
	sta	Storage5


	lda	$4216
	clc
	adc	Storage5
	clc			; 
	adc	#$5000
	ora	#$8000
	sta	ObjectchangeAdd	; VRAM address!

	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	inc a
	and	#$00ff
	asl a	; double it to read word
	tax	
	lda	Mapinfo,x	; get Tile info
	xba			; exchange bytes

	sta	Objectchangechar








	rep	#$30
	sep	#$20
	lda	#$05
	jsr	!Scoreone		; score 5 points

	ldx	Storage3		; read X comlumn offset
	lda	Map+8,x		; get X column byte
	inc a
	sta	Map+8,x

	rep	#$30
	ldx	Weapontestchange
	lda	ObjectchangeAdd
	sta	$1d50,x
	lda	Objectchangechar
	sta	$1d52,x
	sep	#$20
	jmp	!Objectnothing2






;=========================================================================
;                         Screen object Pick up write to Vram
;=========================================================================
Pickobjvram:
	sep	#$20
	lda	PickObjTest		; has the feet touched anything?
	bne	Pickupwork
	lda	PickObjTest2		; has the torso touched anything?
	bne	Pickupwork2
	rts
Pickupwork:
	lda	#$80
	sta	$2115
	rep	#$30
	stz	PickObjTest

	lda	PickObjAdd		; get object address
	sta	$2116
	lda	PickObjChar1		; get the char to replace with
	sta	$2118
	sep	#$20
	lda	PickObjTest2		; test if there's a second object
	beq	Pickupwork3
Pickupwork2:
	lda	#$80
	sta	$2115
	rep	#$30
	stz	PickObjTest2
	lda	PickObjAdd2
	sta	$2116
	lda	PickObjChar2
	sta	$2118
Pickupwork3:
	sep	#$20
	rts



;=========================================================================
;                       Screen Object Pick Up
;=========================================================================

Pickobjup:

	rep	#$30
	stz	PickObjHelp
	lda	Plane0X
	and	#$000f
	sta	Storage4
	lda	MainH
	clc
	adc	Storage4
	clc	
	adc	#$08			; right most of object
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage
	sta	Storage5

	lda	column_map_offset
	sec
	sbc	#$001f
	clc
	adc	Storage
	sta	Storage

	lda	Plane0Y
	clc
	adc	MainV
	clc
	adc	#$0018

	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage2
	sta	Storage6
	sep	#$20
	lda	Storage2
	sta	$4202

	lda	MapX
	sta	$4203
	nop
	nop
	nop
	nop
	;nop
	;nop
	;nop
	;nop
	rep	#$30
	lda	$4216
	
	clc
	adc	Storage
	sta	Storage3

	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax	
	sep	#$20
	lda	MapAt,x		; get Tile attribute info
	cmp	#$00
	beq	PickDownmove2
	jmp	!PickDownEnd



	
	



PickDownmove2:
	sep	#$20		; touched nothing special...
	stz	PickObjTest	; nothing to change on screen
	;stz	$2121
	;lda	#$ff
	;sta	$2122
	;sta	$2122
	rts
PickDownmove4:
	sep	#$20
	;stz	$2121
	;stz	$2122
	;stz	$2122
	rts

PickDownEnd:
	sep	#$20
	sta	Storage		; store attribute
	stz	Storage+1
	rep	#$30
	stx	Storage2	; store map offset


	sep	#$20
	lda	Storage6	; Y column pos
	sta	$4202

	lda	#$20		; multiply with screen width
	sta	$4203
	nop
	nop
	nop
	nop
	;nop
	;nop
	;nop
	;nop
	rep	#$30
	lda	Storage5
	and	#$001f
	sta	Storage5

	rep	#$30
	lda	Screen0Column
	clc
	adc	Storage5
	inc a
	and	#$001f
	sta	Storage5

Picktest:

	lda	$4216
	clc
	adc	Storage5
	clc			; 
	adc	#$5000
	sta	PickObjAdd	; VRAM address!
	lda	#$0001
	sta	PickObjTest
	lda	#$00
	sta	PickObjChar1

Pickuproutcalc:
	lda	Storage
	and	#$0003
	asl a
	tax
	jmp	(Pickuprouts,x)

Pickuprouts:
	dcr.w	Object0
	dcr.w	Object1
	dcr.w	Object2
	dcr.w	Object0

Object0:
	jmp	!PickDownmove2
Object1:
	jmp	!PickDownmove2
Object2:
	rep	#$30
	sep	#$20
	lda	#$05
	jsr	!Scoreten		; score 50 points

	lda	#$01
	jsr	!healthone

	ldx	Storage3		; read X comlumn offset
	lda	#$00
	sta	Map+8,x		; get X column byte
	jmp	!PickDownmove4



	


Pickobjup2:



	rep	#$30
	lda	Plane0X
	and	#$000f
	sta	Storage4
	lda	MainH
	clc
	adc	Storage4
	clc	
	adc	#$08			; right most of object
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage
	sta	Storage5

	lda	column_map_offset
	sec
	sbc	#$001f
	clc
	adc	Storage
	sta	Storage

	lda	Plane0Y
	clc
	adc	MainV
	clc
	adc	#$0008

	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage2
	sta	Storage6
	sep	#$20
	lda	Storage2
	sta	$4202

	lda	MapX
	sta	$4203
	nop
	nop
	nop
	nop
	;nop
	;nop
	;nop
	;nop
	rep	#$30
	lda	$4216
	
	clc
	adc	Storage
	sta	Storage3

	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax	
	sep	#$20
	lda	MapAt,x		; get Tile attribute info
	;cmp	#$00
	beq	PickDownmove22
	jmp	!PickDownEnd2



	
	



PickDownmove22:
	sep	#$20		; touched nothing special...
	stz	PickObjTest2	; nothing to change on screen
	rts

PickDownEnd2:


	sep	#$20
	sta	Storage		; store attribute
	stz	Storage+1
	rep	#$30
	stx	Storage2	; store map offset


	sep	#$20
	lda	Storage6	; Y column pos
	sta	$4202

	lda	#$20		; multiply with screen width
	sta	$4203
	nop
	nop
	nop
	nop
	rep	#$30
	lda	Storage5
	and	#$001f
	sta	Storage5

	rep	#$30
	lda	Screen0Column
	clc
	adc	Storage5
	inc a
	and	#$001f
	sta	Storage5


	lda	$4216
	clc
	adc	Storage5
	clc			; FIX ME MARC!!!!!!!!!!!!!!!!
	adc	#$5000
	sta	PickObjAdd2	; VRAM address!
	lda	#$0001
	sta	PickObjTest2
	lda	#$0000
	sta	PickObjChar2


	lda	Storage
	cmp	#$0002
	bne	PickDownmove22
	rep	#$30
	jmp	!Pickuproutcalc
	sep	#$20




;=========================================================================
;           Move screen 16 pixels after screen stops scrolling
;=========================================================================

Walkmovescreen:
	sep	#$20
	lda	Movescreentest		; test if moving or not
	beq	Walkmovescreen2
	rts
Walkmovescreen2:
	sep	#$20
	lda	Movescreentest2
	bne	Walkmovescreen3

	
	inc	Movescreentest
	rts
Walkmovescreen3:
	dec	Movescreentest2

	lda	Movescreentest3
	bne	WalkRight
	jmp	!WalkLeft
WalkRight:


	rep	#$30
	lda	column_map_offset	;read map column offset
	cmp	MapX		; compare with column length
	bne	MoveMSright3
	sep	#$20
	rts
MoveMSright3:
	rep	#$30
	lda	Scrollspeed
	asl a
	tax
	sep	#$20
	jmp	(Rightmoves2,x)


Rightmoves2:
	dcr.w	Rightslow2
	dcr.w	Rightmed3
	dcr.w	Rightfast2


Rightfast2:
	jsr	!Rightwalltest
	jmp	!Rightwalltest

Rightmed3:
	lda	SCROLLEOR
	eor	#$01
	sta	SCROLLEOR
	beq	Rightmed22
	jsr	!Rightwalltest
Rightmed22:
	
	jmp	!Rightwalltest

Rightslow2:
	jmp	!Rightwalltest





Rightwalltest:
	

	rep	#$30
	lda	Plane0X			; get Plane 0 X position
	and	#$000f			; get only 16 scroll bits
	sta	Storage4		; store it
	lda	MainH			; get Main Char Sprite X pos
	clc
	adc	Storage4		; add it with the Plane 0 x
	inc a
	lsr a
	lsr a
	lsr a				; divide by 16
	lsr a
	sta	Storage			; store it
	lda	column_map_offset	; get column tile offset (x)
	sec
	sbc	#$001e			; go full screen back
	clc
	adc	Storage			; add with storage
	sta	Storage			; store it again

	lda	Plane0Y			; get Plane 0 Y
	clc
	adc	MainV			; add with Main Char V pos
	clc
	adc	#$0020			; add 8 to center coordinate
	lsr a
	lsr a
	lsr a				; divide by 16
	lsr a
	sta	Storage2		; store it

	sep	#$20
	lda	Storage2		; get Y coordinate
	sta	$4202

	lda	MapX			; multiply by Map X length
	sta	$4203
	nop
	nop
	nop
	nop
	;nop				; wait 8 cycles
	;nop
	;nop
	;nop
	rep	#$30
	lda	$4216			; read value
	
	clc
	adc	Storage			; add it with X pos to get Screen Coord
	sta	Storage3

	ldx	Storage3		; read Map offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	;asl a			; double it to read word
	tax	
	sep	#$20
	lda	MapAt,x	; get Tile info
	;xba			; exchange bytes
	rep	#$30
	and	#$00ff
	tax
	sep	#$20
	lda	MapAttribute,x
	cmp	#$01		; is it tile 2?
	beq	Rightwalltestend







	rep	#$30

	lda	Plane0Y			; get Plane 0 Y
	clc
	adc	MainV			; add with Main Char V pos

	clc
	adc	#$10
	lsr a
	lsr a
	lsr a				; divide by 16
	lsr a
	sta	Storage2		; store it

	sep	#$20
	lda	Storage2		; get Y coordinate
	sta	$4202

	lda	MapX			; multiply by Map X length
	sta	$4203
	nop
	nop
	nop
	nop
	;nop				; wait 8 cycles
	;nop
	;nop
	;nop
	rep	#$30
	lda	$4216			; read value
	
	clc
	adc	Storage			; add it with X pos to get Screen Coord
	sta	Storage3

	ldx	Storage3		; read Map offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	;asl a			; double it to read word
	tax	
	sep	#$20
	lda	MapAt,x	; get Tile info
	;xba			; exchange bytes
	rep	#$30
	and	#$00ff
	tax
	sep	#$20
	lda	MapAttribute,x
	cmp	#$01		; is it tile 2?
	beq	Rightwalltestend
	lda	Jumpflag
	bne	rightit5
	lda	Fallflag
	bne	rightit5
	dec	MainH
rightit5:
	jmp	!MoveMSright2

Rightwalltestend:
	sep	#$20
	rts




WalkLeft:



	rep	#$30
	lda	column_map_offset	;read map column offset
	sec
	sbc	#$20			; check to see if it's at the begining
	bne	MoveMSleft4
	sep	#$20
	rts
MoveMSleft4:
	rep	#$30
	lda	Scrollspeed
	asl a
	tax
	sep	#$20
	jmp	(Leftmoves2,x)


Leftmoves2:
	dcr.w	Leftslow2
	dcr.w	Leftmed3
	dcr.w	Leftfast2


Leftfast2:
	jsr	!Leftwalltest
	jmp	!Leftwalltest

Leftmed3:
	lda	SCROLLEOR
	eor	#$01
	sta	SCROLLEOR
	beq	Leftmed22
Leftit2:
	jsr	!Leftwalltest
Leftmed22:
	jmp	!Leftwalltest

Leftslow2:
	jmp	!Leftwalltest
	


Leftwalltest:


	rep	#$30
	lda	Plane0X
	and	#$000f
	sta	Storage4
	lda	MainH
	clc
	adc	Storage4
	dec a
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage
	lda	column_map_offset
	sec
	sbc	#$001f
	clc
	adc	Storage
	sta	Storage

	lda	Plane0Y
	clc
	adc	MainV
	clc
	adc	#$0020
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage2

	sep	#$20
	lda	Storage2
	sta	$4202

	lda	MapX
	sta	$4203
	nop
	nop
	nop
	nop
	;nop
	;nop
	;nop
	;nop
	rep	#$30
	lda	$4216
	
	clc
	adc	Storage
	sta	Storage3

	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax	
	sep	#$20
	lda	MapAt,x		; get Tile attribute info
	rep	#$30
	and	#$00ff
	tax
	sep	#$20
	lda	MapAttribute,x
	
	cmp	#$01
	beq	LefttestEnd


	rep	#$30

	lda	Plane0Y
	clc
	adc	MainV
	clc
	adc	#$10
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage2

	sep	#$20
	lda	Storage2
	sta	$4202

	lda	MapX
	sta	$4203
	nop
	nop
	nop
	nop
	;nop
	;nop
	;nop
	;nop
	rep	#$30
	lda	$4216
	
	clc
	adc	Storage
	sta	Storage3

	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax	
	sep	#$20
	lda	MapAt,x		; get Tile attribute info
	rep	#$30
	and	#$00ff
	tax
	sep	#$20
	lda	MapAttribute,x
	
	cmp	#$01
	beq	LefttestEnd

	lda	Jumpflag
	bne	Leftit5
	lda	Fallflag
	bne	Leftit5
	inc	MainH
Leftit5:
	jmp	!MoveMSleft3
LefttestEnd:
	sep	#$20
	rts

;=========================================================================
;                            Joypad!
;=========================================================================

gJoypad:
	;sep	#$20
	lda	$4212
	and	#$01
	bne	gJoypad

	rep	#$20
	lda	$4218
	sta	joypaddata
	sep	#$20
	rts
Walkmove:
	sep	#$20

	lda	joypaddata+1	; read high byte (4219)
	lsr a
	bcs	JoyRight
	lsr a
	bcs	JoyLeft
	lsr a
	;bcs	JoyDown
	lsr a
	;bcs	JoyUp
	lda	#$00
	sta	Movescreentest
	rts	

JoyRight:	jmp	!MainSpriteRight
JoyLeft:	jmp	!MainSpriteLeft
JoyDown:	jmp	!Down
JoyUp:		jmp	!Up


MainSpriteLeft:
	rep	#$30
	lda	Scrollspeed
	asl a
	tax
	sep	#$20
	lda	#$01
	sta	Movescreentest
	stz	Movescreentest3
	jmp	(Leftmoves,x)


Leftmoves:
	dcr.w	Leftslow
	dcr.w	Leftmed
	dcr.w	Leftfast


Leftfast:
	jsr	!Left
	jmp	!Left

Leftmed:
	lda	SCROLLEOR
	eor	#$01
	sta	SCROLLEOR
	beq	Leftmed2
	jsr	!Left
Leftmed2:
	jmp	!Left

Leftslow:
	jmp	!Left


MainSpriteRight:

	rep	#$30

	lda	Scrollspeed
	asl a
	tax
	sep	#$20
	lda	#$01
	sta	Movescreentest
	sta	Movescreentest3
	jmp	(Rightmoves,x)


Rightmoves:
	dcr.w	Rightslow
	dcr.w	Rightmed
	dcr.w	Rightfast


Rightfast:
	jsr	!Right
	jmp	!Right

Rightmed:
	lda	SCROLLEOR
	eor	#$01
	sta	SCROLLEOR
	beq	Rightmed2
	jsr	!Right
Rightmed2:
	Jmp	!Right	
Rightslow:
	jmp	!Right









Right:
	

	rep	#$30
	lda	Plane0X			; get Plane 0 X position
	and	#$000f			; get only 16 scroll bits
	sta	Storage4		; store it
	lda	MainH			; get Main Char Sprite X pos
	clc
	adc	Storage4		; add it with the Plane 0 x
	;inc a
	lsr a
	lsr a
	lsr a				; divide by 16
	lsr a
	sta	Storage			; store it
	lda	column_map_offset	; get column tile offset (x)
	sec
	sbc	#$001e			; go full screen back
	clc
	adc	Storage			; add with storage
	sta	Storage			; store it again

	lda	Plane0Y			; get Plane 0 Y
	clc
	adc	MainV			; add with Main Char V pos
	clc
	adc	#$0020			; add 8 to center coordinate
	lsr a
	lsr a
	lsr a				; divide by 16
	lsr a
	sta	Storage2		; store it

	sep	#$20
	lda	Storage2		; get Y coordinate
	sta	$4202

	lda	MapX			; multiply by Map X length
	sta	$4203
	nop
	nop
	nop
	nop
	;nop				; wait 8 cycles
	;nop
	;nop
	;nop
	rep	#$30
	lda	$4216			; read value
	
	clc
	adc	Storage			; add it with X pos to get Screen Coord
	sta	Storage3

	ldx	Storage3		; read Map offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	;asl a			; double it to read word
	tax	
	sep	#$20
	lda	MapAt,x	; get Tile info
	;xba			; exchange bytes
	rep	#$30
	and	#$00ff
	tax
	sep	#$20
	lda	MapAttribute,x
	cmp     #$01
        bne     Rightpassone
        jmp     !RightEnd2
Rightpassone:






	rep	#$30

	lda	Plane0Y			; get Plane 0 Y
	clc
	adc	MainV			; add with Main Char V pos

	clc
	adc	#$10
	lsr a
	lsr a
	lsr a				; divide by 16
	lsr a
	sta	Storage2		; store it

	sep	#$20
	lda	Storage2		; get Y coordinate
	sta	$4202

	lda	MapX			; multiply by Map X length
	sta	$4203
	nop
	nop
	nop
	nop
	;nop				; wait 8 cycles
	;nop
	;nop
	;nop
	rep	#$30
	lda	$4216			; read value
	
	clc
	adc	Storage			; add it with X pos to get Screen Coord
	sta	Storage3

	ldx	Storage3		; read Map offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	;asl a			; double it to read word
	tax	
	sep	#$20
	lda	MapAt,x	; get Tile info
	;xba			; exchange bytes
	rep	#$30
	and	#$00ff
	tax
	sep	#$20
	lda	MapAttribute,x
	cmp	#$01		; is it tile 2?
	beq	RightEnd




Rightaniminc:

	sep	#$20
	stz	MainFlip	; No X flip for Main Character


;lda     #$01                                             
;sta     Fallflag        ; ok to fall                     
;stz     JumpFallflag    ; not in motion jump/fall motion

	lda	JumpFallflag
	bne	Rightcheck
	lda	Fallflag
	bne	Rightcheck	


	inc	MainAnim	; increase Main sprite frame #
	bra	Rightcheck2

Rightcheck:
	lda	#15



	sta	MainAnim		; frame that looks like jumping?!

Rightcheck2:
	lda	MainH		; read Main Char X position
	cmp	#$a0		; did Main Sprite reach right part screen?
	bcs	Rightstart
	inc	MainH		; increase Main sprite X position
RightEnd:
	sep	#$20
	rts


Rightstart:


	rep	#$30
	lda	column_map_offset	;read map column offset
	cmp	MapX		; compare with column length
	bne	MoveMSright
	sep	#$20
	lda	MainH
	cmp	#$e0
	bcs	Rightagain
	inc	MainH
Rightagain:
	rts

RightEnd2:

	
	rep	#$30
	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax
	lda	Map45at,x
	and	#$00ff
	beq	RightEnd
	jsr	!Up
	sep	#$20
	jmp	!Rightaniminc


MoveMSright
	sep	#$20
	lda	#$06
	sta	Movescreentest2	; distance to move
MoveMSright2:
	rep	#$30
	lda	Plane0X		; get Plane 0 X position
	inc a			; increase
	and	#$03ff
	sta	Plane0X		; store it
	and	#$000f		; did it pass 16 pixels?
	beq	scrollright

	jmp	!Scrollright2

scrollright:
	jsr	!scrollmapright ; yes! scroll map and read new map tiles
Scrollright2:
	rep	#$30

	lda	backmapeor
	eor	#$0001
	sta	backmapeor
	beq	Scrollright2end

	lda	Plane1X
	inc a
	and	#$03ff
	sta	Plane1X
	and	#$000f
	beq	scrollbackright
Scrollright2end:
	sep	#$20
	rts

scrollbackright:
	jmp	!scrollbackmapright

Left:


	rep	#$30
	lda	Plane0X
	and	#$000f
	sta	Storage4
	lda	MainH
	clc
	adc	Storage4
	;dec a
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage
	lda	column_map_offset
	sec
	sbc	#$001f
	clc
	adc	Storage
	sta	Storage

	lda	Plane0Y
	clc
	adc	MainV
	clc
	adc	#$0020
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage2

	sep	#$20
	lda	Storage2
	sta	$4202

	lda	MapX
	sta	$4203
	nop
	nop
	nop
	nop
	;nop
	;nop
	;nop
	;nop
	rep	#$30
	lda	$4216
	
	clc
	adc	Storage
	sta	Storage3

	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax	
	sep	#$20
	lda	MapAt,x		; get Tile attribute info
	rep	#$30
	and	#$00ff
	tax
	sep	#$20
	lda	MapAttribute,x
	
	cmp	#$01
	bne	Leftpassone
	jmp	!LeftEnd2
Leftpassone:
	rep	#$30

	lda	Plane0Y
	clc
	adc	MainV
	clc
	adc	#$10
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage2

	sep	#$20
	lda	Storage2
	sta	$4202

	lda	MapX
	sta	$4203
	nop
	nop
	nop
	nop
	;nop
	;nop
	;nop
	;nop
	rep	#$30
	lda	$4216
	
	clc
	adc	Storage
	sta	Storage3

	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax	
	sep	#$20
	lda	MapAt,x		; get Tile attribute info
	rep	#$30
	and	#$00ff
	tax
	sep	#$20
	lda	MapAttribute,x
	
	cmp	#$01
	beq	LeftEnd2


Leftaniminc:


	sep	#$20
	lda	#$40
	sta	MainFlip	; Flip X for Main Character Frame
	



	lda	JumpFallflag
	bne	Leftcheck
	lda	Fallflag
	bne	Leftcheck	

	inc	MainAnim	; increase Main sprite frame #
	bra	Leftcheck2

Leftcheck:
	lda	#15



	sta	MainAnim		; frame that looks like jumping?!

Leftcheck2:



	lda	MainH		; read Main Char X position
	cmp	#$50		; did Main Sprite reach right part screen?
	bcc	Leftstart
	dec	MainH		; increase Main sprite X position
LeftEnd:

	sep	#$20
	rts


	

Leftstart:

	rep	#$30
	lda	column_map_offset	;read map column offset
	sec
	sbc	#$20			; check to see if it's at the begining
	bne	MoveMSleft

	sep	#$20

	lda 	MainH		; get X position of Sprite Character
	cmp	#$01		; did it reach left end of screen?
	bcc	MoveMSleft2






	dec 	MainH		; decrease Main sprite X position
	sep	#$20
	rts

LeftEnd2:

	
	rep	#$30
	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax
	lda	Map45at,x
	and	#$00ff
	beq	LeftEnd
	jsr	!Up
	sep	#$20
	jmp	!Leftaniminc



MoveMSleft2:

	sep	#$20
	rts

MoveMSleft:
	sep	#$20
	lda	#$06
	sta	Movescreentest2
MoveMSleft3:
	rep	#$30
	lda	Plane0X		; get Plane 0 X position
	dec a			; increase
	and	#$03ff
	sta	Plane0X		; store it
	and	#$000f		; did it pass 16 pixels?
	cmp	#$000f
	beq	scrollleft



	jmp	!Scrollleft2

scrollleft:
	jsr	!scrollmapleft ; yes! scroll map and read new map tiles
Scrollleft2:
	rep	#$30

	lda	backmapeor
	eor	#$0001
	sta	backmapeor
	beq	Scrollleft2end

	lda	Plane1X
	dec a
	and	#$03ff
	sta	Plane1X
	and	#$000f
	cmp	#$000f
	beq	scrollbackleft
Scrollleft2end:
	sep	#$20
	rts

scrollbackleft:
	jmp	!scrollbackmapleft




	sep	#$20
	rts



Down:





	rep	#$30
	lda	Plane0X
	and	#$000f
	sta	Storage4
	lda	MainH
	clc
	adc	Storage4
	clc	
	adc	#$00			; right most of object
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage
	lda	column_map_offset
	sec
	sbc	#$001f
	clc
	adc	Storage
	sta	Storage

	lda	Plane0Y
	clc
	adc	MainV
	clc
	adc	#$0021

	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage2

	sep	#$20
	lda	Storage2
	sta	$4202

	lda	MapX
	sta	$4203
	nop
	nop
	nop
	nop
	;nop
	;nop
	;nop
	;nop
	rep	#$30
	lda	$4216
	
	clc
	adc	Storage
	sta	Storage3

	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax	
	sep	#$20
	lda	MapAt,x		; get Tile attribute info
	rep	#$30
	and	#$00ff
	tax
	sep	#$20
	lda	MapAttribute,x
	cmp	#$01
	bne	Downcont
	jmp	!DownEnd



Downcont:

	rep	#$30
	lda	Plane0X
	and	#$000f
	sta	Storage4
	lda	MainH
	clc
	adc	Storage4
	clc	
	adc	#$08			; left most of object
	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage
	lda	column_map_offset
	sec
	sbc	#$001f
	clc
	adc	Storage
	sta	Storage

	lda	Plane0Y
	clc
	adc	MainV
	clc
	adc	#$0021

	lsr a
	lsr a
	lsr a
	lsr a
	sta	Storage2

	sep	#$20
	lda	Storage2
	sta	$4202

	lda	MapX
	sta	$4203
	nop
	nop
	nop
	nop
	;nop
	;nop
	;nop
	;nop
	rep	#$30
	lda	$4216
	
	clc
	adc	Storage
	sta	Storage3

	ldx	Storage3		; read X comlumn offset

	lda	Map+8,x		; get X column byte
	and	#$00ff
	tax	
	sep	#$20
	lda	MapAt,x		; get Tile attribute info
	rep	#$30
	and	#$00ff
	tax
	sep	#$20
	lda	MapAttribute,x
	cmp	#$01
	beq	DownEnd



Downmove:
	sep	#$20
	lda	MainV
	cmp	#$a0
	bcs	MovePlane0Down
	inc	MainV
	rts
MovePlane0Down:
	rep	#$30
	lda	#$a0
	sta	MainV
	lda	Plane0Y		; Get Plane 0 Y position 
	inc a
	cmp	#$0120
	bcc	NoDownStop	; did it reach the bottom?
	lda	#$0120		; stop it from moving further!
NoDownStop:
	sta	Plane0Y		; store it!
	sep	#$20
	rts
DownEnd:
	sep	#$20
	lda	#$01
	sta	Fallflag
	rts
JumpUp:
	sep	#$20
	lda	JumpFallflag
	bne	JumpUp2
	rts
JumpUp2:
	rep	#$30		; test  to see if the top of the screen
	lda	Plane0Y		; is shown, if so, the sprite can jump
	and	#$01ff		; to the top, instead of #$21
	cmp	#$01ff
	bne	Jumpscreenup
	sep	#$20
	lda	MainV
	clc
	adc	#$40
	cmp	#$40
	bcs	Jumpuptopscreen
	lda	#$01
	sta	MainV
	rep     #$30 
	stz     Jumpflag        ; yes! stop jump    
	stz     Jumpoffset      ; reset jump offset!
	lda	#$01
	sta	Fallflag
	stz	JumpFallflag
        sep	#$20

Jumpuptopscreen:
	rts

Jumpscreenup:

	sep	#$20
	lda	MainV		; is Main Character at #$40 Vertical pos?
	cmp	#$21
	bcc	MovePlane0up	; is it lower ?
	cmp	#$e0
	bcs	MovePlane0up45
	rts
MovePlane0up45:
	lda	#$00
	sta	MainV
	bra	MovePlane0up
Up:
	

	sep	#$20
	lda	MainV		; is Main Character at #$40 Vertical pos?
	cmp	#$21
	bcc	MovePlane0up2	; is it lower ?
	dec	MainV
	;bra	MovePlane0up2
	rts
MovePlane0up:
	lda	#$20
	sec
	sbc	MainV		; calculate the distance from #$20 and the 
				; current Main Character pos
	;lda	#$03
	sta	Storage		; store value
	stz	Storage+1
	lda	#$20		; put main sprite at #$20
	sta	MainV

	rep	#$30
	bra	MovePlane0up3


MovePlane0up2:

	rep	#$30
	ldx	#$0001
	stx	Storage
MovePlane0up3:
	lda	Plane0Y		; get Plane 0 Y position
	sec
	sbc	Storage		; subtract to make screen move up (field goes
				; down)
				; did it reach the top?
	bpl	NoUpStop
	lda	#$ffff		; stop it from moving further!
NoUpStop:
	sta	Plane0Y		; store it!
	sep	#$20
	rts




scrollmapright:
	rep	#$30
	lda	column_map_offset	;read map column offset
	cmp	MapX		; compare with column length
	bne	MapXnoEnd
	sep	#$20
	rts
	rep	#$30
	stz	column_map_offset	; reset column map offset

MapXnoEnd:
	ldx	column_map_offset	; read X comlumn offset
	ldy	#$0000			; counter

Mapcopy:
	lda	Map+8,x		; get X column byte
	phx			; store X
	and	#$00ff
	asl a			; double it to read word
	tax	
	lda	Mapinfo,x	; get Tile info
	xba			; exchange bytes
	sta	$1e00,y		; store data
	plx			; get back X
	txa			
	clc
	adc	MapX		; add y comlumn offset
	tax
	iny
	iny
	cpy	#$0040		; do 32 tiles (words = 64 bytes)
	bne	Mapcopy

	inc	column_map_offset		; increase map X position

	lda	Screen0Column		; get screen column
	sta	Plane0TileAddress		;Plane0TileAddress storage
	clc
	adc	#$5000		; Vram Address for Plane 0 tile ram
	sta	Plane0TileAddress		; vram address
	sep	#$20

	lda	#$01
	sta	Vramtransfer	; set map copy flag

	lda	Screen0Column	; 
	inc a
	and	#$001f		; increase screen column
	sta	Screen0Column
	rts

scrollbackmapright:

	rep	#$30
	lda	column_map_offset2	;read map column offset
	cmp	MapX2		; compare with column length
	bne	MapXnoEnd3
	sep	#$20
	rts
	rep	#$30
	stz	column_map_offset2	; reset column map offset

MapXnoEnd3:
	ldx	column_map_offset2	; read X comlumn offset
	ldy	#$0000			; counter

BackMapcopy:
	lda	Map2+8,x		; get X column byte
	phx			; store X
	and	#$00ff
	asl a			; double it to read word
	tax	
	lda	Mapinfo,x	; get Tile info
	xba			; exchange bytes
	sta	$1e40,y		; store data
	plx			; get back X
	txa			
	clc
	adc	MapX2		; add y comlumn offset
	tax
	iny
	iny
	cpy	#$0040		; do 32 tiles (words = 64 bytes)
	bne	BackMapcopy

	inc	column_map_offset2		; increase map X position

	lda	Screen1Column		; get screen column
	sta	Plane1TileAddress		;Plane0TileAddress storage
	clc
	adc	#$5800		; Vram Address for Plane 0 tile ram
	sta	Plane1TileAddress		; vram address
	sep	#$20

	lda	#$01
	sta	Vramtransfer2	; set map copy flag

	lda	Screen1Column	; 
	inc a
	and	#$001f		; increase screen column
	sta	Screen1Column
	rts









scrollmapleft:
	rep	#$30
MapXnoEnd2:
	

	ldx	column_map_offset	; read X comlumn offset
	txa
	sec
	sbc	#$0020
	tax
	ldy	#$0000			; counter

Mapcopy2:
	lda	Map+8,x		; get X column byte
	phx			; store X
	and	#$00ff
	asl a			; double it to read word
	tax	
	lda	Mapinfo,x	; get Tile info
	xba			; exchange bytes
	sta	$1e00,y		; store data
	plx			; get back X
	txa			
	clc
	adc	MapX		; add y comlumn offset
	tax
	iny
	iny
	cpy	#$0040		; do 32 tiles (words = 64 bytes)
	bne	Mapcopy2

	


	lda	Screen0Column		; get screen column
	sec
	sbc	#$0020
	and	#$001f
	sta	Plane0TileAddress		;Plane0TileAddress storage
	clc
	adc	#$5000		; Vram Address for Plane 0 tile ram
	sta	Plane0TileAddress		; vram address



	dec	column_map_offset		; decrease map X position



	lda	Screen0Column	; 
	dec a
	and	#$001f		; increase screen column
	sta	Screen0Column
	

	sep	#$20



	lda	#$01
	sta	Vramtransfer	; set map copy flag

	rts


scrollbackmapleft:
	rep	#$30
	

	ldx	column_map_offset2	; read X comlumn offset
	txa
	sec
	sbc	#$0020
	tax
	ldy	#$0000			; counter

Mapcopy5:
	lda	Map2+8,x		; get X column byte
	phx			; store X
	and	#$00ff
	asl a			; double it to read word
	tax	
	lda	Mapinfo,x	; get Tile info
	xba			; exchange bytes
	sta	$1e40,y		; store data
	plx			; get back X
	txa			
	clc
	adc	MapX2		; add y comlumn offset
	tax
	iny
	iny
	cpy	#$0040		; do 32 tiles (words = 64 bytes)
	bne	Mapcopy5

	


	lda	Screen1Column		; get screen column
	sec
	sbc	#$0020
	and	#$001f
	sta	Plane1TileAddress		;Plane0TileAddress storage
	clc
	adc	#$5800		; Vram Address for Plane 0 tile ram
	sta	Plane1TileAddress		; vram address



	dec	column_map_offset2		; decrease map X position



	lda	Screen1Column	; 
	dec a
	and	#$001f		; increase screen column
	sta	Screen1Column
	

	sep	#$20



	lda	#$01
	sta	Vramtransfer2	; set map copy flag

	rts










;=============================================================================
;                  Copy Map Column to Vram
;=============================================================================
Copymapvram:
	sep	#$20
	stz	Vramtransfer	; clear vram copy flag
	
				; start of General DMA graphics copy routine!
	lda	#$01
	sta	$4370		; 0= 1 byte per register (not a word!)
	lda	#$18
	sta	$4371		; 21xx   this is 2118 (VRAM)
	lda	#$00
	sta	$4372
	lda	#$1e		; address = $7e1e00
	sta	$4373
	lda	#$7e
	sta	$4374		; bank address of data in ram
	ldx	#$0040
	stx	$4375		; # of bytes to be transferred
	lda	#$81
	sta	$2115		; increase V-Ram address after writing to
				; $2119, 32 by 32
	ldx	Plane0TileAddress
	stx	$2116		; address of VRAM to copy garphics in
	lda	#$80		; turn on bit 4 (%10000000=$80) of G-DMA channel
	sta	$420b
	lda	#$80		; increase V-Ram address after writing to
	sta	$2115		; $2119
	rts






;=============================================================================
;                  Copy Background Map Column to Vram
;=============================================================================
Copybackmapvram:
	sep	#$20
	stz	Vramtransfer2	; clear vram copy flag
	
				; start of General DMA graphics copy routine!
	lda	#$01
	sta	$4370		; 0= 1 byte per register (not a word!)
	lda	#$18
	sta	$4371		; 21xx   this is 2118 (VRAM)
	lda	#$40
	sta	$4372
	lda	#$1e		; address = $7e1e00
	sta	$4373
	lda	#$7e
	sta	$4374		; bank address of data in ram
	ldx	#$0040
	stx	$4375		; # of bytes to be transferred
	lda	#$81
	sta	$2115		; increase V-Ram address after writing to
				; $2119, 32 by 32
	ldx	Plane1TileAddress
	stx	$2116		; address of VRAM to copy garphics in
	lda	#$80		; turn on bit 4 (%10000000=$80) of G-DMA channel
	sta	$420b
	lda	#$80		; increase V-Ram address after writing to
	sta	$2115		; $2119
	rts









;==========================================================================
;                            Copy Sprite Data to OAM
;==========================================================================
Copyspriteoam:
	sep	#$20
	
				; start of General DMA graphics copy routine!
	lda	#$00
	sta	$4370		; 0= 1 byte per register (not a word!)
	lda	#$04
	sta	$4371		; 21xx   this is 2104 (OAM)
	lda	#$00
	sta	$4372
	lda	#$1b		; address = $7e1b00
	sta	$4373
	lda	#$7e
	sta	$4374		; bank address of data in ram
	ldx	#$0220
	stx	$4375		; # of bytes to be transferred

	lda	#$03
	sta	$2101
	stz	$2102
	stz	$2103

	lda	#$80		; turn on bit 4 (%10000000=$80) of G-DMA channel
	sta	$420b
	rts


;==========================================================================
;                       Copy Graphics To Vram
;==========================================================================
gCopy_Gfx:
	Ldx	#$0000		; Select Vram address $0000
	stx	$2116
Cleanram:
	stz	$2118
	stz	$2119
	inx
	cpx	#$0000
	bne	Cleanram



Copgfx:
	Lda	>gESIPIC,X	; Copy Gfx
	Sta	$2118
	Inx
	Lda	>gESIPIC,X
	Sta	$2119
	Inx
	Cpx	#$6800		; 32*28*8     *8       = $e000
	Bne	Copgfx		; x  y  bytes  planes  

	ldx	#$6000
	stx	$2116
	ldx	#$0000
Cop2:	lda	Wolf,x
	sta	$2118
	inx
	lda	Wolf,x
	sta	$2119
	inx
	cpx	#$1800
	bne	Cop2
	rts
;==========================================================================
;                    Put Map Data into $7fe000
;==========================================================================

Levelmapramcopy:
	rep	#$30
	ldx	#$0000
copylevelmap:
	lda	Levelmap,x
	sta	>$7fe000,x
	inx
	inx
	cpx	#$2000
	bne	copylevelmap

	ldx	#$0000
copylevelmapback:
	lda	Levelmapback,x
	sta	>$7fc000,x
	inx
	inx
	cpx	#$2000
	bne	copylevelmapback

	sep	#$20
	rts

;==========================================================================
;                      Copy Colors
;==========================================================================
gCopy_Colors:
	Stz	$2121		; Select Color Register 1
	Ldx	#$0000
gCopCol:
	Lda	gESICOL,X
	Sta	$2122
	Inx
	Cpx	#$0020		; Number of Colors * 2(word) = $8 
	Bne	gCopCol
	lda	#$80
	sta	$2121
	ldx	#$0000
CopyWolfCol:
	lda	Wolfcol,x
	sta	$2122
	inx
	cpx	#$0040
	bne	CopyWolfCol
	rts
;==========================================================================
;                      Make Tiles
;==========================================================================
gMake_Tiles:

	rep	#$30

	ldx	column_map_offset	; read X comlumn offset
	ldy	#$0000	; counter

Mapcopy3:
	rep	#$30
	lda	Map+8,x	; get X comlumn byte
	phx	; store X
	and	#$00ff
	asl a	; double it to read word
	tax	
	lda	Mapinfo,x	; get Tile info
	xba			; exchange bytes
	sta	$1e00,y		; store data
	plx			; get back X
	txa			
	clc
	adc	MapX		; add y comlumn offset
	tax
	iny
	iny
	cpy	#$0040
	bne	Mapcopy3

	inc	column_map_offset		; increase map X position
	
	lda	Screen0Column		; get screen column
	sta	Plane0TileAddress		;Plane0TileAddress storage
	clc
	adc	#$5000
	sta	Plane0TileAddress		; vram address
	sep	#$20

	lda	#$01
	sta	Vramtransfer	; set map copy flag

	lda	Screen0Column
	inc a
	and	#$001f		; increase screen column
	sta	Screen0Column

	sep	#$20
	stz	Vramtransfer
	
				; start of General DMA graphics copy routine!
	lda	#$01
	sta	$4330		; 0= 1 byte per register (not a word!)
	lda	#$18
	sta	$4331		; 21xx   this is 2118 (VRAM)
	lda	#$00
	sta	$4332
	lda	#$1e		; address = $7e1e00
	sta	$4333
	lda	#$7e
	sta	$4334		; bank address of data in ram
	ldx	#$0040
	stx	$4335		; # of bytes to be transferred
	lda	#$81
	sta	$2115		; increase V-Ram address after writing to
				; $2118, 128 by 128
	ldx	Plane0TileAddress
	stx	$2116		; address of VRAM to copy garphics in
	lda	#$08		; turn on bit 4 (%1000=8) of G-DMA channel
	sta	$420b
	lda	#$80		; increase V-Ram address after writing to
	sta	$2115		; $2119
	
	lda	column_map_offset
	cmp	#$0020
	beq	StopMappage1

	jmp	!gMake_Tiles
StopMappage1:





Make_Plane1_Tiles


	rep	#$30

	ldx	column_map_offset2	; read X comlumn offset
	ldy	#$0000	; counter

Map1copy3:
	rep	#$30
	lda	Map2+8,x		; get X comlumn byte
	phx			; store X
	and	#$00ff
	asl a			; double it to read word
	tax	
	lda	Mapinfo,x	; get Tile info
	xba			; exchange bytes
	sta	$1e40,y		; store data
	plx			; get back X
	txa			
	clc
	adc	MapX2		; add y comlumn offset
	tax
	iny
	iny
	cpy	#$0040
	bne	Map1copy3

	inc	column_map_offset2		; increase map X position
	
	lda	Screen1Column		; get screen column
	sta	Plane1TileAddress		;Plane0TileAddress storage
	clc
	adc	#$5800
	sta	Plane1TileAddress		; vram address
	sep	#$20

	lda	#$01
	sta	Vramtransfer2	; set map copy flag

	lda	Screen1Column
	inc a
	and	#$001f		; increase screen column
	sta	Screen1Column

	sep	#$20
	stz	Vramtransfer2
	
				; start of General DMA graphics copy routine!
	lda	#$01
	sta	$4330		; 0= 1 byte per register (not a word!)
	lda	#$18
	sta	$4331		; 21xx   this is 2118 (VRAM)
	lda	#$40
	sta	$4332
	lda	#$1e		; address = $7e1e40
	sta	$4333
	lda	#$7e
	sta	$4334		; bank address of data in ram
	ldx	#$0040
	stx	$4335		; # of bytes to be transferred
	lda	#$81
	sta	$2115		; increase V-Ram address after writing to
				; $2118, 128 by 128
	ldx	Plane1TileAddress
	stx	$2116		; address of VRAM to copy garphics in
	lda	#$08		; turn on bit 4 (%1000=8) of G-DMA channel
	sta	$420b
	lda	#$80		; increase V-Ram address after writing to
	sta	$2115		; $2119
	
	lda	column_map_offset2
	cmp	#$0020
	beq	StopMappage2

	jmp	!Make_Plane1_Tiles
StopMappage2:
	sep	#$20
	rts









;============================================================================
;                    Start HDMA routine to setup plane on/off HDMA
;============================================================================


gHDMA:
	rep	#$30
	sep	#$20

	ldx	#$0000
	stx	Storage
	stx	Storage2
	ldy	#$0000

CopyHDMAcols:

	ldx	Storage
	lda	#$01
	sta	>$7f8000,x
	inx
	stx	Storage
	
	ldx	Storage2
	lda	>HDMA2122,x
	inx
	stx	Storage2
	
	ldx	Storage
	sta	>$7f8000,x
	inx
	stx	Storage
	
	
	ldx	Storage2
	lda	>HDMA2122,x
	inx
	stx	Storage2
	
	ldx	Storage
	sta	>$7f8000,x
	inx
	stx	Storage
	iny
	cpy	#$180
	bne	CopyHDMAcols

	ldx	#$0000
copyHDMA2133effect
	lda	>HDMA2133,x
	sta	>$7f8800,x
	inx
	cpx	#$204
	bne	copyHDMA2133effect


	lda	#$00
	sta	$4300		; 0= 1 byte per register (not a word!)
	lda	#$21
	sta	$4301		; 21xx   this is 2121 (color palette)
	ldx	#HDMA2121	; the address of where it's located
	stx	$4302
	lda	#^HDMA2121	
	sta	$4304		; bank address of data in ram

	lda	#$02
	sta	$4310
	lda	#$22
	sta	$4311
	ldx	#$8000		; the colors will be at $7f8000!!
	stx	$4312
	lda	#$7f
	sta	$4314


	lda	#$00
	sta	$4320		; 0= 1 byte per register (not a word!)
	lda	#$33
	sta	$4321		; 21xx   this is 2133 (screen initial setting)
				; when psuedo 512 is on, the gfx blend with
				; HDMA colors!
	ldx	#$8800		; the address of where it's located
	stx	$4322
	lda	#$7f
	sta	$4324		; bank address of data in ram


	jsr	!gWaitVb
	lda	#%00000011
	sta	$420c

	rts

;===========================================================================
;                               Sprite Setup Routine
;===========================================================================

Sprite_Setup:
	sep	#$20
	lda	#$03		; graf-x at $6000
	sta	$2101


	ldx	#$0000
gsprtclear:
	stz	$1b00,x
	inx
	lda	#$f0		; position out of view!
	sta	$1b00,x
	inx
	stz	$1b00,x
	inx
	lda	#%00110000
	sta	$1b00,x
	inx
	cpx	#$0200
	bne	gsprtclear

gsprtclear2:
	lda	#$00		; all 8*8 and on screen
	sta	$1b00,x
	inx
	sta	$1b00,x
	inx
	cpx	#$0220
	bne	gsprtclear2	
	
	rts

;==========================================================================
;                           Clear weapon data block
;==========================================================================

Weaponclear:
	rep	#$30
	sep	#$20
	ldx	#$0000
clearweapondata:
	stz	$1d20,x
	inx
	cpx	#$0070
	bne	clearweapondata
	rts

;==========================================================================
;                         SNES Reg Init
;==========================================================================
gSnes_init:
	sep 	#$30    ; X,Y,A are 8 bit numbers
	lda 	#$8F    ; screen off, full brightness
	sta 	$2100   ; brightness + screen enable register 
	stz 	$2101   ; Sprite register (size + address in VRAM)
	stz 	$2102   ; Sprite registers (address of sprite memory [OAM])
	stz 	$2103   ;    ""                       ""
	stz 	$2105   ; Mode 0, = Graphic mode register
	stz 	$2106   ; noplanes, no mosaic, = Mosaic register
	stz 	$2107   ; Plane 0 map VRAM location
	stz 	$2108   ; Plane 1 map VRAM location
	stz 	$2109   ; Plane 2 map VRAM location
	stz 	$210A   ; Plane 3 map VRAM location
	stz 	$210B   ; Plane 0+1 Tile data location
	stz 	$210C   ; Plane 2+3 Tile data location
	stz 	$210D   ; Plane 0 scroll x (first 8 bits)
	stz 	$210D   ; Plane 0 scroll x (last 3 bits) #$0 - #$07ff
	stz 	$210E   ; Plane 0 scroll y (first 8 bits)
	stz 	$210E   ; Plane 0 scroll y (last 3 bits) #$0 - #$07ff
	stz 	$210F   ; Plane 1 scroll x (first 8 bits)
	stz 	$210F   ; Plane 1 scroll x (last 3 bits) #$0 - #$07ff
	stz 	$2110   ; Plane 1 scroll y (first 8 bits)
	stz 	$2110   ; Plane 1 scroll y (last 3 bits) #$0 - #$07ff
	stz 	$2111   ; Plane 2 scroll x (first 8 bits)
	stz 	$2111   ; Plane 2 scroll x (last 3 bits) #$0 - #$07ff
	stz 	$2112   ; Plane 2 scroll y (first 8 bits)
	stz 	$2112   ; Plane 2 scroll y (last 3 bits) #$0 - #$07ff
	stz 	$2113   ; Plane 3 scroll x (first 8 bits)
	stz 	$2113   ; Plane 3 scroll x (last 3 bits) #$0 - #$07ff
	stz 	$2114   ; Plane 3 scroll y (first 8 bits)
	stz 	$2114   ; Plane 3 scroll y (last 3 bits) #$0 - #$07ff
	lda 	#$80    ; increase VRAM address after writing to $2119
	sta 	$2115   ; VRAM address increment register
	stz 	$2116   ; VRAM address low
	stz 	$2117   ; VRAM address high
	stz 	$211A   ; Initial Mode 7 setting register
	stz 	$211B   ; Mode 7 matrix parameter A register (low)
	lda 	#$01
	sta 	$211B   ; Mode 7 matrix parameter A register (high)
	stz 	$211C   ; Mode 7 matrix parameter B register (low)
	stz 	$211C   ; Mode 7 matrix parameter B register (high)
	stz 	$211D   ; Mode 7 matrix parameter C register (low)
	stz 	$211D   ; Mode 7 matrix parameter C register (high)
	stz 	$211E   ; Mode 7 matrix parameter D register (low)
	sta 	$211E   ; Mode 7 matrix parameter D register (high)
	stz 	$211F   ; Mode 7 center position X register (low)
	stz 	$211F   ; Mode 7 center position X register (high)
	stz 	$2120   ; Mode 7 center position Y register (low)
	stz 	$2120   ; Mode 7 center position Y register (high)
	stz 	$2121   ; Color number register ($0-ff)
	stz 	$2123   ; BG1 & BG2 Window mask setting register
	stz 	$2124   ; BG3 & BG4 Window mask setting register
	stz 	$2125   ; OBJ & Color Window mask setting register
	stz 	$2126   ; Window 1 left position register
	stz 	$2127   ; Window 2 left position register
	stz 	$2128   ; Window 3 left position register
	stz 	$2129   ; Window 4 left position register
	stz 	$212A   ; BG1, BG2, BG3, BG4 Window Logic register
	stz 	$212B   ; OBJ, Color Window Logic Register (or,and,xor,xnor)
	sta 	$212C   ; Main Screen designation (planes, sprites enable)
	stz 	$212D   ; Sub Screen designation
	stz 	$212E   ; Window mask for Main Screen
	stz 	$212F   ; Window mask for Sub Screen
	lda 	#$30
	sta 	$2130   ; Color addition & screen addition init setting
	stz 	$2131   ; Add/Sub sub designation for screen, sprite, color
	lda 	#$E0
	sta 	$2132   ; color data for addition/subtraction
	stz 	$2133   ; Screen setting (interlace x,y/enable SFX data)
	stz 	$4200   ; Enable V-blank, interrupt, Joypad register
	lda 	#$FF
	sta 	$4201   ; Programmable I/O port
	stz 	$4202   ; Multiplicand A
	stz 	$4203   ; Multiplier B
	stz 	$4204   ; Multiplier C
	stz 	$4205   ; Multiplicand C
	stz 	$4206   ; Divisor B
	stz 	$4207   ; Horizontal Count Timer
	stz 	$4208   ; Horizontal Count Timer MSB (most significant bit)
	stz 	$4209   ; Vertical Count Timer
	stz 	$420A   ; Vertical Count Timer MSB
	stz 	$420B   ; General DMA enable (bits 0-7)
	stz 	$420C   ; Horizontal DMA (HDMA) enable (bits 0-7)
	stz 	$420D	; Access cycle designation (slow/fast rom)
	rts



Mapinfo:
	dc.w	0	;tile 0
	dc.w	2	;tile 1
	dc.w	4	;tile 2
	dc.w	6	;tile 3
	dc.w	8	;tile 4
	dc.w	10	;tile 5
	dc.w	12	;tile 6
	dc.w	14	;tile 7
	dc.w	$1a0	;tile 8
	dc.w	$1a2	;tile 9
	dc.w	$1a4	;tile 10
	dc.w	$1a6	;tile 11
	dc.w	$1a8	;tile 12
	dc.w	$1aa	;tile 13
	dc.w	$1ac	;tile 14
	dc.w	$1ae	;tile 15
	dc.w	0	;tile 16
	dc.w	0	;tile 17
	dc.w	0	;tile 18
	dc.w	0	;tile 19
	dc.w	$20	;tile 20
	dc.w	$22	;tile 21
	dc.w	$24	;tile 22
	dc.w	$26	;tile 23
	dc.w	$28	;tile 24
	dc.w	$2a	;tile 25
	dc.w	$2c	;tile 26
	dc.w	$2e	;tile 27
	dc.w	$1c0	;tile 28
	dc.w	$1c2	;tile 29
	dc.w	$1c4	;tile 30
	dc.w	$1c6	;tile 31
	dc.w	$1c8	;tile 32
	dc.w	$1ca	;tile 33
	dc.w	$1cc	;tile 34
	dc.w	$1ce	;tile 35
	dc.w	0	;tile 36
	dc.w	0	;tile 37
	dc.w	0	;tile 38
	dc.w	0	;tile 39
	dc.w	$40	;tile 40
	dc.w	$42	;tile 41
	dc.w	$44	;tile 42
	dc.w	$46	;tile 43
	dc.w	$48	;tile 44
	dc.w	$4a	;tile 45
	dc.w	$4c	;tile 46
	dc.w	$4e	;tile 47
	dc.w	$1e0	;tile 48
	dc.w	$1e2	;tile 49
	dc.w	$1e4	;tile 50
	dc.w	$1e6	;tile 51
	dc.w	$1e8	;tile 52
	dc.w	$1ea	;tile 53
	dc.w	$1ec	;tile 54
	dc.w	$1ee	;tile 55
	dc.w	0	;tile 56
	dc.w	0	;tile 57
	dc.w	0	;tile 58
	dc.w	0	;tile 59
	dc.w	$60	;tile 60
	dc.w	$62	;tile 61
	dc.w	$64	;tile 62
	dc.w	$66	;tile 63
	dc.w	$68	;tile 64
	dc.w	$6a	;tile 65
	dc.w	$6c	;tile 66
	dc.w	$6e	;tile 67
	dc.w	$200	;tile 68
	dc.w	$202	;tile 69
	dc.w	$204	;tile 70
	dc.w	$206	;tile 71
	dc.w	$208	;tile 72
	dc.w	$20a	;tile 73
	dc.w	$20c	;tile 74
	dc.w	$20e	;tile 75
	dc.w	0	;tile 76
	dc.w	0	;tile 77
	dc.w	0	;tile 78
	dc.w	0	;tile 79
	dc.w	$80	;tile 80
	dc.w	$82	;tile 81
	dc.w	$84	;tile 82
	dc.w	$86	;tile 83
	dc.w	$88	;tile 84
	dc.w	$8a	;tile 85
	dc.w	$8c	;tile 86
	dc.w	$8e	;tile 87
	dc.w	$220	;tile 88
	dc.w	$222	;tile 89
	dc.w	$224	;tile 90
	dc.w	$226	;tile 91
	dc.w	$228	;tile 92
	dc.w	$22a	;tile 93
	dc.w	$22c	;tile 94
	dc.w	$22e	;tile 95
	dc.w	0	;tile 96
	dc.w	0	;tile 97
	dc.w	0	;tile 98
	dc.w	0	;tile 99
	dc.w	$a0	;tile 100
	dc.w	$a2	;tile 101
	dc.w	$a4	;tile 102
	dc.w	$a6	;tile 103
	dc.w	$a8	;tile 104
	dc.w	$aa	;tile 105
	dc.w	$ac	;tile 106
	dc.w	$ae	;tile 107
	dc.w	$240	;tile 108
	dc.w	$242	;tile 109
	dc.w	$244	;tile 110
	dc.w	$246	;tile 111
	dc.w	$248	;tile 112
	dc.w	$24a	;tile 113
	dc.w	$24c	;tile 114
	dc.w	$24e	;tile 115
	dc.w	0	;tile 116
	dc.w	0	;tile 117
	dc.w	0	;tile 118
	dc.w	0	;tile 119
	dc.w	$c0	;tile 120
	dc.w	$c2	;tile 121
	dc.w	$c4	;tile 122
	dc.w	$c6	;tile 123
	dc.w	$c8	;tile 124
	dc.w	$ca	;tile 125
	dc.w	$cc	;tile 126
	dc.w	$ce	;tile 127
	dc.w	$260	;tile 128
	dc.w	$262	;tile 129
	dc.w	$264	;tile 130
	dc.w	$266	;tile 131
	dc.w	$268	;tile 132
	dc.w	$26a	;tile 133
	dc.w	$26c	;tile 134
	dc.w	$26e	;tile 135
	dc.w	0	;tile 136
	dc.w	0	;tile 137
	dc.w	0	;tile 138
	dc.w	0	;tile 139
	dc.w	$e0	;tile 140
	dc.w	$e2	;tile 141
	dc.w	$e4	;tile 142
	dc.w	$e6	;tile 143
	dc.w	$e8	;tile 144
	dc.w	$ea	;tile 145
	dc.w	$ec	;tile 146
	dc.w	$ee	;tile 147
	dc.w	$280	;tile 148
	dc.w	$282	;tile 149
	dc.w	$284	;tile 150
	dc.w	$286	;tile 151
	dc.w	$288	;tile 152
	dc.w	$28a	;tile 153
	dc.w	$28c	;tile 154
	dc.w	$28e	;tile 155
	dc.w	0	;tile 156
	dc.w	0	;tile 157
	dc.w	0	;tile 158
	dc.w	0	;tile 159
	dc.w	$100	;tile 160
	dc.w	$102	;tile 161
	dc.w	$104	;tile 162
	dc.w	$106	;tile 163
	dc.w	$108	;tile 164
	dc.w	$10a	;tile 165
	dc.w	$10c	;tile 166
	dc.w	$10e	;tile 167
	dc.w	$2a0	;tile 168
	dc.w	$2a2	;tile 169
	dc.w	$2a4	;tile 170
	dc.w	$2a6	;tile 171
	dc.w	$2a8	;tile 172
	dc.w	$2aa	;tile 173
	dc.w	$2ac	;tile 174
	dc.w	$2ae	;tile 175
	dc.w	0	;tile 176
	dc.w	0	;tile 177
	dc.w	0	;tile 178
	dc.w	0	;tile 179
	dc.w	$120	;tile 180
	dc.w	$122	;tile 181
	dc.w	$124	;tile 182
	dc.w	$126	;tile 183
	dc.w	$128	;tile 184
	dc.w	$12a	;tile 185
	dc.w	$12c	;tile 186
	dc.w	$12e	;tile 187
	dc.w	$2c0	;tile 188
	dc.w	$2c2	;tile 189
	dc.w	$2c4	;tile 190
	dc.w	$2c6	;tile 191
	dc.w	$2c8	;tile 192
	dc.w	$2ca	;tile 193
	dc.w	$2cc	;tile 194
	dc.w	$2ce	;tile 195
	dc.w	0	;tile 196
	dc.w	0	;tile 197
	dc.w	0	;tile 198
	dc.w	0	;tile 199
	dc.w	$140	;tile 200
	dc.w	$142	;tile 201
	dc.w	$144	;tile 202
	dc.w	$146	;tile 203
	dc.w	$148	;tile 204
	dc.w	$14a	;tile 205
	dc.w	$14c	;tile 206
	dc.w	$14e	;tile 207
	dc.w	$2e0	;tile 208
	dc.w	$2e2	;tile 209
	dc.w	$2e4	;tile 210
	dc.w	$2e6	;tile 211
	dc.w	$2e8	;tile 212
	dc.w	$2ea	;tile 213
	dc.w	$2ec	;tile 214
	dc.w	$2ee	;tile 215
	dc.w	0	;tile 216
	dc.w	0	;tile 217
	dc.w	0	;tile 218
	dc.w	0	;tile 219
	dc.w	$2160	;tile 220
	dc.w	$2162	;tile 221
	dc.w	$2164	;tile 222
	dc.w	$2166	;tile 223
	dc.w	$168	;tile 224
	dc.w	$16a	;tile 225
	dc.w	$16c	;tile 226
	dc.w	$16e	;tile 227
	dc.w	$300	;tile 228
	dc.w	$302	;tile 229
	dc.w	$304	;tile 230
	dc.w	$306	;tile 231
	dc.w	$308	;tile 232
	dc.w	$30a	;tile 233
	dc.w	$30c	;tile 234
	dc.w	$30e	;tile 235
	dc.w	$0	;tile 236
	dc.w	$0	;tile 237
	dc.w	0	;tile 238
	dc.w	0	;tile 239
	dc.w	$180	;tile 240
	dc.w	$2182	;tile 241
	dc.w	$184	;tile 242
	dc.w	$186	;tile 243
	dc.w	$188	;tile 244
	dc.w	$18a	;tile 245
	dc.w	$18c	;tile 246
	dc.w	$18e	;tile 247
	dc.w	$320	;tile 248
	dc.w	$322	;tile 249
	dc.w	$324	;tile 250
	dc.w	$326	;tile 251
	dc.w	$328	;tile 252
	dc.w	$32a	;tile 253
	dc.w	$32c	;tile 254
	dc.w	$32e	;tile 255


MapAttribute:				; Fall/solid attribute list
	dc.b	0,1,0,0,0,0,0,0		; reads original attribute, then makes
	dc.b	0,0,0,0,0,0,0,0		; it an offset for this. 
	dc.b	0,0,0,0,0,0,0,0		; 
	dc.b	0,0,0,0,0,0,0,0		; can we fall on it? 1 = yes
	dc.b	0,0,0,0,0,0,0,0		; this way we can have an original 
	dc.b	0,0,0,0,0,0,0,0		; attribute of 3, and still be able
	dc.b	0,0,0,0,0,0,0,0		; to fall on it (so we can decrease
	dc.b	0,0,0,0,0,0,0,0		; health!)
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	
Mapobjat:			; Attribute list for objects that break apart
				; must be a solid object.
				
				; 0 = always solid    1 = breakable

	dc.b	0,0,0,0,0,0,0,0		;0
	dc.b	0,0,0,0,0,0,0,0		;8
	dc.b	0,0,0,0,0,0,0,0		;16
	dc.b	0,0,0,0,0,0,0,0		;24
	dc.b	0,0,0,0,0,0,0,0		;32
	dc.b	0,0,0,0,0,0,0,0		;40
	dc.b	0,0,0,0,0,0,0,0		;48
	dc.b	0,0,0,0,0,0,0,0		;56
	dc.b	0,0,0,0,0,0,0,0		;64
	dc.b	0,0,0,0,0,0,0,0		;72
	dc.b	0,0,0,0,0,0,0,0		;80

	dc.b	0,0,0,0,0,0,0,0		;88
	dc.b	0,0,0,0,0,1,1,1		;96
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	
Map45at:			; Attribute list for objects that allow 
				; diagonal walk/slide.
				
				; 0 = always flat    1 = 45 D top-bottom right \
				; 2 = 45 D top-bottom left /

	dc.b	0,2,1,0,0,0,0,0		;0
	dc.b	0,0,0,0,0,0,0,0		;8
	dc.b	0,0,0,0,0,0,0,0		;16
	dc.b	0,0,0,0,0,0,0,0		;24
	dc.b	0,0,0,0,0,0,0,0		;32
	dc.b	0,0,0,0,0,0,0,0		;40
	dc.b	0,0,0,0,0,0,0,0		;48
	dc.b	0,0,0,0,0,0,0,0		;56
	dc.b	0,0,0,0,0,0,0,0		;64
	dc.b	0,0,0,0,0,0,0,0		;72
	dc.b	0,0,0,0,0,0,0,0		;80

	dc.b	0,0,0,0,0,0,0,0		;88
	dc.b	0,0,0,0,0,0,0,0		;96
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	dc.b	0,0,0,0,0,0,0,0
	



gESICOL:             


	dcr.w	$5200,$521A,$4992,$0146,$024C,$0392,$000C,$031E
	dcr.w	$021C,$115A,$0092,$0000,$30C6,$498C,$6A94,$7BDE 
 


Wolfcol:

	dcr.w	$5620,$563B,$4D93,$0146,$026C,$03B3,$000C,$033F
	dcr.w	$023D,$115B,$0093,$0000,$30C6,$4D8C,$6EB5,$7FFF 
 


	dcr.w	$5620,$7FFB,$6B5C,$56BD,$421D,$295E,$14BF,$0000
	dcr.w	$7FFF,$7F7B,$7ED6,$7E52,$7DAD,$7D29,$7C84,$7C00 
 



 




Wolf:
	.bin	clown.dat

Levelmap:
	.bin	map4
Levelmapback:
	.bin	backmap
MapAt:
	.bin	block2.shit.a
	.pad
gESIPIC:            
	.bin block2.dat
	.bin block2.dat2

Starstop:
	.bin	starstop.dat
Starsbottom
	.bin	starsbottom.dat
Mainspriteanim1:
	.bin	mainspriteanim2.1
Mainspriteanim2:
	.bin	mainspriteanim2.2
Mainspriteanim3:
	.bin	mainspriteanim2.3
Mainspriteanim4:
	.bin	mainspriteanim2.4
	.pad


HDMA2121:

	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	0,0,0,0
HDMA2122:

	dcr.w	$001F,$001F,$003F,$005F,$005F,$007F,$007F,$009F
	dcr.w	$00BF,$00BF,$00DF,$00FF,$00FF,$011F,$011F,$013F
	dcr.w	$015F,$017F,$017F,$019F,$01BF,$01BF,$01DF,$01FF
	dcr.w	$01FF,$021F,$021F,$023F,$025F,$025F,$027F,$029F
	dcr.w	$029F,$02BF,$02BF,$02DF,$02FF,$02FF,$031F,$031F
	dcr.w	$035F,$035F,$037F,$037F,$039F,$03BF,$03BE,$03BE
	dcr.w	$03DE,$03DE,$03DD,$03DD,$03DC,$03DB,$03DB,$03DA
	dcr.w	$03D9,$03D9,$03D8,$03D8,$03D7,$03D6,$03D6,$03D5
	dcr.w	$03D4,$03D3,$03D3,$03D2,$03D1,$03D1,$03D0,$03D0
	dcr.w	$03CF,$03CE,$03CE,$03CD,$03CD,$03CC,$03CB,$03CB
	dcr.w	$03CA,$03C9,$03C9,$03C8,$03C8,$03C7,$03C6,$03C6
	dcr.w	$03C5,$03C4,$03C4,$03C3,$03C3,$03C2,$03C1,$03C1
	dcr.w	$03C0,$03C0,$07C0,$07C0,$0BC0,$0BA0,$0FA0,$0FA0
	dcr.w	$13A0,$17A0,$17A0,$1BA0,$1BA0,$1FA0,$23A0,$23A0
	dcr.w	$27A0,$27A0,$2BA0,$2FA0,$2FA0,$33A0,$37A0,$37A0
	dcr.w	$3BA0,$3BA0,$3FA0,$43A0,$43A0,$47A0,$4BA0,$4BA0
	dcr.w	$4FA0,$4FA0,$53A0,$57A0,$57A0,$5BA0,$5FA0,$5FA0
	dcr.w	$63A0,$63A0,$67A0,$67A0,$6BA0,$6BA0,$6FA0,$73A0
	dcr.w	$73A0,$77A0,$7780,$7760,$7760,$7740,$7740,$7720
	dcr.w	$7700,$7700,$76E0,$76C0,$76C0,$76A0,$76A0,$7680
	dcr.w	$7660,$7660,$7640,$7620,$7620,$7600,$7600,$75E0
	dcr.w	$75C0,$75C0,$75C0,$75A0,$7580,$7580,$7160,$7140
	dcr.w	$7140,$7120,$7120,$7100,$70E0,$70E0,$70C0,$70C0
	dcr.w	$70A0,$7080,$7080,$7060,$7040,$7040,$7020,$7020
	dcr.w	$7000,$7000,$7000,$7000,$7001,$7002,$7002,$7003
	dcr.w	$7004,$7004,$7005,$7005,$7006,$7007,$7007,$7008
	dcr.w	$7008,$7009,$7009,$700A,$700B,$700B,$700C,$700C
	dcr.w	$700D,$700E,$700E,$700E,$700F,$7010,$7010,$7011
	dcr.w	$7011,$7012,$7013,$7013,$6C13,$6C14,$6C15,$6C15
	dcr.w	$6C16,$6C17,$6C17,$6C18,$6C18,$6C19,$6C19,$6C1A
	dcr.w	$6C1A,$6C1B,$6C1B,$681B,$681B,$641B,$601B,$601B
	dcr.w	$5C1B,$581B,$581B,$541B,$541B,$501B,$501B,$4C1B 
 


	dcr.w	$4C1B,$501B,$4C1B,$501B,$501A,$501A,$501A,$501A
	dcr.w	$501A,$501A,$501A,$541A,$5419,$5419,$5419,$5419
	dcr.w	$5419,$5419,$5419,$5418,$5418,$5818,$5818,$5818
	dcr.w	$5818,$5818,$5C18,$5817,$5C17,$5817,$5C17,$5C17
	dcr.w	$5C17,$5816,$5816,$5816,$5816,$5816,$5816,$5816
	dcr.w	$5416,$5416,$5416,$5416,$5416,$5416,$5416,$5416
	dcr.w	$5416,$5016,$5016,$5016,$5016,$5016,$5016,$4C16
	dcr.w	$4C16,$4C16,$4C16,$4C16,$4C16,$4C16,$4C16,$4C16
	dcr.w	$4C16,$4816,$4816,$4816,$4816,$4816,$4816,$4416
	dcr.w	$4416,$4416,$4416,$4416,$4416,$4416,$4416,$4416
	dcr.w	$4417,$4417,$4417,$4017,$4017,$4017,$4017,$4017
	dcr.w	$4017,$3C17,$3C17,$3C17,$3C17,$3C17,$3C17,$3C17
	dcr.w	$3C17,$3C17,$3817,$3817,$3817,$3817,$3817,$3817
	dcr.w	$3817,$3417,$3417,$3417,$3417,$3417,$3417,$3417
	dcr.w	$3417,$3417,$3017,$3017,$3017,$3017,$3017,$3017
	dcr.w	$3017,$3017,$3017,$2C17,$2C17,$2C17,$2C17,$2C17

HDMA2133:


	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	1,8,1,8,1,8,1,8,1,8,1,8,1,8,1,8
	dc.b	0,0,0,0



 	dcr.w	0
	dcr.w	0
	dcr.w	0
	dcr.w	0

	.pad



	org	$108000
	.bin	music.dat
